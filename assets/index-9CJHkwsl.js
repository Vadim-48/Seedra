(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();const uc=()=>{};var so={};const ma=function(r){const t=[];let e=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=i&63|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=i&63|128)}return t},hc=function(r){const t=[];let e=0,n=0;for(;e<r.length;){const i=r[e++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=r[e++];t[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=r[e++],a=r[e++],u=r[e++],f=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;t[n++]=String.fromCharCode(55296+(f>>10)),t[n++]=String.fromCharCode(56320+(f&1023))}else{const o=r[e++],a=r[e++];t[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return t.join("")},pa={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,t){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const o=r[i],a=i+1<r.length,u=a?r[i+1]:0,f=i+2<r.length,d=f?r[i+2]:0,_=o>>2,w=(o&3)<<4|u>>4;let R=(u&15)<<2|d>>6,C=d&63;f||(C=64,a||(R=64)),n.push(e[_],e[w],e[R],e[C])}return n.join("")},encodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(r):this.encodeByteArray(ma(r),t)},decodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(r):hc(this.decodeStringToByteArray(r,t))},decodeStringToByteArray(r,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const o=e[r.charAt(i++)],u=i<r.length?e[r.charAt(i)]:0;++i;const d=i<r.length?e[r.charAt(i)]:64;++i;const w=i<r.length?e[r.charAt(i)]:64;if(++i,o==null||u==null||d==null||w==null)throw new fc;const R=o<<2|u>>4;if(n.push(R),d!==64){const C=u<<4&240|d>>2;if(n.push(C),w!==64){const B=d<<6&192|w;n.push(B)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class fc extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const dc=function(r){const t=ma(r);return pa.encodeByteArray(t,!0)},Ar=function(r){return dc(r).replace(/\./g,"")},gc=function(r){try{return pa.decodeString(r,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function mc(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const pc=()=>mc().__FIREBASE_DEFAULTS__,yc=()=>{if(typeof process>"u"||typeof so>"u")return;const r=so.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},_c=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=r&&gc(r[1]);return t&&JSON.parse(t)},Hs=()=>{try{return uc()||pc()||yc()||_c()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},Ec=r=>Hs()?.emulatorHosts?.[r],vc=r=>{const t=Ec(r);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),n]:[t.substring(0,e),n]},ya=()=>Hs()?.config;class Tc{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,n))}}}function Ks(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ic(r){return(await fetch(r,{credentials:"include"})).ok}function Ac(r,t){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},n=t||"demo-project",i=r.iat||0,o=r.sub||r.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...r};return[Ar(JSON.stringify(e)),Ar(JSON.stringify(a)),""].join(".")}const Nn={};function wc(){const r={prod:[],emulator:[]};for(const t of Object.keys(Nn))Nn[t]?r.emulator.push(t):r.prod.push(t);return r}function Sc(r){let t=document.getElementById(r),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",r),e=!0),{created:e,element:t}}let io=!1;function Rc(r,t){if(typeof window>"u"||typeof document>"u"||!Ks(window.location.host)||Nn[r]===t||Nn[r]||io)return;Nn[r]=t;function e(R){return`__firebase__banner__${R}`}const n="__firebase__banner",o=wc().prod.length>0;function a(){const R=document.getElementById(n);R&&R.remove()}function u(R){R.style.display="flex",R.style.background="#7faaf0",R.style.position="fixed",R.style.bottom="5px",R.style.left="5px",R.style.padding=".5em",R.style.borderRadius="5px",R.style.alignItems="center"}function f(R,C){R.setAttribute("width","24"),R.setAttribute("id",C),R.setAttribute("height","24"),R.setAttribute("viewBox","0 0 24 24"),R.setAttribute("fill","none"),R.style.marginLeft="-6px"}function d(){const R=document.createElement("span");return R.style.cursor="pointer",R.style.marginLeft="16px",R.style.fontSize="24px",R.innerHTML=" &times;",R.onclick=()=>{io=!0,a()},R}function _(R,C){R.setAttribute("id",C),R.innerText="Learn more",R.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",R.setAttribute("target","__blank"),R.style.paddingLeft="5px",R.style.textDecoration="underline"}function w(){const R=Sc(n),C=e("text"),B=document.getElementById(C)||document.createElement("span"),U=e("learnmore"),L=document.getElementById(U)||document.createElement("a"),Y=e("preprendIcon"),$=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(R.created){const X=R.element;u(X),_(L,U);const Et=d();f($,Y),X.append($,B,L,Et),document.body.appendChild(X)}o?(B.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,B.innerText="Preview backend running in this workspace."),B.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}function bc(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Cc(){const r=Hs()?.forceEnvironment;if(r==="node")return!0;if(r==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Pc(){return!Cc()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Vc(){try{return typeof indexedDB=="object"}catch{return!1}}function Dc(){return new Promise((r,t)=>{try{let e=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}})}const Nc="FirebaseError";class tn extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name=Nc,Object.setPrototypeOf(this,tn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_a.prototype.create)}}class _a{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,o=this.errors[t],a=o?kc(o,n):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new tn(i,u,n)}}function kc(r,t){return r.replace(Oc,(e,n)=>{const i=t[n];return i!=null?String(i):`<${n}?>`})}const Oc=/\{\$([^}]+)}/g;function wr(r,t){if(r===t)return!0;const e=Object.keys(r),n=Object.keys(t);for(const i of e){if(!n.includes(i))return!1;const o=r[i],a=t[i];if(oo(o)&&oo(a)){if(!wr(o,a))return!1}else if(o!==a)return!1}for(const i of n)if(!e.includes(i))return!1;return!0}function oo(r){return r!==null&&typeof r=="object"}function Ea(r){return r&&r._delegate?r._delegate:r}class xn{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Re="[DEFAULT]";class Lc{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const n=new Tc;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),n=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(xc(t))try{this.getOrInitializeService({instanceIdentifier:Re})}catch{}for(const[e,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(t=Re){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Re){return this.instances.has(t)}getOptions(t=Re){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[o,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);n===u&&a.resolve(i)}return i}onInit(t,e){const n=this.normalizeInstanceIdentifier(e),i=this.onInitCallbacks.get(n)??new Set;i.add(t),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&t(o,n),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Mc(t),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=Re){return this.component?this.component.multipleInstances?t:Re:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Mc(r){return r===Re?void 0:r}function xc(r){return r.instantiationMode==="EAGER"}class Fc{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Lc(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var K;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(K||(K={}));const Bc={debug:K.DEBUG,verbose:K.VERBOSE,info:K.INFO,warn:K.WARN,error:K.ERROR,silent:K.SILENT},Uc=K.INFO,jc={[K.DEBUG]:"log",[K.VERBOSE]:"log",[K.INFO]:"info",[K.WARN]:"warn",[K.ERROR]:"error"},qc=(r,t,...e)=>{if(t<r.logLevel)return;const n=new Date().toISOString(),i=jc[t];if(i)console[i](`[${n}]  ${r.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class va{constructor(t){this.name=t,this._logLevel=Uc,this._logHandler=qc,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in K))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Bc[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,K.DEBUG,...t),this._logHandler(this,K.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,K.VERBOSE,...t),this._logHandler(this,K.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,K.INFO,...t),this._logHandler(this,K.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,K.WARN,...t),this._logHandler(this,K.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,K.ERROR,...t),this._logHandler(this,K.ERROR,...t)}}const Gc=(r,t)=>t.some(e=>r instanceof e);let ao,lo;function zc(){return ao||(ao=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Hc(){return lo||(lo=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ta=new WeakMap,Is=new WeakMap,Ia=new WeakMap,hs=new WeakMap,Qs=new WeakMap;function Kc(r){const t=new Promise((e,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",a)},o=()=>{e(re(r.result)),i()},a=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",a)});return t.then(e=>{e instanceof IDBCursor&&Ta.set(e,r)}).catch(()=>{}),Qs.set(t,r),t}function Qc(r){if(Is.has(r))return;const t=new Promise((e,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",a),r.removeEventListener("abort",a)},o=()=>{e(),i()},a=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",a),r.addEventListener("abort",a)});Is.set(r,t)}let As={get(r,t,e){if(r instanceof IDBTransaction){if(t==="done")return Is.get(r);if(t==="objectStoreNames")return r.objectStoreNames||Ia.get(r);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return re(r[t])},set(r,t,e){return r[t]=e,!0},has(r,t){return r instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in r}};function Wc(r){As=r(As)}function $c(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const n=r.call(fs(this),t,...e);return Ia.set(n,t.sort?t.sort():[t]),re(n)}:Hc().includes(r)?function(...t){return r.apply(fs(this),t),re(Ta.get(this))}:function(...t){return re(r.apply(fs(this),t))}}function Yc(r){return typeof r=="function"?$c(r):(r instanceof IDBTransaction&&Qc(r),Gc(r,zc())?new Proxy(r,As):r)}function re(r){if(r instanceof IDBRequest)return Kc(r);if(hs.has(r))return hs.get(r);const t=Yc(r);return t!==r&&(hs.set(r,t),Qs.set(t,r)),t}const fs=r=>Qs.get(r);function Xc(r,t,{blocked:e,upgrade:n,blocking:i,terminated:o}={}){const a=indexedDB.open(r,t),u=re(a);return n&&a.addEventListener("upgradeneeded",f=>{n(re(a.result),f.oldVersion,f.newVersion,re(a.transaction),f)}),e&&a.addEventListener("blocked",f=>e(f.oldVersion,f.newVersion,f)),u.then(f=>{o&&f.addEventListener("close",()=>o()),i&&f.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const Jc=["get","getKey","getAll","getAllKeys","count"],Zc=["put","add","delete","clear"],ds=new Map;function co(r,t){if(!(r instanceof IDBDatabase&&!(t in r)&&typeof t=="string"))return;if(ds.get(t))return ds.get(t);const e=t.replace(/FromIndex$/,""),n=t!==e,i=Zc.includes(e);if(!(e in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Jc.includes(e)))return;const o=async function(a,...u){const f=this.transaction(a,i?"readwrite":"readonly");let d=f.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[e](...u),i&&f.done]))[0]};return ds.set(t,o),o}Wc(r=>({...r,get:(t,e,n)=>co(t,e)||r.get(t,e,n),has:(t,e)=>!!co(t,e)||r.has(t,e)}));class tu{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(eu(e)){const n=e.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(e=>e).join(" ")}}function eu(r){return r.getComponent()?.type==="VERSION"}const ws="@firebase/app",uo="0.14.6";const zt=new va("@firebase/app"),nu="@firebase/app-compat",ru="@firebase/analytics-compat",su="@firebase/analytics",iu="@firebase/app-check-compat",ou="@firebase/app-check",au="@firebase/auth",lu="@firebase/auth-compat",cu="@firebase/database",uu="@firebase/data-connect",hu="@firebase/database-compat",fu="@firebase/functions",du="@firebase/functions-compat",gu="@firebase/installations",mu="@firebase/installations-compat",pu="@firebase/messaging",yu="@firebase/messaging-compat",_u="@firebase/performance",Eu="@firebase/performance-compat",vu="@firebase/remote-config",Tu="@firebase/remote-config-compat",Iu="@firebase/storage",Au="@firebase/storage-compat",wu="@firebase/firestore",Su="@firebase/ai",Ru="@firebase/firestore-compat",bu="firebase",Cu="12.6.0";const Ss="[DEFAULT]",Pu={[ws]:"fire-core",[nu]:"fire-core-compat",[su]:"fire-analytics",[ru]:"fire-analytics-compat",[ou]:"fire-app-check",[iu]:"fire-app-check-compat",[au]:"fire-auth",[lu]:"fire-auth-compat",[cu]:"fire-rtdb",[uu]:"fire-data-connect",[hu]:"fire-rtdb-compat",[fu]:"fire-fn",[du]:"fire-fn-compat",[gu]:"fire-iid",[mu]:"fire-iid-compat",[pu]:"fire-fcm",[yu]:"fire-fcm-compat",[_u]:"fire-perf",[Eu]:"fire-perf-compat",[vu]:"fire-rc",[Tu]:"fire-rc-compat",[Iu]:"fire-gcs",[Au]:"fire-gcs-compat",[wu]:"fire-fst",[Ru]:"fire-fst-compat",[Su]:"fire-vertex","fire-js":"fire-js",[bu]:"fire-js-all"};const Sr=new Map,Vu=new Map,Rs=new Map;function ho(r,t){try{r.container.addComponent(t)}catch(e){zt.debug(`Component ${t.name} failed to register with FirebaseApp ${r.name}`,e)}}function Rr(r){const t=r.name;if(Rs.has(t))return zt.debug(`There were multiple attempts to register component ${t}.`),!1;Rs.set(t,r);for(const e of Sr.values())ho(e,r);for(const e of Vu.values())ho(e,r);return!0}function Du(r,t){const e=r.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),r.container.getProvider(t)}function Nu(r){return r==null?!1:r.settings!==void 0}const ku={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},se=new _a("app","Firebase",ku);class Ou{constructor(t,e,n){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new xn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw se.create("app-deleted",{appName:this._name})}}const Lu=Cu;function Aa(r,t={}){let e=r;typeof t!="object"&&(t={name:t});const n={name:Ss,automaticDataCollectionEnabled:!0,...t},i=n.name;if(typeof i!="string"||!i)throw se.create("bad-app-name",{appName:String(i)});if(e||(e=ya()),!e)throw se.create("no-options");const o=Sr.get(i);if(o){if(wr(e,o.options)&&wr(n,o.config))return o;throw se.create("duplicate-app",{appName:i})}const a=new Fc(i);for(const f of Rs.values())a.addComponent(f);const u=new Ou(e,n,a);return Sr.set(i,u),u}function Mu(r=Ss){const t=Sr.get(r);if(!t&&r===Ss&&ya())return Aa();if(!t)throw se.create("no-app",{appName:r});return t}function Ge(r,t,e){let n=Pu[r]??r;e&&(n+=`-${e}`);const i=n.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const a=[`Unable to register library "${n}" with version "${t}":`];i&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),zt.warn(a.join(" "));return}Rr(new xn(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}const xu="firebase-heartbeat-database",Fu=1,Fn="firebase-heartbeat-store";let gs=null;function wa(){return gs||(gs=Xc(xu,Fu,{upgrade:(r,t)=>{switch(t){case 0:try{r.createObjectStore(Fn)}catch(e){console.warn(e)}}}}).catch(r=>{throw se.create("idb-open",{originalErrorMessage:r.message})})),gs}async function Bu(r){try{const e=(await wa()).transaction(Fn),n=await e.objectStore(Fn).get(Sa(r));return await e.done,n}catch(t){if(t instanceof tn)zt.warn(t.message);else{const e=se.create("idb-get",{originalErrorMessage:t?.message});zt.warn(e.message)}}}async function fo(r,t){try{const n=(await wa()).transaction(Fn,"readwrite");await n.objectStore(Fn).put(t,Sa(r)),await n.done}catch(e){if(e instanceof tn)zt.warn(e.message);else{const n=se.create("idb-set",{originalErrorMessage:e?.message});zt.warn(n.message)}}}function Sa(r){return`${r.name}!${r.options.appId}`}const Uu=1024,ju=30;class qu{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new zu(e),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=go();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:e}),this._heartbeatsCache.heartbeats.length>ju){const i=Hu(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){zt.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=go(),{heartbeatsToSend:e,unsentEntries:n}=Gu(this._heartbeatsCache.heartbeats),i=Ar(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return zt.warn(t),""}}}function go(){return new Date().toISOString().substring(0,10)}function Gu(r,t=Uu){const e=[];let n=r.slice();for(const i of r){const o=e.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),mo(e)>t){o.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),mo(e)>t){e.pop();break}n=n.slice(1)}return{heartbeatsToSend:e,unsentEntries:n}}class zu{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Vc()?Dc().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await Bu(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return fo(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return fo(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}else return}}function mo(r){return Ar(JSON.stringify({version:2,heartbeats:r})).length}function Hu(r){if(r.length===0)return-1;let t=0,e=r[0].date;for(let n=1;n<r.length;n++)r[n].date<e&&(e=r[n].date,t=n);return t}function Ku(r){Rr(new xn("platform-logger",t=>new tu(t),"PRIVATE")),Rr(new xn("heartbeat",t=>new qu(t),"PRIVATE")),Ge(ws,uo,r),Ge(ws,uo,"esm2020"),Ge("fire-js","")}Ku("");var Qu="firebase",Wu="12.7.0";Ge(Qu,Wu,"app");var po=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ie,Ra;(function(){var r;function t(v,m){function g(){}g.prototype=m.prototype,v.F=m.prototype,v.prototype=new g,v.prototype.constructor=v,v.D=function(T,E,I){for(var p=Array(arguments.length-2),at=2;at<arguments.length;at++)p[at-2]=arguments[at];return m.prototype[E].apply(T,p)}}function e(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(n,e),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(v,m,g){g||(g=0);const T=Array(16);if(typeof m=="string")for(var E=0;E<16;++E)T[E]=m.charCodeAt(g++)|m.charCodeAt(g++)<<8|m.charCodeAt(g++)<<16|m.charCodeAt(g++)<<24;else for(E=0;E<16;++E)T[E]=m[g++]|m[g++]<<8|m[g++]<<16|m[g++]<<24;m=v.g[0],g=v.g[1],E=v.g[2];let I=v.g[3],p;p=m+(I^g&(E^I))+T[0]+3614090360&4294967295,m=g+(p<<7&4294967295|p>>>25),p=I+(E^m&(g^E))+T[1]+3905402710&4294967295,I=m+(p<<12&4294967295|p>>>20),p=E+(g^I&(m^g))+T[2]+606105819&4294967295,E=I+(p<<17&4294967295|p>>>15),p=g+(m^E&(I^m))+T[3]+3250441966&4294967295,g=E+(p<<22&4294967295|p>>>10),p=m+(I^g&(E^I))+T[4]+4118548399&4294967295,m=g+(p<<7&4294967295|p>>>25),p=I+(E^m&(g^E))+T[5]+1200080426&4294967295,I=m+(p<<12&4294967295|p>>>20),p=E+(g^I&(m^g))+T[6]+2821735955&4294967295,E=I+(p<<17&4294967295|p>>>15),p=g+(m^E&(I^m))+T[7]+4249261313&4294967295,g=E+(p<<22&4294967295|p>>>10),p=m+(I^g&(E^I))+T[8]+1770035416&4294967295,m=g+(p<<7&4294967295|p>>>25),p=I+(E^m&(g^E))+T[9]+2336552879&4294967295,I=m+(p<<12&4294967295|p>>>20),p=E+(g^I&(m^g))+T[10]+4294925233&4294967295,E=I+(p<<17&4294967295|p>>>15),p=g+(m^E&(I^m))+T[11]+2304563134&4294967295,g=E+(p<<22&4294967295|p>>>10),p=m+(I^g&(E^I))+T[12]+1804603682&4294967295,m=g+(p<<7&4294967295|p>>>25),p=I+(E^m&(g^E))+T[13]+4254626195&4294967295,I=m+(p<<12&4294967295|p>>>20),p=E+(g^I&(m^g))+T[14]+2792965006&4294967295,E=I+(p<<17&4294967295|p>>>15),p=g+(m^E&(I^m))+T[15]+1236535329&4294967295,g=E+(p<<22&4294967295|p>>>10),p=m+(E^I&(g^E))+T[1]+4129170786&4294967295,m=g+(p<<5&4294967295|p>>>27),p=I+(g^E&(m^g))+T[6]+3225465664&4294967295,I=m+(p<<9&4294967295|p>>>23),p=E+(m^g&(I^m))+T[11]+643717713&4294967295,E=I+(p<<14&4294967295|p>>>18),p=g+(I^m&(E^I))+T[0]+3921069994&4294967295,g=E+(p<<20&4294967295|p>>>12),p=m+(E^I&(g^E))+T[5]+3593408605&4294967295,m=g+(p<<5&4294967295|p>>>27),p=I+(g^E&(m^g))+T[10]+38016083&4294967295,I=m+(p<<9&4294967295|p>>>23),p=E+(m^g&(I^m))+T[15]+3634488961&4294967295,E=I+(p<<14&4294967295|p>>>18),p=g+(I^m&(E^I))+T[4]+3889429448&4294967295,g=E+(p<<20&4294967295|p>>>12),p=m+(E^I&(g^E))+T[9]+568446438&4294967295,m=g+(p<<5&4294967295|p>>>27),p=I+(g^E&(m^g))+T[14]+3275163606&4294967295,I=m+(p<<9&4294967295|p>>>23),p=E+(m^g&(I^m))+T[3]+4107603335&4294967295,E=I+(p<<14&4294967295|p>>>18),p=g+(I^m&(E^I))+T[8]+1163531501&4294967295,g=E+(p<<20&4294967295|p>>>12),p=m+(E^I&(g^E))+T[13]+2850285829&4294967295,m=g+(p<<5&4294967295|p>>>27),p=I+(g^E&(m^g))+T[2]+4243563512&4294967295,I=m+(p<<9&4294967295|p>>>23),p=E+(m^g&(I^m))+T[7]+1735328473&4294967295,E=I+(p<<14&4294967295|p>>>18),p=g+(I^m&(E^I))+T[12]+2368359562&4294967295,g=E+(p<<20&4294967295|p>>>12),p=m+(g^E^I)+T[5]+4294588738&4294967295,m=g+(p<<4&4294967295|p>>>28),p=I+(m^g^E)+T[8]+2272392833&4294967295,I=m+(p<<11&4294967295|p>>>21),p=E+(I^m^g)+T[11]+1839030562&4294967295,E=I+(p<<16&4294967295|p>>>16),p=g+(E^I^m)+T[14]+4259657740&4294967295,g=E+(p<<23&4294967295|p>>>9),p=m+(g^E^I)+T[1]+2763975236&4294967295,m=g+(p<<4&4294967295|p>>>28),p=I+(m^g^E)+T[4]+1272893353&4294967295,I=m+(p<<11&4294967295|p>>>21),p=E+(I^m^g)+T[7]+4139469664&4294967295,E=I+(p<<16&4294967295|p>>>16),p=g+(E^I^m)+T[10]+3200236656&4294967295,g=E+(p<<23&4294967295|p>>>9),p=m+(g^E^I)+T[13]+681279174&4294967295,m=g+(p<<4&4294967295|p>>>28),p=I+(m^g^E)+T[0]+3936430074&4294967295,I=m+(p<<11&4294967295|p>>>21),p=E+(I^m^g)+T[3]+3572445317&4294967295,E=I+(p<<16&4294967295|p>>>16),p=g+(E^I^m)+T[6]+76029189&4294967295,g=E+(p<<23&4294967295|p>>>9),p=m+(g^E^I)+T[9]+3654602809&4294967295,m=g+(p<<4&4294967295|p>>>28),p=I+(m^g^E)+T[12]+3873151461&4294967295,I=m+(p<<11&4294967295|p>>>21),p=E+(I^m^g)+T[15]+530742520&4294967295,E=I+(p<<16&4294967295|p>>>16),p=g+(E^I^m)+T[2]+3299628645&4294967295,g=E+(p<<23&4294967295|p>>>9),p=m+(E^(g|~I))+T[0]+4096336452&4294967295,m=g+(p<<6&4294967295|p>>>26),p=I+(g^(m|~E))+T[7]+1126891415&4294967295,I=m+(p<<10&4294967295|p>>>22),p=E+(m^(I|~g))+T[14]+2878612391&4294967295,E=I+(p<<15&4294967295|p>>>17),p=g+(I^(E|~m))+T[5]+4237533241&4294967295,g=E+(p<<21&4294967295|p>>>11),p=m+(E^(g|~I))+T[12]+1700485571&4294967295,m=g+(p<<6&4294967295|p>>>26),p=I+(g^(m|~E))+T[3]+2399980690&4294967295,I=m+(p<<10&4294967295|p>>>22),p=E+(m^(I|~g))+T[10]+4293915773&4294967295,E=I+(p<<15&4294967295|p>>>17),p=g+(I^(E|~m))+T[1]+2240044497&4294967295,g=E+(p<<21&4294967295|p>>>11),p=m+(E^(g|~I))+T[8]+1873313359&4294967295,m=g+(p<<6&4294967295|p>>>26),p=I+(g^(m|~E))+T[15]+4264355552&4294967295,I=m+(p<<10&4294967295|p>>>22),p=E+(m^(I|~g))+T[6]+2734768916&4294967295,E=I+(p<<15&4294967295|p>>>17),p=g+(I^(E|~m))+T[13]+1309151649&4294967295,g=E+(p<<21&4294967295|p>>>11),p=m+(E^(g|~I))+T[4]+4149444226&4294967295,m=g+(p<<6&4294967295|p>>>26),p=I+(g^(m|~E))+T[11]+3174756917&4294967295,I=m+(p<<10&4294967295|p>>>22),p=E+(m^(I|~g))+T[2]+718787259&4294967295,E=I+(p<<15&4294967295|p>>>17),p=g+(I^(E|~m))+T[9]+3951481745&4294967295,v.g[0]=v.g[0]+m&4294967295,v.g[1]=v.g[1]+(E+(p<<21&4294967295|p>>>11))&4294967295,v.g[2]=v.g[2]+E&4294967295,v.g[3]=v.g[3]+I&4294967295}n.prototype.v=function(v,m){m===void 0&&(m=v.length);const g=m-this.blockSize,T=this.C;let E=this.h,I=0;for(;I<m;){if(E==0)for(;I<=g;)i(this,v,I),I+=this.blockSize;if(typeof v=="string"){for(;I<m;)if(T[E++]=v.charCodeAt(I++),E==this.blockSize){i(this,T),E=0;break}}else for(;I<m;)if(T[E++]=v[I++],E==this.blockSize){i(this,T),E=0;break}}this.h=E,this.o+=m},n.prototype.A=function(){var v=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);v[0]=128;for(var m=1;m<v.length-8;++m)v[m]=0;m=this.o*8;for(var g=v.length-8;g<v.length;++g)v[g]=m&255,m/=256;for(this.v(v),v=Array(16),m=0,g=0;g<4;++g)for(let T=0;T<32;T+=8)v[m++]=this.g[g]>>>T&255;return v};function o(v,m){var g=u;return Object.prototype.hasOwnProperty.call(g,v)?g[v]:g[v]=m(v)}function a(v,m){this.h=m;const g=[];let T=!0;for(let E=v.length-1;E>=0;E--){const I=v[E]|0;T&&I==m||(g[E]=I,T=!1)}this.g=g}var u={};function f(v){return-128<=v&&v<128?o(v,function(m){return new a([m|0],m<0?-1:0)}):new a([v|0],v<0?-1:0)}function d(v){if(isNaN(v)||!isFinite(v))return w;if(v<0)return L(d(-v));const m=[];let g=1;for(let T=0;v>=g;T++)m[T]=v/g|0,g*=4294967296;return new a(m,0)}function _(v,m){if(v.length==0)throw Error("number format error: empty string");if(m=m||10,m<2||36<m)throw Error("radix out of range: "+m);if(v.charAt(0)=="-")return L(_(v.substring(1),m));if(v.indexOf("-")>=0)throw Error('number format error: interior "-" character');const g=d(Math.pow(m,8));let T=w;for(let I=0;I<v.length;I+=8){var E=Math.min(8,v.length-I);const p=parseInt(v.substring(I,I+E),m);E<8?(E=d(Math.pow(m,E)),T=T.j(E).add(d(p))):(T=T.j(g),T=T.add(d(p)))}return T}var w=f(0),R=f(1),C=f(16777216);r=a.prototype,r.m=function(){if(U(this))return-L(this).m();let v=0,m=1;for(let g=0;g<this.g.length;g++){const T=this.i(g);v+=(T>=0?T:4294967296+T)*m,m*=4294967296}return v},r.toString=function(v){if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(B(this))return"0";if(U(this))return"-"+L(this).toString(v);const m=d(Math.pow(v,6));var g=this;let T="";for(;;){const E=Et(g,m).g;g=Y(g,E.j(m));let I=((g.g.length>0?g.g[0]:g.h)>>>0).toString(v);if(g=E,B(g))return I+T;for(;I.length<6;)I="0"+I;T=I+T}},r.i=function(v){return v<0?0:v<this.g.length?this.g[v]:this.h};function B(v){if(v.h!=0)return!1;for(let m=0;m<v.g.length;m++)if(v.g[m]!=0)return!1;return!0}function U(v){return v.h==-1}r.l=function(v){return v=Y(this,v),U(v)?-1:B(v)?0:1};function L(v){const m=v.g.length,g=[];for(let T=0;T<m;T++)g[T]=~v.g[T];return new a(g,~v.h).add(R)}r.abs=function(){return U(this)?L(this):this},r.add=function(v){const m=Math.max(this.g.length,v.g.length),g=[];let T=0;for(let E=0;E<=m;E++){let I=T+(this.i(E)&65535)+(v.i(E)&65535),p=(I>>>16)+(this.i(E)>>>16)+(v.i(E)>>>16);T=p>>>16,I&=65535,p&=65535,g[E]=p<<16|I}return new a(g,g[g.length-1]&-2147483648?-1:0)};function Y(v,m){return v.add(L(m))}r.j=function(v){if(B(this)||B(v))return w;if(U(this))return U(v)?L(this).j(L(v)):L(L(this).j(v));if(U(v))return L(this.j(L(v)));if(this.l(C)<0&&v.l(C)<0)return d(this.m()*v.m());const m=this.g.length+v.g.length,g=[];for(var T=0;T<2*m;T++)g[T]=0;for(T=0;T<this.g.length;T++)for(let E=0;E<v.g.length;E++){const I=this.i(T)>>>16,p=this.i(T)&65535,at=v.i(E)>>>16,Dt=v.i(E)&65535;g[2*T+2*E]+=p*Dt,$(g,2*T+2*E),g[2*T+2*E+1]+=I*Dt,$(g,2*T+2*E+1),g[2*T+2*E+1]+=p*at,$(g,2*T+2*E+1),g[2*T+2*E+2]+=I*at,$(g,2*T+2*E+2)}for(v=0;v<m;v++)g[v]=g[2*v+1]<<16|g[2*v];for(v=m;v<2*m;v++)g[v]=0;return new a(g,0)};function $(v,m){for(;(v[m]&65535)!=v[m];)v[m+1]+=v[m]>>>16,v[m]&=65535,m++}function X(v,m){this.g=v,this.h=m}function Et(v,m){if(B(m))throw Error("division by zero");if(B(v))return new X(w,w);if(U(v))return m=Et(L(v),m),new X(L(m.g),L(m.h));if(U(m))return m=Et(v,L(m)),new X(L(m.g),m.h);if(v.g.length>30){if(U(v)||U(m))throw Error("slowDivide_ only works with positive integers.");for(var g=R,T=m;T.l(v)<=0;)g=It(g),T=It(T);var E=ot(g,1),I=ot(T,1);for(T=ot(T,2),g=ot(g,2);!B(T);){var p=I.add(T);p.l(v)<=0&&(E=E.add(g),I=p),T=ot(T,1),g=ot(g,1)}return m=Y(v,E.j(m)),new X(E,m)}for(E=w;v.l(m)>=0;){for(g=Math.max(1,Math.floor(v.m()/m.m())),T=Math.ceil(Math.log(g)/Math.LN2),T=T<=48?1:Math.pow(2,T-48),I=d(g),p=I.j(m);U(p)||p.l(v)>0;)g-=T,I=d(g),p=I.j(m);B(I)&&(I=R),E=E.add(I),v=Y(v,p)}return new X(E,v)}r.B=function(v){return Et(this,v).h},r.and=function(v){const m=Math.max(this.g.length,v.g.length),g=[];for(let T=0;T<m;T++)g[T]=this.i(T)&v.i(T);return new a(g,this.h&v.h)},r.or=function(v){const m=Math.max(this.g.length,v.g.length),g=[];for(let T=0;T<m;T++)g[T]=this.i(T)|v.i(T);return new a(g,this.h|v.h)},r.xor=function(v){const m=Math.max(this.g.length,v.g.length),g=[];for(let T=0;T<m;T++)g[T]=this.i(T)^v.i(T);return new a(g,this.h^v.h)};function It(v){const m=v.g.length+1,g=[];for(let T=0;T<m;T++)g[T]=v.i(T)<<1|v.i(T-1)>>>31;return new a(g,v.h)}function ot(v,m){const g=m>>5;m%=32;const T=v.g.length-g,E=[];for(let I=0;I<T;I++)E[I]=m>0?v.i(I+g)>>>m|v.i(I+g+1)<<32-m:v.i(I+g);return new a(E,v.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,Ra=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=_,ie=a}).apply(typeof po<"u"?po:typeof self<"u"?self:typeof window<"u"?window:{});var fr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ba,Cn,Ca,yr,bs,Pa,Va,Da;(function(){var r,t=Object.defineProperty;function e(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof fr=="object"&&fr];for(var l=0;l<s.length;++l){var c=s[l];if(c&&c.Math==Math)return c}throw Error("Cannot find global object")}var n=e(this);function i(s,l){if(l)t:{var c=n;s=s.split(".");for(var h=0;h<s.length-1;h++){var A=s[h];if(!(A in c))break t;c=c[A]}s=s[s.length-1],h=c[s],l=l(h),l!=h&&l!=null&&t(c,s,{configurable:!0,writable:!0,value:l})}}i("Symbol.dispose",function(s){return s||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(s){return s||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(s){return s||function(l){var c=[],h;for(h in l)Object.prototype.hasOwnProperty.call(l,h)&&c.push([h,l[h]]);return c}});var o=o||{},a=this||self;function u(s){var l=typeof s;return l=="object"&&s!=null||l=="function"}function f(s,l,c){return s.call.apply(s.bind,arguments)}function d(s,l,c){return d=f,d.apply(null,arguments)}function _(s,l){var c=Array.prototype.slice.call(arguments,1);return function(){var h=c.slice();return h.push.apply(h,arguments),s.apply(this,h)}}function w(s,l){function c(){}c.prototype=l.prototype,s.Z=l.prototype,s.prototype=new c,s.prototype.constructor=s,s.Ob=function(h,A,S){for(var D=Array(arguments.length-2),G=2;G<arguments.length;G++)D[G-2]=arguments[G];return l.prototype[A].apply(h,D)}}var R=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?s=>s&&AsyncContext.Snapshot.wrap(s):s=>s;function C(s){const l=s.length;if(l>0){const c=Array(l);for(let h=0;h<l;h++)c[h]=s[h];return c}return[]}function B(s,l){for(let h=1;h<arguments.length;h++){const A=arguments[h];var c=typeof A;if(c=c!="object"?c:A?Array.isArray(A)?"array":c:"null",c=="array"||c=="object"&&typeof A.length=="number"){c=s.length||0;const S=A.length||0;s.length=c+S;for(let D=0;D<S;D++)s[c+D]=A[D]}else s.push(A)}}class U{constructor(l,c){this.i=l,this.j=c,this.h=0,this.g=null}get(){let l;return this.h>0?(this.h--,l=this.g,this.g=l.next,l.next=null):l=this.i(),l}}function L(s){a.setTimeout(()=>{throw s},0)}function Y(){var s=v;let l=null;return s.g&&(l=s.g,s.g=s.g.next,s.g||(s.h=null),l.next=null),l}class ${constructor(){this.h=this.g=null}add(l,c){const h=X.get();h.set(l,c),this.h?this.h.next=h:this.g=h,this.h=h}}var X=new U(()=>new Et,s=>s.reset());class Et{constructor(){this.next=this.g=this.h=null}set(l,c){this.h=l,this.g=c,this.next=null}reset(){this.next=this.g=this.h=null}}let It,ot=!1,v=new $,m=()=>{const s=Promise.resolve(void 0);It=()=>{s.then(g)}};function g(){for(var s;s=Y();){try{s.h.call(s.g)}catch(c){L(c)}var l=X;l.j(s),l.h<100&&(l.h++,s.next=l.g,l.g=s)}ot=!1}function T(){this.u=this.u,this.C=this.C}T.prototype.u=!1,T.prototype.dispose=function(){this.u||(this.u=!0,this.N())},T.prototype[Symbol.dispose]=function(){this.dispose()},T.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function E(s,l){this.type=s,this.g=this.target=l,this.defaultPrevented=!1}E.prototype.h=function(){this.defaultPrevented=!0};var I=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var s=!1,l=Object.defineProperty({},"passive",{get:function(){s=!0}});try{const c=()=>{};a.addEventListener("test",c,l),a.removeEventListener("test",c,l)}catch{}return s})();function p(s){return/^[\s\xa0]*$/.test(s)}function at(s,l){E.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s&&this.init(s,l)}w(at,E),at.prototype.init=function(s,l){const c=this.type=s.type,h=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;this.target=s.target||s.srcElement,this.g=l,l=s.relatedTarget,l||(c=="mouseover"?l=s.fromElement:c=="mouseout"&&(l=s.toElement)),this.relatedTarget=l,h?(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=s.pointerType,this.state=s.state,this.i=s,s.defaultPrevented&&at.Z.h.call(this)},at.prototype.h=function(){at.Z.h.call(this);const s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var Dt="closure_listenable_"+(Math.random()*1e6|0),on=0;function an(s,l,c,h,A){this.listener=s,this.proxy=null,this.src=l,this.type=c,this.capture=!!h,this.ha=A,this.key=++on,this.da=this.fa=!1}function Gt(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function Kt(s,l,c){for(const h in s)l.call(c,s[h],h,s)}function $n(s,l){for(const c in s)l.call(void 0,s[c],c,s)}function ln(s){const l={};for(const c in s)l[c]=s[c];return l}const cn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function un(s,l){let c,h;for(let A=1;A<arguments.length;A++){h=arguments[A];for(c in h)s[c]=h[c];for(let S=0;S<cn.length;S++)c=cn[S],Object.prototype.hasOwnProperty.call(h,c)&&(s[c]=h[c])}}function pe(s){this.src=s,this.g={},this.h=0}pe.prototype.add=function(s,l,c,h,A){const S=s.toString();s=this.g[S],s||(s=this.g[S]=[],this.h++);const D=Ne(s,l,h,A);return D>-1?(l=s[D],c||(l.fa=!1)):(l=new an(l,this.src,S,!!h,A),l.fa=c,s.push(l)),l};function ye(s,l){const c=l.type;if(c in s.g){var h=s.g[c],A=Array.prototype.indexOf.call(h,l,void 0),S;(S=A>=0)&&Array.prototype.splice.call(h,A,1),S&&(Gt(l),s.g[c].length==0&&(delete s.g[c],s.h--))}}function Ne(s,l,c,h){for(let A=0;A<s.length;++A){const S=s[A];if(!S.da&&S.listener==l&&S.capture==!!c&&S.ha==h)return A}return-1}var Qt="closure_lm_"+(Math.random()*1e6|0),ke={};function _e(s,l,c,h,A){if(Array.isArray(l)){for(let S=0;S<l.length;S++)_e(s,l[S],c,h,A);return null}return c=gn(c),s&&s[Dt]?s.J(l,c,u(h)?!!h.capture:!1,A):hn(s,l,c,!1,h,A)}function hn(s,l,c,h,A,S){if(!l)throw Error("Invalid event type");const D=u(A)?!!A.capture:!!A;let G=Oe(s);if(G||(s[Qt]=G=new pe(s)),c=G.add(l,c,h,D,S),c.proxy)return c;if(h=Qr(),c.proxy=h,h.src=s,h.listener=c,s.addEventListener)I||(A=D),A===void 0&&(A=!1),s.addEventListener(l.toString(),h,A);else if(s.attachEvent)s.attachEvent(Xn(l.toString()),h);else if(s.addListener&&s.removeListener)s.addListener(h);else throw Error("addEventListener and attachEvent are unavailable.");return c}function Qr(){function s(c){return l.call(s.src,s.listener,c)}const l=Wr;return s}function Yn(s,l,c,h,A){if(Array.isArray(l))for(var S=0;S<l.length;S++)Yn(s,l[S],c,h,A);else h=u(h)?!!h.capture:!!h,c=gn(c),s&&s[Dt]?(s=s.i,S=String(l).toString(),S in s.g&&(l=s.g[S],c=Ne(l,c,h,A),c>-1&&(Gt(l[c]),Array.prototype.splice.call(l,c,1),l.length==0&&(delete s.g[S],s.h--)))):s&&(s=Oe(s))&&(l=s.g[l.toString()],s=-1,l&&(s=Ne(l,c,h,A)),(c=s>-1?l[s]:null)&&fn(c))}function fn(s){if(typeof s!="number"&&s&&!s.da){var l=s.src;if(l&&l[Dt])ye(l.i,s);else{var c=s.type,h=s.proxy;l.removeEventListener?l.removeEventListener(c,h,s.capture):l.detachEvent?l.detachEvent(Xn(c),h):l.addListener&&l.removeListener&&l.removeListener(h),(c=Oe(l))?(ye(c,s),c.h==0&&(c.src=null,l[Qt]=null)):Gt(s)}}}function Xn(s){return s in ke?ke[s]:ke[s]="on"+s}function Wr(s,l){if(s.da)s=!0;else{l=new at(l,this);const c=s.listener,h=s.ha||s.src;s.fa&&fn(s),s=c.call(h,l)}return s}function Oe(s){return s=s[Qt],s instanceof pe?s:null}var dn="__closure_events_fn_"+(Math.random()*1e9>>>0);function gn(s){return typeof s=="function"?s:(s[dn]||(s[dn]=function(l){return s.handleEvent(l)}),s[dn])}function ft(){T.call(this),this.i=new pe(this),this.M=this,this.G=null}w(ft,T),ft.prototype[Dt]=!0,ft.prototype.removeEventListener=function(s,l,c,h){Yn(this,s,l,c,h)};function pt(s,l){var c,h=s.G;if(h)for(c=[];h;h=h.G)c.push(h);if(s=s.M,h=l.type||l,typeof l=="string")l=new E(l,s);else if(l instanceof E)l.target=l.target||s;else{var A=l;l=new E(h,s),un(l,A)}A=!0;let S,D;if(c)for(D=c.length-1;D>=0;D--)S=l.g=c[D],A=Wt(S,h,!0,l)&&A;if(S=l.g=s,A=Wt(S,h,!0,l)&&A,A=Wt(S,h,!1,l)&&A,c)for(D=0;D<c.length;D++)S=l.g=c[D],A=Wt(S,h,!1,l)&&A}ft.prototype.N=function(){if(ft.Z.N.call(this),this.i){var s=this.i;for(const l in s.g){const c=s.g[l];for(let h=0;h<c.length;h++)Gt(c[h]);delete s.g[l],s.h--}}this.G=null},ft.prototype.J=function(s,l,c,h){return this.i.add(String(s),l,!1,c,h)},ft.prototype.K=function(s,l,c,h){return this.i.add(String(s),l,!0,c,h)};function Wt(s,l,c,h){if(l=s.i.g[String(l)],!l)return!0;l=l.concat();let A=!0;for(let S=0;S<l.length;++S){const D=l[S];if(D&&!D.da&&D.capture==c){const G=D.listener,dt=D.ha||D.src;D.fa&&ye(s.i,D),A=G.call(dt,h)!==!1&&A}}return A&&!h.defaultPrevented}function $r(s,l){if(typeof s!="function")if(s&&typeof s.handleEvent=="function")s=d(s.handleEvent,s);else throw Error("Invalid listener argument");return Number(l)>2147483647?-1:a.setTimeout(s,l||0)}function Jn(s){s.g=$r(()=>{s.g=null,s.i&&(s.i=!1,Jn(s))},s.l);const l=s.h;s.h=null,s.m.apply(null,l)}class Yr extends T{constructor(l,c){super(),this.m=l,this.l=c,this.h=null,this.i=!1,this.g=null}j(l){this.h=arguments,this.g?this.i=!0:Jn(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ee(s){T.call(this),this.h=s,this.g={}}w(Ee,T);var Zn=[];function tr(s){Kt(s.g,function(l,c){this.g.hasOwnProperty(c)&&fn(l)},s),s.g={}}Ee.prototype.N=function(){Ee.Z.N.call(this),tr(this)},Ee.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var N=a.JSON.stringify,y=a.JSON.parse,V=class{stringify(s){return a.JSON.stringify(s,void 0)}parse(s){return a.JSON.parse(s,void 0)}};function k(){}function x(){}var bt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ot(){E.call(this,"d")}w(Ot,E);function Nt(){E.call(this,"c")}w(Nt,E);var kt={},er=null;function ve(){return er=er||new ft}kt.Ia="serverreachability";function rt(s){E.call(this,kt.Ia,s)}w(rt,E);function Te(s){const l=ve();pt(l,new rt(l))}kt.STAT_EVENT="statevent";function Le(s,l){E.call(this,kt.STAT_EVENT,s),this.stat=l}w(Le,E);function lt(s){const l=ve();pt(l,new Le(l,s))}kt.Ja="timingevent";function _i(s,l){E.call(this,kt.Ja,s),this.size=l}w(_i,E);function mn(s,l){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){s()},l)}function pn(){this.g=!0}pn.prototype.ua=function(){this.g=!1};function ql(s,l,c,h,A,S){s.info(function(){if(s.g)if(S){var D="",G=S.split("&");for(let J=0;J<G.length;J++){var dt=G[J].split("=");if(dt.length>1){const yt=dt[0];dt=dt[1];const Mt=yt.split("_");D=Mt.length>=2&&Mt[1]=="type"?D+(yt+"="+dt+"&"):D+(yt+"=redacted&")}}}else D=null;else D=S;return"XMLHTTP REQ ("+h+") [attempt "+A+"]: "+l+`
`+c+`
`+D})}function Gl(s,l,c,h,A,S,D){s.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+A+"]: "+l+`
`+c+`
`+S+" "+D})}function Me(s,l,c,h){s.info(function(){return"XMLHTTP TEXT ("+l+"): "+Hl(s,c)+(h?" "+h:"")})}function zl(s,l){s.info(function(){return"TIMEOUT: "+l})}pn.prototype.info=function(){};function Hl(s,l){if(!s.g)return l;if(!l)return null;try{const S=JSON.parse(l);if(S){for(s=0;s<S.length;s++)if(Array.isArray(S[s])){var c=S[s];if(!(c.length<2)){var h=c[1];if(Array.isArray(h)&&!(h.length<1)){var A=h[0];if(A!="noop"&&A!="stop"&&A!="close")for(let D=1;D<h.length;D++)h[D]=""}}}}return N(S)}catch{return l}}var nr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ei={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},vi;function Xr(){}w(Xr,k),Xr.prototype.g=function(){return new XMLHttpRequest},vi=new Xr;function yn(s){return encodeURIComponent(String(s))}function Kl(s){var l=1;s=s.split(":");const c=[];for(;l>0&&s.length;)c.push(s.shift()),l--;return s.length&&c.push(s.join(":")),c}function $t(s,l,c,h){this.j=s,this.i=l,this.l=c,this.S=h||1,this.V=new Ee(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ti}function Ti(){this.i=null,this.g="",this.h=!1}var Ii={},Jr={};function Zr(s,l,c){s.M=1,s.A=sr(Lt(l)),s.u=c,s.R=!0,Ai(s,null)}function Ai(s,l){s.F=Date.now(),rr(s),s.B=Lt(s.A);var c=s.B,h=s.S;Array.isArray(h)||(h=[String(h)]),Mi(c.i,"t",h),s.C=0,c=s.j.L,s.h=new Ti,s.g=to(s.j,c?l:null,!s.u),s.P>0&&(s.O=new Yr(d(s.Y,s,s.g),s.P)),l=s.V,c=s.g,h=s.ba;var A="readystatechange";Array.isArray(A)||(A&&(Zn[0]=A.toString()),A=Zn);for(let S=0;S<A.length;S++){const D=_e(c,A[S],h||l.handleEvent,!1,l.h||l);if(!D)break;l.g[D.key]=D}l=s.J?ln(s.J):{},s.u?(s.v||(s.v="POST"),l["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.B,s.v,s.u,l)):(s.v="GET",s.g.ea(s.B,s.v,null,l)),Te(),ql(s.i,s.v,s.B,s.l,s.S,s.u)}$t.prototype.ba=function(s){s=s.target;const l=this.O;l&&Jt(s)==3?l.j():this.Y(s)},$t.prototype.Y=function(s){try{if(s==this.g)t:{const G=Jt(this.g),dt=this.g.ya(),J=this.g.ca();if(!(G<3)&&(G!=3||this.g&&(this.h.h||this.g.la()||Gi(this.g)))){this.K||G!=4||dt==7||(dt==8||J<=0?Te(3):Te(2)),ts(this);var l=this.g.ca();this.X=l;var c=Ql(this);if(this.o=l==200,Gl(this.i,this.v,this.B,this.l,this.S,G,l),this.o){if(this.U&&!this.L){e:{if(this.g){var h,A=this.g;if((h=A.g?A.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(h)){var S=h;break e}}S=null}if(s=S)Me(this.i,this.l,s,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,es(this,s);else{this.o=!1,this.m=3,lt(12),Ie(this),_n(this);break t}}if(this.R){s=!0;let yt;for(;!this.K&&this.C<c.length;)if(yt=Wl(this,c),yt==Jr){G==4&&(this.m=4,lt(14),s=!1),Me(this.i,this.l,null,"[Incomplete Response]");break}else if(yt==Ii){this.m=4,lt(15),Me(this.i,this.l,c,"[Invalid Chunk]"),s=!1;break}else Me(this.i,this.l,yt,null),es(this,yt);if(wi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),G!=4||c.length!=0||this.h.h||(this.m=1,lt(16),s=!1),this.o=this.o&&s,!s)Me(this.i,this.l,c,"[Invalid Chunked Response]"),Ie(this),_n(this);else if(c.length>0&&!this.W){this.W=!0;var D=this.j;D.g==this&&D.aa&&!D.P&&(D.j.info("Great, no buffering proxy detected. Bytes received: "+c.length),cs(D),D.P=!0,lt(11))}}else Me(this.i,this.l,c,null),es(this,c);G==4&&Ie(this),this.o&&!this.K&&(G==4?Yi(this.j,this):(this.o=!1,rr(this)))}else lc(this.g),l==400&&c.indexOf("Unknown SID")>0?(this.m=3,lt(12)):(this.m=0,lt(13)),Ie(this),_n(this)}}}catch{}};function Ql(s){if(!wi(s))return s.g.la();const l=Gi(s.g);if(l==="")return"";let c="";const h=l.length,A=Jt(s.g)==4;if(!s.h.i){if(typeof TextDecoder>"u")return Ie(s),_n(s),"";s.h.i=new a.TextDecoder}for(let S=0;S<h;S++)s.h.h=!0,c+=s.h.i.decode(l[S],{stream:!(A&&S==h-1)});return l.length=0,s.h.g+=c,s.C=0,s.h.g}function wi(s){return s.g?s.v=="GET"&&s.M!=2&&s.j.Aa:!1}function Wl(s,l){var c=s.C,h=l.indexOf(`
`,c);return h==-1?Jr:(c=Number(l.substring(c,h)),isNaN(c)?Ii:(h+=1,h+c>l.length?Jr:(l=l.slice(h,h+c),s.C=h+c,l)))}$t.prototype.cancel=function(){this.K=!0,Ie(this)};function rr(s){s.T=Date.now()+s.H,Si(s,s.H)}function Si(s,l){if(s.D!=null)throw Error("WatchDog timer not null");s.D=mn(d(s.aa,s),l)}function ts(s){s.D&&(a.clearTimeout(s.D),s.D=null)}$t.prototype.aa=function(){this.D=null;const s=Date.now();s-this.T>=0?(zl(this.i,this.B),this.M!=2&&(Te(),lt(17)),Ie(this),this.m=2,_n(this)):Si(this,this.T-s)};function _n(s){s.j.I==0||s.K||Yi(s.j,s)}function Ie(s){ts(s);var l=s.O;l&&typeof l.dispose=="function"&&l.dispose(),s.O=null,tr(s.V),s.g&&(l=s.g,s.g=null,l.abort(),l.dispose())}function es(s,l){try{var c=s.j;if(c.I!=0&&(c.g==s||ns(c.h,s))){if(!s.L&&ns(c.h,s)&&c.I==3){try{var h=c.Ba.g.parse(l)}catch{h=null}if(Array.isArray(h)&&h.length==3){var A=h;if(A[0]==0){t:if(!c.v){if(c.g)if(c.g.F+3e3<s.F)cr(c),ar(c);else break t;ls(c),lt(18)}}else c.xa=A[1],0<c.xa-c.K&&A[2]<37500&&c.F&&c.A==0&&!c.C&&(c.C=mn(d(c.Va,c),6e3));Ci(c.h)<=1&&c.ta&&(c.ta=void 0)}else we(c,11)}else if((s.L||c.g==s)&&cr(c),!p(l))for(A=c.Ba.g.parse(l),l=0;l<A.length;l++){let J=A[l];const yt=J[0];if(!(yt<=c.K))if(c.K=yt,J=J[1],c.I==2)if(J[0]=="c"){c.M=J[1],c.ba=J[2];const Mt=J[3];Mt!=null&&(c.ka=Mt,c.j.info("VER="+c.ka));const Se=J[4];Se!=null&&(c.za=Se,c.j.info("SVER="+c.za));const Zt=J[5];Zt!=null&&typeof Zt=="number"&&Zt>0&&(h=1.5*Zt,c.O=h,c.j.info("backChannelRequestTimeoutMs_="+h)),h=c;const te=s.g;if(te){const hr=te.g?te.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(hr){var S=h.h;S.g||hr.indexOf("spdy")==-1&&hr.indexOf("quic")==-1&&hr.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(rs(S,S.h),S.h=null))}if(h.G){const us=te.g?te.g.getResponseHeader("X-HTTP-Session-Id"):null;us&&(h.wa=us,Z(h.J,h.G,us))}}c.I=3,c.l&&c.l.ra(),c.aa&&(c.T=Date.now()-s.F,c.j.info("Handshake RTT: "+c.T+"ms")),h=c;var D=s;if(h.na=Zi(h,h.L?h.ba:null,h.W),D.L){Pi(h.h,D);var G=D,dt=h.O;dt&&(G.H=dt),G.D&&(ts(G),rr(G)),h.g=D}else Wi(h);c.i.length>0&&lr(c)}else J[0]!="stop"&&J[0]!="close"||we(c,7);else c.I==3&&(J[0]=="stop"||J[0]=="close"?J[0]=="stop"?we(c,7):as(c):J[0]!="noop"&&c.l&&c.l.qa(J),c.A=0)}}Te(4)}catch{}}var $l=class{constructor(s,l){this.g=s,this.map=l}};function Ri(s){this.l=s||10,a.PerformanceNavigationTiming?(s=a.performance.getEntriesByType("navigation"),s=s.length>0&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function bi(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function Ci(s){return s.h?1:s.g?s.g.size:0}function ns(s,l){return s.h?s.h==l:s.g?s.g.has(l):!1}function rs(s,l){s.g?s.g.add(l):s.h=l}function Pi(s,l){s.h&&s.h==l?s.h=null:s.g&&s.g.has(l)&&s.g.delete(l)}Ri.prototype.cancel=function(){if(this.i=Vi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const s of this.g.values())s.cancel();this.g.clear()}};function Vi(s){if(s.h!=null)return s.i.concat(s.h.G);if(s.g!=null&&s.g.size!==0){let l=s.i;for(const c of s.g.values())l=l.concat(c.G);return l}return C(s.i)}var Di=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yl(s,l){if(s){s=s.split("&");for(let c=0;c<s.length;c++){const h=s[c].indexOf("=");let A,S=null;h>=0?(A=s[c].substring(0,h),S=s[c].substring(h+1)):A=s[c],l(A,S?decodeURIComponent(S.replace(/\+/g," ")):"")}}}function Yt(s){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let l;s instanceof Yt?(this.l=s.l,En(this,s.j),this.o=s.o,this.g=s.g,vn(this,s.u),this.h=s.h,ss(this,xi(s.i)),this.m=s.m):s&&(l=String(s).match(Di))?(this.l=!1,En(this,l[1]||"",!0),this.o=Tn(l[2]||""),this.g=Tn(l[3]||"",!0),vn(this,l[4]),this.h=Tn(l[5]||"",!0),ss(this,l[6]||"",!0),this.m=Tn(l[7]||"")):(this.l=!1,this.i=new An(null,this.l))}Yt.prototype.toString=function(){const s=[];var l=this.j;l&&s.push(In(l,Ni,!0),":");var c=this.g;return(c||l=="file")&&(s.push("//"),(l=this.o)&&s.push(In(l,Ni,!0),"@"),s.push(yn(c).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.u,c!=null&&s.push(":",String(c))),(c=this.h)&&(this.g&&c.charAt(0)!="/"&&s.push("/"),s.push(In(c,c.charAt(0)=="/"?Zl:Jl,!0))),(c=this.i.toString())&&s.push("?",c),(c=this.m)&&s.push("#",In(c,ec)),s.join("")},Yt.prototype.resolve=function(s){const l=Lt(this);let c=!!s.j;c?En(l,s.j):c=!!s.o,c?l.o=s.o:c=!!s.g,c?l.g=s.g:c=s.u!=null;var h=s.h;if(c)vn(l,s.u);else if(c=!!s.h){if(h.charAt(0)!="/")if(this.g&&!this.h)h="/"+h;else{var A=l.h.lastIndexOf("/");A!=-1&&(h=l.h.slice(0,A+1)+h)}if(A=h,A==".."||A==".")h="";else if(A.indexOf("./")!=-1||A.indexOf("/.")!=-1){h=A.lastIndexOf("/",0)==0,A=A.split("/");const S=[];for(let D=0;D<A.length;){const G=A[D++];G=="."?h&&D==A.length&&S.push(""):G==".."?((S.length>1||S.length==1&&S[0]!="")&&S.pop(),h&&D==A.length&&S.push("")):(S.push(G),h=!0)}h=S.join("/")}else h=A}return c?l.h=h:c=s.i.toString()!=="",c?ss(l,xi(s.i)):c=!!s.m,c&&(l.m=s.m),l};function Lt(s){return new Yt(s)}function En(s,l,c){s.j=c?Tn(l,!0):l,s.j&&(s.j=s.j.replace(/:$/,""))}function vn(s,l){if(l){if(l=Number(l),isNaN(l)||l<0)throw Error("Bad port number "+l);s.u=l}else s.u=null}function ss(s,l,c){l instanceof An?(s.i=l,nc(s.i,s.l)):(c||(l=In(l,tc)),s.i=new An(l,s.l))}function Z(s,l,c){s.i.set(l,c)}function sr(s){return Z(s,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),s}function Tn(s,l){return s?l?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function In(s,l,c){return typeof s=="string"?(s=encodeURI(s).replace(l,Xl),c&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function Xl(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var Ni=/[#\/\?@]/g,Jl=/[#\?:]/g,Zl=/[#\?]/g,tc=/[#\?@]/g,ec=/#/g;function An(s,l){this.h=this.g=null,this.i=s||null,this.j=!!l}function Ae(s){s.g||(s.g=new Map,s.h=0,s.i&&Yl(s.i,function(l,c){s.add(decodeURIComponent(l.replace(/\+/g," ")),c)}))}r=An.prototype,r.add=function(s,l){Ae(this),this.i=null,s=xe(this,s);let c=this.g.get(s);return c||this.g.set(s,c=[]),c.push(l),this.h+=1,this};function ki(s,l){Ae(s),l=xe(s,l),s.g.has(l)&&(s.i=null,s.h-=s.g.get(l).length,s.g.delete(l))}function Oi(s,l){return Ae(s),l=xe(s,l),s.g.has(l)}r.forEach=function(s,l){Ae(this),this.g.forEach(function(c,h){c.forEach(function(A){s.call(l,A,h,this)},this)},this)};function Li(s,l){Ae(s);let c=[];if(typeof l=="string")Oi(s,l)&&(c=c.concat(s.g.get(xe(s,l))));else for(s=Array.from(s.g.values()),l=0;l<s.length;l++)c=c.concat(s[l]);return c}r.set=function(s,l){return Ae(this),this.i=null,s=xe(this,s),Oi(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[l]),this.h+=1,this},r.get=function(s,l){return s?(s=Li(this,s),s.length>0?String(s[0]):l):l};function Mi(s,l,c){ki(s,l),c.length>0&&(s.i=null,s.g.set(xe(s,l),C(c)),s.h+=c.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const s=[],l=Array.from(this.g.keys());for(let h=0;h<l.length;h++){var c=l[h];const A=yn(c);c=Li(this,c);for(let S=0;S<c.length;S++){let D=A;c[S]!==""&&(D+="="+yn(c[S])),s.push(D)}}return this.i=s.join("&")};function xi(s){const l=new An;return l.i=s.i,s.g&&(l.g=new Map(s.g),l.h=s.h),l}function xe(s,l){return l=String(l),s.j&&(l=l.toLowerCase()),l}function nc(s,l){l&&!s.j&&(Ae(s),s.i=null,s.g.forEach(function(c,h){const A=h.toLowerCase();h!=A&&(ki(this,h),Mi(this,A,c))},s)),s.j=l}function rc(s,l){const c=new pn;if(a.Image){const h=new Image;h.onload=_(Xt,c,"TestLoadImage: loaded",!0,l,h),h.onerror=_(Xt,c,"TestLoadImage: error",!1,l,h),h.onabort=_(Xt,c,"TestLoadImage: abort",!1,l,h),h.ontimeout=_(Xt,c,"TestLoadImage: timeout",!1,l,h),a.setTimeout(function(){h.ontimeout&&h.ontimeout()},1e4),h.src=s}else l(!1)}function sc(s,l){const c=new pn,h=new AbortController,A=setTimeout(()=>{h.abort(),Xt(c,"TestPingServer: timeout",!1,l)},1e4);fetch(s,{signal:h.signal}).then(S=>{clearTimeout(A),S.ok?Xt(c,"TestPingServer: ok",!0,l):Xt(c,"TestPingServer: server error",!1,l)}).catch(()=>{clearTimeout(A),Xt(c,"TestPingServer: error",!1,l)})}function Xt(s,l,c,h,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),h(c)}catch{}}function ic(){this.g=new V}function is(s){this.i=s.Sb||null,this.h=s.ab||!1}w(is,k),is.prototype.g=function(){return new ir(this.i,this.h)};function ir(s,l){ft.call(this),this.H=s,this.o=l,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}w(ir,ft),r=ir.prototype,r.open=function(s,l){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=s,this.D=l,this.readyState=1,Sn(this)},r.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const l={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};s&&(l.body=s),(this.H||a).fetch(new Request(this.D,l)).then(this.Pa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,wn(this)),this.readyState=0},r.Pa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,Sn(this)),this.g&&(this.readyState=3,Sn(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Fi(this)}else s.text().then(this.Oa.bind(this),this.ga.bind(this))};function Fi(s){s.j.read().then(s.Ma.bind(s)).catch(s.ga.bind(s))}r.Ma=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var l=s.value?s.value:new Uint8Array(0);(l=this.B.decode(l,{stream:!s.done}))&&(this.response=this.responseText+=l)}s.done?wn(this):Sn(this),this.readyState==3&&Fi(this)}},r.Oa=function(s){this.g&&(this.response=this.responseText=s,wn(this))},r.Na=function(s){this.g&&(this.response=s,wn(this))},r.ga=function(){this.g&&wn(this)};function wn(s){s.readyState=4,s.l=null,s.j=null,s.B=null,Sn(s)}r.setRequestHeader=function(s,l){this.A.append(s,l)},r.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const s=[],l=this.h.entries();for(var c=l.next();!c.done;)c=c.value,s.push(c[0]+": "+c[1]),c=l.next();return s.join(`\r
`)};function Sn(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(ir.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function Bi(s){let l="";return Kt(s,function(c,h){l+=h,l+=":",l+=c,l+=`\r
`}),l}function os(s,l,c){t:{for(h in c){var h=!1;break t}h=!0}h||(c=Bi(c),typeof s=="string"?c!=null&&yn(c):Z(s,l,c))}function nt(s){ft.call(this),this.headers=new Map,this.L=s||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}w(nt,ft);var oc=/^https?$/i,ac=["POST","PUT"];r=nt.prototype,r.Fa=function(s){this.H=s},r.ea=function(s,l,c,h){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);l=l?l.toUpperCase():"GET",this.D=s,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():vi.g(),this.g.onreadystatechange=R(d(this.Ca,this));try{this.B=!0,this.g.open(l,String(s),!0),this.B=!1}catch(S){Ui(this,S);return}if(s=c||"",c=new Map(this.headers),h)if(Object.getPrototypeOf(h)===Object.prototype)for(var A in h)c.set(A,h[A]);else if(typeof h.keys=="function"&&typeof h.get=="function")for(const S of h.keys())c.set(S,h.get(S));else throw Error("Unknown input type for opt_headers: "+String(h));h=Array.from(c.keys()).find(S=>S.toLowerCase()=="content-type"),A=a.FormData&&s instanceof a.FormData,!(Array.prototype.indexOf.call(ac,l,void 0)>=0)||h||A||c.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[S,D]of c)this.g.setRequestHeader(S,D);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(s),this.v=!1}catch(S){Ui(this,S)}};function Ui(s,l){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=l,s.o=5,ji(s),or(s)}function ji(s){s.A||(s.A=!0,pt(s,"complete"),pt(s,"error"))}r.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=s||7,pt(this,"complete"),pt(this,"abort"),or(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),or(this,!0)),nt.Z.N.call(this)},r.Ca=function(){this.u||(this.B||this.v||this.j?qi(this):this.Xa())},r.Xa=function(){qi(this)};function qi(s){if(s.h&&typeof o<"u"){if(s.v&&Jt(s)==4)setTimeout(s.Ca.bind(s),0);else if(pt(s,"readystatechange"),Jt(s)==4){s.h=!1;try{const S=s.ca();t:switch(S){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var l=!0;break t;default:l=!1}var c;if(!(c=l)){var h;if(h=S===0){let D=String(s.D).match(Di)[1]||null;!D&&a.self&&a.self.location&&(D=a.self.location.protocol.slice(0,-1)),h=!oc.test(D?D.toLowerCase():"")}c=h}if(c)pt(s,"complete"),pt(s,"success");else{s.o=6;try{var A=Jt(s)>2?s.g.statusText:""}catch{A=""}s.l=A+" ["+s.ca()+"]",ji(s)}}finally{or(s)}}}}function or(s,l){if(s.g){s.m&&(clearTimeout(s.m),s.m=null);const c=s.g;s.g=null,l||pt(s,"ready");try{c.onreadystatechange=null}catch{}}}r.isActive=function(){return!!this.g};function Jt(s){return s.g?s.g.readyState:0}r.ca=function(){try{return Jt(this)>2?this.g.status:-1}catch{return-1}},r.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.La=function(s){if(this.g){var l=this.g.responseText;return s&&l.indexOf(s)==0&&(l=l.substring(s.length)),y(l)}};function Gi(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.F){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function lc(s){const l={};s=(s.g&&Jt(s)>=2&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let h=0;h<s.length;h++){if(p(s[h]))continue;var c=Kl(s[h]);const A=c[0];if(c=c[1],typeof c!="string")continue;c=c.trim();const S=l[A]||[];l[A]=S,S.push(c)}$n(l,function(h){return h.join(", ")})}r.ya=function(){return this.o},r.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Rn(s,l,c){return c&&c.internalChannelParams&&c.internalChannelParams[s]||l}function zi(s){this.za=0,this.i=[],this.j=new pn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Rn("failFast",!1,s),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Rn("baseRetryDelayMs",5e3,s),this.Za=Rn("retryDelaySeedMs",1e4,s),this.Ta=Rn("forwardChannelMaxRetries",2,s),this.va=Rn("forwardChannelRequestTimeoutMs",2e4,s),this.ma=s&&s.xmlHttpFactory||void 0,this.Ua=s&&s.Rb||void 0,this.Aa=s&&s.useFetchStreams||!1,this.O=void 0,this.L=s&&s.supportsCrossDomainXhr||!1,this.M="",this.h=new Ri(s&&s.concurrentRequestLimit),this.Ba=new ic,this.S=s&&s.fastHandshake||!1,this.R=s&&s.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=s&&s.Pb||!1,s&&s.ua&&this.j.ua(),s&&s.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&s&&s.detectBufferingProxy||!1,this.ia=void 0,s&&s.longPollingTimeout&&s.longPollingTimeout>0&&(this.ia=s.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}r=zi.prototype,r.ka=8,r.I=1,r.connect=function(s,l,c,h){lt(0),this.W=s,this.H=l||{},c&&h!==void 0&&(this.H.OSID=c,this.H.OAID=h),this.F=this.X,this.J=Zi(this,null,this.W),lr(this)};function as(s){if(Hi(s),s.I==3){var l=s.V++,c=Lt(s.J);if(Z(c,"SID",s.M),Z(c,"RID",l),Z(c,"TYPE","terminate"),bn(s,c),l=new $t(s,s.j,l),l.M=2,l.A=sr(Lt(c)),c=!1,a.navigator&&a.navigator.sendBeacon)try{c=a.navigator.sendBeacon(l.A.toString(),"")}catch{}!c&&a.Image&&(new Image().src=l.A,c=!0),c||(l.g=to(l.j,null),l.g.ea(l.A)),l.F=Date.now(),rr(l)}Ji(s)}function ar(s){s.g&&(cs(s),s.g.cancel(),s.g=null)}function Hi(s){ar(s),s.v&&(a.clearTimeout(s.v),s.v=null),cr(s),s.h.cancel(),s.m&&(typeof s.m=="number"&&a.clearTimeout(s.m),s.m=null)}function lr(s){if(!bi(s.h)&&!s.m){s.m=!0;var l=s.Ea;It||m(),ot||(It(),ot=!0),v.add(l,s),s.D=0}}function cc(s,l){return Ci(s.h)>=s.h.j-(s.m?1:0)?!1:s.m?(s.i=l.G.concat(s.i),!0):s.I==1||s.I==2||s.D>=(s.Sa?0:s.Ta)?!1:(s.m=mn(d(s.Ea,s,l),Xi(s,s.D)),s.D++,!0)}r.Ea=function(s){if(this.m)if(this.m=null,this.I==1){if(!s){this.V=Math.floor(Math.random()*1e5),s=this.V++;const A=new $t(this,this.j,s);let S=this.o;if(this.U&&(S?(S=ln(S),un(S,this.U)):S=this.U),this.u!==null||this.R||(A.J=S,S=null),this.S)t:{for(var l=0,c=0;c<this.i.length;c++){e:{var h=this.i[c];if("__data__"in h.map&&(h=h.map.__data__,typeof h=="string")){h=h.length;break e}h=void 0}if(h===void 0)break;if(l+=h,l>4096){l=c;break t}if(l===4096||c===this.i.length-1){l=c+1;break t}}l=1e3}else l=1e3;l=Qi(this,A,l),c=Lt(this.J),Z(c,"RID",s),Z(c,"CVER",22),this.G&&Z(c,"X-HTTP-Session-Id",this.G),bn(this,c),S&&(this.R?l="headers="+yn(Bi(S))+"&"+l:this.u&&os(c,this.u,S)),rs(this.h,A),this.Ra&&Z(c,"TYPE","init"),this.S?(Z(c,"$req",l),Z(c,"SID","null"),A.U=!0,Zr(A,c,null)):Zr(A,c,l),this.I=2}}else this.I==3&&(s?Ki(this,s):this.i.length==0||bi(this.h)||Ki(this))};function Ki(s,l){var c;l?c=l.l:c=s.V++;const h=Lt(s.J);Z(h,"SID",s.M),Z(h,"RID",c),Z(h,"AID",s.K),bn(s,h),s.u&&s.o&&os(h,s.u,s.o),c=new $t(s,s.j,c,s.D+1),s.u===null&&(c.J=s.o),l&&(s.i=l.G.concat(s.i)),l=Qi(s,c,1e3),c.H=Math.round(s.va*.5)+Math.round(s.va*.5*Math.random()),rs(s.h,c),Zr(c,h,l)}function bn(s,l){s.H&&Kt(s.H,function(c,h){Z(l,h,c)}),s.l&&Kt({},function(c,h){Z(l,h,c)})}function Qi(s,l,c){c=Math.min(s.i.length,c);const h=s.l?d(s.l.Ka,s.l,s):null;t:{var A=s.i;let G=-1;for(;;){const dt=["count="+c];G==-1?c>0?(G=A[0].g,dt.push("ofs="+G)):G=0:dt.push("ofs="+G);let J=!0;for(let yt=0;yt<c;yt++){var S=A[yt].g;const Mt=A[yt].map;if(S-=G,S<0)G=Math.max(0,A[yt].g-100),J=!1;else try{S="req"+S+"_"||"";try{var D=Mt instanceof Map?Mt:Object.entries(Mt);for(const[Se,Zt]of D){let te=Zt;u(Zt)&&(te=N(Zt)),dt.push(S+Se+"="+encodeURIComponent(te))}}catch(Se){throw dt.push(S+"type="+encodeURIComponent("_badmap")),Se}}catch{h&&h(Mt)}}if(J){D=dt.join("&");break t}}D=void 0}return s=s.i.splice(0,c),l.G=s,D}function Wi(s){if(!s.g&&!s.v){s.Y=1;var l=s.Da;It||m(),ot||(It(),ot=!0),v.add(l,s),s.A=0}}function ls(s){return s.g||s.v||s.A>=3?!1:(s.Y++,s.v=mn(d(s.Da,s),Xi(s,s.A)),s.A++,!0)}r.Da=function(){if(this.v=null,$i(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var s=4*this.T;this.j.info("BP detection timer enabled: "+s),this.B=mn(d(this.Wa,this),s)}},r.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,lt(10),ar(this),$i(this))};function cs(s){s.B!=null&&(a.clearTimeout(s.B),s.B=null)}function $i(s){s.g=new $t(s,s.j,"rpc",s.Y),s.u===null&&(s.g.J=s.o),s.g.P=0;var l=Lt(s.na);Z(l,"RID","rpc"),Z(l,"SID",s.M),Z(l,"AID",s.K),Z(l,"CI",s.F?"0":"1"),!s.F&&s.ia&&Z(l,"TO",s.ia),Z(l,"TYPE","xmlhttp"),bn(s,l),s.u&&s.o&&os(l,s.u,s.o),s.O&&(s.g.H=s.O);var c=s.g;s=s.ba,c.M=1,c.A=sr(Lt(l)),c.u=null,c.R=!0,Ai(c,s)}r.Va=function(){this.C!=null&&(this.C=null,ar(this),ls(this),lt(19))};function cr(s){s.C!=null&&(a.clearTimeout(s.C),s.C=null)}function Yi(s,l){var c=null;if(s.g==l){cr(s),cs(s),s.g=null;var h=2}else if(ns(s.h,l))c=l.G,Pi(s.h,l),h=1;else return;if(s.I!=0){if(l.o)if(h==1){c=l.u?l.u.length:0,l=Date.now()-l.F;var A=s.D;h=ve(),pt(h,new _i(h,c)),lr(s)}else Wi(s);else if(A=l.m,A==3||A==0&&l.X>0||!(h==1&&cc(s,l)||h==2&&ls(s)))switch(c&&c.length>0&&(l=s.h,l.i=l.i.concat(c)),A){case 1:we(s,5);break;case 4:we(s,10);break;case 3:we(s,6);break;default:we(s,2)}}}function Xi(s,l){let c=s.Qa+Math.floor(Math.random()*s.Za);return s.isActive()||(c*=2),c*l}function we(s,l){if(s.j.info("Error code "+l),l==2){var c=d(s.bb,s),h=s.Ua;const A=!h;h=new Yt(h||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||En(h,"https"),sr(h),A?rc(h.toString(),c):sc(h.toString(),c)}else lt(2);s.I=0,s.l&&s.l.pa(l),Ji(s),Hi(s)}r.bb=function(s){s?(this.j.info("Successfully pinged google.com"),lt(2)):(this.j.info("Failed to ping google.com"),lt(1))};function Ji(s){if(s.I=0,s.ja=[],s.l){const l=Vi(s.h);(l.length!=0||s.i.length!=0)&&(B(s.ja,l),B(s.ja,s.i),s.h.i.length=0,C(s.i),s.i.length=0),s.l.oa()}}function Zi(s,l,c){var h=c instanceof Yt?Lt(c):new Yt(c);if(h.g!="")l&&(h.g=l+"."+h.g),vn(h,h.u);else{var A=a.location;h=A.protocol,l=l?l+"."+A.hostname:A.hostname,A=+A.port;const S=new Yt(null);h&&En(S,h),l&&(S.g=l),A&&vn(S,A),c&&(S.h=c),h=S}return c=s.G,l=s.wa,c&&l&&Z(h,c,l),Z(h,"VER",s.ka),bn(s,h),h}function to(s,l,c){if(l&&!s.L)throw Error("Can't create secondary domain capable XhrIo object.");return l=s.Aa&&!s.ma?new nt(new is({ab:c})):new nt(s.ma),l.Fa(s.L),l}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function eo(){}r=eo.prototype,r.ra=function(){},r.qa=function(){},r.pa=function(){},r.oa=function(){},r.isActive=function(){return!0},r.Ka=function(){};function ur(){}ur.prototype.g=function(s,l){return new Vt(s,l)};function Vt(s,l){ft.call(this),this.g=new zi(l),this.l=s,this.h=l&&l.messageUrlParams||null,s=l&&l.messageHeaders||null,l&&l.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=l&&l.initMessageHeaders||null,l&&l.messageContentType&&(s?s["X-WebChannel-Content-Type"]=l.messageContentType:s={"X-WebChannel-Content-Type":l.messageContentType}),l&&l.sa&&(s?s["X-WebChannel-Client-Profile"]=l.sa:s={"X-WebChannel-Client-Profile":l.sa}),this.g.U=s,(s=l&&l.Qb)&&!p(s)&&(this.g.u=s),this.A=l&&l.supportsCrossDomainXhr||!1,this.v=l&&l.sendRawJson||!1,(l=l&&l.httpSessionIdParam)&&!p(l)&&(this.g.G=l,s=this.h,s!==null&&l in s&&(s=this.h,l in s&&delete s[l])),this.j=new Fe(this)}w(Vt,ft),Vt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Vt.prototype.close=function(){as(this.g)},Vt.prototype.o=function(s){var l=this.g;if(typeof s=="string"){var c={};c.__data__=s,s=c}else this.v&&(c={},c.__data__=N(s),s=c);l.i.push(new $l(l.Ya++,s)),l.I==3&&lr(l)},Vt.prototype.N=function(){this.g.l=null,delete this.j,as(this.g),delete this.g,Vt.Z.N.call(this)};function no(s){Ot.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var l=s.__sm__;if(l){t:{for(const c in l){s=c;break t}s=void 0}(this.i=s)&&(s=this.i,l=l!==null&&s in l?l[s]:void 0),this.data=l}else this.data=s}w(no,Ot);function ro(){Nt.call(this),this.status=1}w(ro,Nt);function Fe(s){this.g=s}w(Fe,eo),Fe.prototype.ra=function(){pt(this.g,"a")},Fe.prototype.qa=function(s){pt(this.g,new no(s))},Fe.prototype.pa=function(s){pt(this.g,new ro)},Fe.prototype.oa=function(){pt(this.g,"b")},ur.prototype.createWebChannel=ur.prototype.g,Vt.prototype.send=Vt.prototype.o,Vt.prototype.open=Vt.prototype.m,Vt.prototype.close=Vt.prototype.close,Da=function(){return new ur},Va=function(){return ve()},Pa=kt,bs={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},nr.NO_ERROR=0,nr.TIMEOUT=8,nr.HTTP_ERROR=6,yr=nr,Ei.COMPLETE="complete",Ca=Ei,x.EventType=bt,bt.OPEN="a",bt.CLOSE="b",bt.ERROR="c",bt.MESSAGE="d",ft.prototype.listen=ft.prototype.J,Cn=x,nt.prototype.listenOnce=nt.prototype.K,nt.prototype.getLastError=nt.prototype.Ha,nt.prototype.getLastErrorCode=nt.prototype.ya,nt.prototype.getStatus=nt.prototype.ca,nt.prototype.getResponseJson=nt.prototype.La,nt.prototype.getResponseText=nt.prototype.la,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Fa,ba=nt}).apply(typeof fr<"u"?fr:typeof self<"u"?self:typeof window<"u"?window:{});const yo="@firebase/firestore",_o="4.9.3";class wt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}wt.UNAUTHENTICATED=new wt(null),wt.GOOGLE_CREDENTIALS=new wt("google-credentials-uid"),wt.FIRST_PARTY=new wt("first-party-uid"),wt.MOCK_USER=new wt("mock-user");let en="12.7.0";const Ve=new va("@firebase/firestore");function Be(){return Ve.logLevel}function O(r,...t){if(Ve.logLevel<=K.DEBUG){const e=t.map(Ws);Ve.debug(`Firestore (${en}): ${r}`,...e)}}function Ht(r,...t){if(Ve.logLevel<=K.ERROR){const e=t.map(Ws);Ve.error(`Firestore (${en}): ${r}`,...e)}}function Qe(r,...t){if(Ve.logLevel<=K.WARN){const e=t.map(Ws);Ve.warn(`Firestore (${en}): ${r}`,...e)}}function Ws(r){if(typeof r=="string")return r;try{return(function(e){return JSON.stringify(e)})(r)}catch{return r}}function q(r,t,e){let n="Unexpected state";typeof t=="string"?n=t:e=t,Na(r,n,e)}function Na(r,t,e){let n=`FIRESTORE (${en}) INTERNAL ASSERTION FAILED: ${t} (ID: ${r.toString(16)})`;if(e!==void 0)try{n+=" CONTEXT: "+JSON.stringify(e)}catch{n+=" CONTEXT: "+e}throw Ht(n),new Error(n)}function et(r,t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,r||Na(t,i,n)}function Q(r,t){return r}const P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class M extends tn{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class oe{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class ka{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class $u{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(wt.UNAUTHENTICATED)))}shutdown(){}}class Yu{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Xu{constructor(t){this.t=t,this.currentUser=wt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){et(this.o===void 0,42304);let n=this.i;const i=f=>this.i!==n?(n=this.i,e(f)):Promise.resolve();let o=new oe;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new oe,t.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const f=o;t.enqueueRetryable((async()=>{await f.promise,await i(this.currentUser)}))},u=f=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((f=>u(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?u(f):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new oe)}}),0),a()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((n=>this.i!==t?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(et(typeof n.accessToken=="string",31837,{l:n}),new ka(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return et(t===null||typeof t=="string",2055,{h:t}),new wt(t)}}class Ju{constructor(t,e,n){this.P=t,this.T=e,this.I=n,this.type="FirstParty",this.user=wt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Zu{constructor(t,e,n){this.P=t,this.T=e,this.I=n}getToken(){return Promise.resolve(new Ju(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(wt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Eo{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class th{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Nu(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){et(this.o===void 0,3512);const n=o=>{o.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,O("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?e(o.token):Promise.resolve()};this.o=o=>{t.enqueueRetryable((()=>n(o)))};const i=o=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>i(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Eo(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(et(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new Eo(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function eh(r){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(r);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let n=0;n<r;n++)e[n]=Math.floor(256*Math.random());return e}class $s{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=eh(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<e&&(n+=t.charAt(i[o]%62))}return n}}function z(r,t){return r<t?-1:r>t?1:0}function Cs(r,t){const e=Math.min(r.length,t.length);for(let n=0;n<e;n++){const i=r.charAt(n),o=t.charAt(n);if(i!==o)return ms(i)===ms(o)?z(i,o):ms(i)?1:-1}return z(r.length,t.length)}const nh=55296,rh=57343;function ms(r){const t=r.charCodeAt(0);return t>=nh&&t<=rh}function We(r,t,e){return r.length===t.length&&r.every(((n,i)=>e(n,t[i])))}const vo="__name__";class xt{constructor(t,e,n){e===void 0?e=0:e>t.length&&q(637,{offset:e,range:t.length}),n===void 0?n=t.length-e:n>t.length-e&&q(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return xt.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof xt?t.forEach((n=>{e.push(n)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const o=xt.compareSegments(t.get(i),e.get(i));if(o!==0)return o}return z(t.length,e.length)}static compareSegments(t,e){const n=xt.isNumericId(t),i=xt.isNumericId(e);return n&&!i?-1:!n&&i?1:n&&i?xt.extractNumericId(t).compare(xt.extractNumericId(e)):Cs(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return ie.fromString(t.substring(4,t.length-2))}}class tt extends xt{construct(t,e,n){return new tt(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new M(P.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((i=>i.length>0)))}return new tt(e)}static emptyPath(){return new tt([])}}const sh=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ct extends xt{construct(t,e,n){return new Ct(t,e,n)}static isValidIdentifier(t){return sh.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ct.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===vo}static keyField(){return new Ct([vo])}static fromServerFormat(t){const e=[];let n="",i=0;const o=()=>{if(n.length===0)throw new M(P.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let a=!1;for(;i<t.length;){const u=t[i];if(u==="\\"){if(i+1===t.length)throw new M(P.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const f=t[i+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new M(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=f,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(n+=u,i++):(o(),i++)}if(o(),a)throw new M(P.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ct(e)}static emptyPath(){return new Ct([])}}class F{constructor(t){this.path=t}static fromPath(t){return new F(tt.fromString(t))}static fromName(t){return new F(tt.fromString(t).popFirst(5))}static empty(){return new F(tt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&tt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return tt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new F(new tt(t.slice()))}}function Oa(r,t,e){if(!e)throw new M(P.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${t}.`)}function ih(r,t,e,n){if(t===!0&&n===!0)throw new M(P.INVALID_ARGUMENT,`${r} and ${e} cannot be used together.`)}function To(r){if(!F.isDocumentKey(r))throw new M(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function Io(r){if(F.isDocumentKey(r))throw new M(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function oh(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function ah(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const t=(function(n){return n.constructor?n.constructor.name:null})(r);return t?`a custom ${t} object`:"an object"}}return typeof r=="function"?"a function":q(12329,{type:typeof r})}function Bn(r,t){if("_delegate"in r&&(r=r._delegate),!(r instanceof t)){if(t.name===r.constructor.name)throw new M(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=ah(r);throw new M(P.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return r}function ht(r,t){const e={typeString:r};return t&&(e.value=t),e}function zn(r,t){if(!oh(r))throw new M(P.INVALID_ARGUMENT,"JSON must be an object");let e;for(const n in t)if(t[n]){const i=t[n].typeString,o="value"in t[n]?{value:t[n].value}:void 0;if(!(n in r)){e=`JSON missing required field: '${n}'`;break}const a=r[n];if(i&&typeof a!==i){e=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&a!==o.value){e=`Expected '${n}' field to equal '${o.value}'`;break}}if(e)throw new M(P.INVALID_ARGUMENT,e);return!0}const Ao=-62135596800,wo=1e6;class ut{static now(){return ut.fromMillis(Date.now())}static fromDate(t){return ut.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*wo);return new ut(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new M(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new M(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<Ao)throw new M(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new M(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/wo}_compareTo(t){return this.seconds===t.seconds?z(this.nanoseconds,t.nanoseconds):z(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ut._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(zn(t,ut._jsonSchema))return new ut(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-Ao;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ut._jsonSchemaVersion="firestore/timestamp/1.0",ut._jsonSchema={type:ht("string",ut._jsonSchemaVersion),seconds:ht("number"),nanoseconds:ht("number")};class j{static fromTimestamp(t){return new j(t)}static min(){return new j(new ut(0,0))}static max(){return new j(new ut(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Un=-1;function lh(r,t){const e=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=j.fromTimestamp(n===1e9?new ut(e+1,0):new ut(e,n));return new ue(i,F.empty(),t)}function ch(r){return new ue(r.readTime,r.key,Un)}class ue{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new ue(j.min(),F.empty(),Un)}static max(){return new ue(j.max(),F.empty(),Un)}}function uh(r,t){let e=r.readTime.compareTo(t.readTime);return e!==0?e:(e=F.comparator(r.documentKey,t.documentKey),e!==0?e:z(r.largestBatchId,t.largestBatchId))}const hh="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class fh{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Or(r){if(r.code!==P.FAILED_PRECONDITION||r.message!==hh)throw r;O("LocalStore","Unexpectedly lost primary lease")}class b{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&q(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new b(((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(t,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(e,o).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof b?e:b.resolve(e)}catch(e){return b.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):b.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):b.reject(e)}static resolve(t){return new b(((e,n)=>{e(t)}))}static reject(t){return new b(((e,n)=>{n(t)}))}static waitFor(t){return new b(((e,n)=>{let i=0,o=0,a=!1;t.forEach((u=>{++i,u.next((()=>{++o,a&&o===i&&e()}),(f=>n(f)))})),a=!0,o===i&&e()}))}static or(t){let e=b.resolve(!1);for(const n of t)e=e.next((i=>i?b.resolve(i):n()));return e}static forEach(t,e){const n=[];return t.forEach(((i,o)=>{n.push(e.call(this,i,o))})),this.waitFor(n)}static mapArray(t,e){return new b(((n,i)=>{const o=t.length,a=new Array(o);let u=0;for(let f=0;f<o;f++){const d=f;e(t[d]).next((_=>{a[d]=_,++u,u===o&&n(a)}),(_=>i(_)))}}))}static doWhile(t,e){return new b(((n,i)=>{const o=()=>{t()===!0?e().next((()=>{o()}),i):n()};o()}))}}function dh(r){const t=r.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function nn(r){return r.name==="IndexedDbTransactionError"}class Lr{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>e.writeSequenceNumber(n))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Lr.ce=-1;const gh=-1;function Mr(r){return r==null}function Ps(r){return r===0&&1/r==-1/0}const La="";function mh(r){let t="";for(let e=0;e<r.length;e++)t.length>0&&(t=So(t)),t=ph(r.get(e),t);return So(t)}function ph(r,t){let e=t;const n=r.length;for(let i=0;i<n;i++){const o=r.charAt(i);switch(o){case"\0":e+="";break;case La:e+="";break;default:e+=o}}return e}function So(r){return r+La+""}function Ro(r){let t=0;for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&t++;return t}function Hn(r,t){for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&t(e,r[e])}function yh(r){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t))return!1;return!0}class it{constructor(t,e){this.comparator=t,this.root=e||vt.EMPTY}insert(t,e){return new it(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,vt.BLACK,null,null))}remove(t){return new it(this.comparator,this.root.remove(t,this.comparator).copy(null,null,vt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(n===0)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new dr(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new dr(this.root,t,this.comparator,!1)}getReverseIterator(){return new dr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new dr(this.root,t,this.comparator,!0)}}class dr{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!t.isEmpty();)if(o=e?n(t.key,e):1,e&&i&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(o===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class vt{constructor(t,e,n,i,o){this.key=t,this.value=e,this.color=n??vt.RED,this.left=i??vt.EMPTY,this.right=o??vt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,o){return new vt(t??this.key,e??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const o=n(t,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(t,e,n),null):o===0?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return vt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),e(t,i.key)===0){if(i.right.isEmpty())return vt.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw q(43730,{key:this.key,value:this.value});if(this.right.isRed())throw q(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw q(27949);return t+(this.isRed()?0:1)}}vt.EMPTY=null,vt.RED=!0,vt.BLACK=!1;vt.EMPTY=new class{constructor(){this.size=0}get key(){throw q(57766)}get value(){throw q(16141)}get color(){throw q(16727)}get left(){throw q(29726)}get right(){throw q(36894)}copy(t,e,n,i,o){return this}insert(t,e,n){return new vt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class mt{constructor(t){this.comparator=t,this.data=new it(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new bo(this.data.getIterator())}getIteratorFrom(t){return new bo(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((n=>{e=e.add(n)})),e}isEqual(t){if(!(t instanceof mt)||this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const i=e.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new mt(this.comparator);return e.data=t,e}}class bo{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ee{constructor(t){this.fields=t,t.sort(Ct.comparator)}static empty(){return new ee([])}unionWith(t){let e=new mt(Ct.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new ee(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return We(this.fields,t.fields,((e,n)=>e.isEqual(n)))}}class Ma extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Tt{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Ma("Invalid base64 string: "+o):o}})(t);return new Tt(e)}static fromUint8Array(t){const e=(function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o})(t);return new Tt(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return z(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Tt.EMPTY_BYTE_STRING=new Tt("");const _h=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function he(r){if(et(!!r,39018),typeof r=="string"){let t=0;const e=_h.exec(r);if(et(!!e,46558,{timestamp:r}),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:st(r.seconds),nanos:st(r.nanos)}}function st(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function fe(r){return typeof r=="string"?Tt.fromBase64String(r):Tt.fromUint8Array(r)}const xa="server_timestamp",Fa="__type__",Ba="__previous_value__",Ua="__local_write_time__";function Ys(r){return(r?.mapValue?.fields||{})[Fa]?.stringValue===xa}function xr(r){const t=r.mapValue.fields[Ba];return Ys(t)?xr(t):t}function jn(r){const t=he(r.mapValue.fields[Ua].timestampValue);return new ut(t.seconds,t.nanos)}class Eh{constructor(t,e,n,i,o,a,u,f,d,_){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=f,this.useFetchStreams=d,this.isUsingEmulator=_}}const br="(default)";class qn{constructor(t,e){this.projectId=t,this.database=e||br}static empty(){return new qn("","")}get isDefaultDatabase(){return this.database===br}isEqual(t){return t instanceof qn&&t.projectId===this.projectId&&t.database===this.database}}const vh="__type__",Th="__max__",gr={mapValue:{}},Ih="__vector__",Vs="value";function de(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Ys(r)?4:wh(r)?9007199254740991:Ah(r)?10:11:q(28295,{value:r})}function jt(r,t){if(r===t)return!0;const e=de(r);if(e!==de(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===t.booleanValue;case 4:return jn(r).isEqual(jn(t));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const a=he(i.timestampValue),u=he(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos})(r,t);case 5:return r.stringValue===t.stringValue;case 6:return(function(i,o){return fe(i.bytesValue).isEqual(fe(o.bytesValue))})(r,t);case 7:return r.referenceValue===t.referenceValue;case 8:return(function(i,o){return st(i.geoPointValue.latitude)===st(o.geoPointValue.latitude)&&st(i.geoPointValue.longitude)===st(o.geoPointValue.longitude)})(r,t);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return st(i.integerValue)===st(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const a=st(i.doubleValue),u=st(o.doubleValue);return a===u?Ps(a)===Ps(u):isNaN(a)&&isNaN(u)}return!1})(r,t);case 9:return We(r.arrayValue.values||[],t.arrayValue.values||[],jt);case 10:case 11:return(function(i,o){const a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(Ro(a)!==Ro(u))return!1;for(const f in a)if(a.hasOwnProperty(f)&&(u[f]===void 0||!jt(a[f],u[f])))return!1;return!0})(r,t);default:return q(52216,{left:r})}}function Gn(r,t){return(r.values||[]).find((e=>jt(e,t)))!==void 0}function $e(r,t){if(r===t)return 0;const e=de(r),n=de(t);if(e!==n)return z(e,n);switch(e){case 0:case 9007199254740991:return 0;case 1:return z(r.booleanValue,t.booleanValue);case 2:return(function(o,a){const u=st(o.integerValue||o.doubleValue),f=st(a.integerValue||a.doubleValue);return u<f?-1:u>f?1:u===f?0:isNaN(u)?isNaN(f)?0:-1:1})(r,t);case 3:return Co(r.timestampValue,t.timestampValue);case 4:return Co(jn(r),jn(t));case 5:return Cs(r.stringValue,t.stringValue);case 6:return(function(o,a){const u=fe(o),f=fe(a);return u.compareTo(f)})(r.bytesValue,t.bytesValue);case 7:return(function(o,a){const u=o.split("/"),f=a.split("/");for(let d=0;d<u.length&&d<f.length;d++){const _=z(u[d],f[d]);if(_!==0)return _}return z(u.length,f.length)})(r.referenceValue,t.referenceValue);case 8:return(function(o,a){const u=z(st(o.latitude),st(a.latitude));return u!==0?u:z(st(o.longitude),st(a.longitude))})(r.geoPointValue,t.geoPointValue);case 9:return Po(r.arrayValue,t.arrayValue);case 10:return(function(o,a){const u=o.fields||{},f=a.fields||{},d=u[Vs]?.arrayValue,_=f[Vs]?.arrayValue,w=z(d?.values?.length||0,_?.values?.length||0);return w!==0?w:Po(d,_)})(r.mapValue,t.mapValue);case 11:return(function(o,a){if(o===gr.mapValue&&a===gr.mapValue)return 0;if(o===gr.mapValue)return 1;if(a===gr.mapValue)return-1;const u=o.fields||{},f=Object.keys(u),d=a.fields||{},_=Object.keys(d);f.sort(),_.sort();for(let w=0;w<f.length&&w<_.length;++w){const R=Cs(f[w],_[w]);if(R!==0)return R;const C=$e(u[f[w]],d[_[w]]);if(C!==0)return C}return z(f.length,_.length)})(r.mapValue,t.mapValue);default:throw q(23264,{he:e})}}function Co(r,t){if(typeof r=="string"&&typeof t=="string"&&r.length===t.length)return z(r,t);const e=he(r),n=he(t),i=z(e.seconds,n.seconds);return i!==0?i:z(e.nanos,n.nanos)}function Po(r,t){const e=r.values||[],n=t.values||[];for(let i=0;i<e.length&&i<n.length;++i){const o=$e(e[i],n[i]);if(o)return o}return z(e.length,n.length)}function Ye(r){return Ds(r)}function Ds(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?(function(e){const n=he(e);return`time(${n.seconds},${n.nanos})`})(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?(function(e){return fe(e).toBase64()})(r.bytesValue):"referenceValue"in r?(function(e){return F.fromName(e).toString()})(r.referenceValue):"geoPointValue"in r?(function(e){return`geo(${e.latitude},${e.longitude})`})(r.geoPointValue):"arrayValue"in r?(function(e){let n="[",i=!0;for(const o of e.values||[])i?i=!1:n+=",",n+=Ds(o);return n+"]"})(r.arrayValue):"mapValue"in r?(function(e){const n=Object.keys(e.fields||{}).sort();let i="{",o=!0;for(const a of n)o?o=!1:i+=",",i+=`${a}:${Ds(e.fields[a])}`;return i+"}"})(r.mapValue):q(61005,{value:r})}function _r(r){switch(de(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=xr(r);return t?16+_r(t):16;case 5:return 2*r.stringValue.length;case 6:return fe(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((i,o)=>i+_r(o)),0)})(r.arrayValue);case 10:case 11:return(function(n){let i=0;return Hn(n.fields,((o,a)=>{i+=o.length+_r(a)})),i})(r.mapValue);default:throw q(13486,{value:r})}}function Ns(r){return!!r&&"integerValue"in r}function Xs(r){return!!r&&"arrayValue"in r}function Vo(r){return!!r&&"nullValue"in r}function Do(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function ps(r){return!!r&&"mapValue"in r}function Ah(r){return(r?.mapValue?.fields||{})[vh]?.stringValue===Ih}function kn(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:{...r.timestampValue}};if(r.mapValue){const t={mapValue:{fields:{}}};return Hn(r.mapValue.fields,((e,n)=>t.mapValue.fields[e]=kn(n))),t}if(r.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(r.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=kn(r.arrayValue.values[e]);return t}return{...r}}function wh(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===Th}class Ft{constructor(t){this.value=t}static empty(){return new Ft({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!ps(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=kn(e)}setAll(t){let e=Ct.emptyPath(),n={},i=[];t.forEach(((a,u)=>{if(!e.isImmediateParentOf(u)){const f=this.getFieldsMap(e);this.applyChanges(f,n,i),n={},i=[],e=u.popLast()}a?n[u.lastSegment()]=kn(a):i.push(u.lastSegment())}));const o=this.getFieldsMap(e);this.applyChanges(o,n,i)}delete(t){const e=this.field(t.popLast());ps(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return jt(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];ps(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){Hn(e,((i,o)=>t[i]=o));for(const i of n)delete t[i]}clone(){return new Ft(kn(this.value))}}class St{constructor(t,e,n,i,o,a,u){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(t){return new St(t,0,j.min(),j.min(),j.min(),Ft.empty(),0)}static newFoundDocument(t,e,n,i){return new St(t,1,e,j.min(),n,i,0)}static newNoDocument(t,e){return new St(t,2,e,j.min(),j.min(),Ft.empty(),0)}static newUnknownDocument(t,e){return new St(t,3,e,j.min(),j.min(),Ft.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(j.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ft.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ft.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=j.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof St&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new St(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Cr{constructor(t,e){this.position=t,this.inclusive=e}}function No(r,t,e){let n=0;for(let i=0;i<r.position.length;i++){const o=t[i],a=r.position[i];if(o.field.isKeyField()?n=F.comparator(F.fromName(a.referenceValue),e.key):n=$e(a,e.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function ko(r,t){if(r===null)return t===null;if(t===null||r.inclusive!==t.inclusive||r.position.length!==t.position.length)return!1;for(let e=0;e<r.position.length;e++)if(!jt(r.position[e],t.position[e]))return!1;return!0}class Pr{constructor(t,e="asc"){this.field=t,this.dir=e}}function Sh(r,t){return r.dir===t.dir&&r.field.isEqual(t.field)}class ja{}class gt extends ja{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,n):new bh(t,e,n):e==="array-contains"?new Vh(t,n):e==="in"?new Dh(t,n):e==="not-in"?new Nh(t,n):e==="array-contains-any"?new kh(t,n):new gt(t,e,n)}static createKeyFieldInFilter(t,e,n){return e==="in"?new Ch(t,n):new Ph(t,n)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison($e(e,this.value)):e!==null&&de(this.value)===de(e)&&this.matchesComparison($e(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return q(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qt extends ja{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new qt(t,e)}matches(t){return qa(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function qa(r){return r.op==="and"}function Ga(r){return Rh(r)&&qa(r)}function Rh(r){for(const t of r.filters)if(t instanceof qt)return!1;return!0}function ks(r){if(r instanceof gt)return r.field.canonicalString()+r.op.toString()+Ye(r.value);if(Ga(r))return r.filters.map((t=>ks(t))).join(",");{const t=r.filters.map((e=>ks(e))).join(",");return`${r.op}(${t})`}}function za(r,t){return r instanceof gt?(function(n,i){return i instanceof gt&&n.op===i.op&&n.field.isEqual(i.field)&&jt(n.value,i.value)})(r,t):r instanceof qt?(function(n,i){return i instanceof qt&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce(((o,a,u)=>o&&za(a,i.filters[u])),!0):!1})(r,t):void q(19439)}function Ha(r){return r instanceof gt?(function(e){return`${e.field.canonicalString()} ${e.op} ${Ye(e.value)}`})(r):r instanceof qt?(function(e){return e.op.toString()+" {"+e.getFilters().map(Ha).join(" ,")+"}"})(r):"Filter"}class bh extends gt{constructor(t,e,n){super(t,e,n),this.key=F.fromName(n.referenceValue)}matches(t){const e=F.comparator(t.key,this.key);return this.matchesComparison(e)}}class Ch extends gt{constructor(t,e){super(t,"in",e),this.keys=Ka("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Ph extends gt{constructor(t,e){super(t,"not-in",e),this.keys=Ka("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Ka(r,t){return(t.arrayValue?.values||[]).map((e=>F.fromName(e.referenceValue)))}class Vh extends gt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Xs(e)&&Gn(e.arrayValue,this.value)}}class Dh extends gt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Gn(this.value.arrayValue,e)}}class Nh extends gt{constructor(t,e){super(t,"not-in",e)}matches(t){if(Gn(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Gn(this.value.arrayValue,e)}}class kh extends gt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Xs(e)||!e.arrayValue.values)&&e.arrayValue.values.some((n=>Gn(this.value.arrayValue,n)))}}class Oh{constructor(t,e=null,n=[],i=[],o=null,a=null,u=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.Te=null}}function Oo(r,t=null,e=[],n=[],i=null,o=null,a=null){return new Oh(r,t,e,n,i,o,a)}function Js(r){const t=Q(r);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((n=>ks(n))).join(","),e+="|ob:",e+=t.orderBy.map((n=>(function(o){return o.field.canonicalString()+o.dir})(n))).join(","),Mr(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((n=>Ye(n))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((n=>Ye(n))).join(",")),t.Te=e}return t.Te}function Zs(r,t){if(r.limit!==t.limit||r.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<r.orderBy.length;e++)if(!Sh(r.orderBy[e],t.orderBy[e]))return!1;if(r.filters.length!==t.filters.length)return!1;for(let e=0;e<r.filters.length;e++)if(!za(r.filters[e],t.filters[e]))return!1;return r.collectionGroup===t.collectionGroup&&!!r.path.isEqual(t.path)&&!!ko(r.startAt,t.startAt)&&ko(r.endAt,t.endAt)}function Os(r){return F.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}class Fr{constructor(t,e=null,n=[],i=[],o=null,a="F",u=null,f=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Lh(r,t,e,n,i,o,a,u){return new Fr(r,t,e,n,i,o,a,u)}function ti(r){return new Fr(r)}function Lo(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function Mh(r){return r.collectionGroup!==null}function On(r){const t=Q(r);if(t.Ie===null){t.Ie=[];const e=new Set;for(const o of t.explicitOrderBy)t.Ie.push(o),e.add(o.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new mt(Ct.comparator);return a.filters.forEach((f=>{f.getFlattenedFilters().forEach((d=>{d.isInequality()&&(u=u.add(d.field))}))})),u})(t).forEach((o=>{e.has(o.canonicalString())||o.isKeyField()||t.Ie.push(new Pr(o,n))})),e.has(Ct.keyField().canonicalString())||t.Ie.push(new Pr(Ct.keyField(),n))}return t.Ie}function Ut(r){const t=Q(r);return t.Ee||(t.Ee=xh(t,On(r))),t.Ee}function xh(r,t){if(r.limitType==="F")return Oo(r.path,r.collectionGroup,t,r.filters,r.limit,r.startAt,r.endAt);{t=t.map((i=>{const o=i.dir==="desc"?"asc":"desc";return new Pr(i.field,o)}));const e=r.endAt?new Cr(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Cr(r.startAt.position,r.startAt.inclusive):null;return Oo(r.path,r.collectionGroup,t,r.filters,r.limit,e,n)}}function Ls(r,t,e){return new Fr(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),t,e,r.startAt,r.endAt)}function Br(r,t){return Zs(Ut(r),Ut(t))&&r.limitType===t.limitType}function Qa(r){return`${Js(Ut(r))}|lt:${r.limitType}`}function Ue(r){return`Query(target=${(function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map((i=>Ha(i))).join(", ")}]`),Mr(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>Ye(i))).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>Ye(i))).join(",")),`Target(${n})`})(Ut(r))}; limitType=${r.limitType})`}function Ur(r,t){return t.isFoundDocument()&&(function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):F.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)})(r,t)&&(function(n,i){for(const o of On(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(r,t)&&(function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0})(r,t)&&(function(n,i){return!(n.startAt&&!(function(a,u,f){const d=No(a,u,f);return a.inclusive?d<=0:d<0})(n.startAt,On(n),i)||n.endAt&&!(function(a,u,f){const d=No(a,u,f);return a.inclusive?d>=0:d>0})(n.endAt,On(n),i))})(r,t)}function Fh(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function Wa(r){return(t,e)=>{let n=!1;for(const i of On(r)){const o=Bh(i,t,e);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function Bh(r,t,e){const n=r.field.isKeyField()?F.comparator(t.key,e.key):(function(o,a,u){const f=a.data.field(o),d=u.data.field(o);return f!==null&&d!==null?$e(f,d):q(42886)})(r.field,t,e);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return q(19790,{direction:r.dir})}}class De{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,t))return o}}has(t){return this.get(t)!==void 0}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return this.inner[n]=[[t,e]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],t))return void(i[o]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return n.length===1?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Hn(this.inner,((e,n)=>{for(const[i,o]of n)t(i,o)}))}isEmpty(){return yh(this.inner)}size(){return this.innerSize}}const Uh=new it(F.comparator);function ge(){return Uh}const $a=new it(F.comparator);function Pn(...r){let t=$a;for(const e of r)t=t.insert(e.key,e);return t}function jh(r){let t=$a;return r.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function be(){return Ln()}function Ya(){return Ln()}function Ln(){return new De((r=>r.toString()),((r,t)=>r.isEqual(t)))}const qh=new mt(F.comparator);function W(...r){let t=qh;for(const e of r)t=t.add(e);return t}const Gh=new mt(z);function zh(){return Gh}function Hh(r,t){if(r.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ps(t)?"-0":t}}function Kh(r){return{integerValue:""+r}}class jr{constructor(){this._=void 0}}function Qh(r,t,e){return r instanceof Ms?(function(i,o){const a={fields:{[Fa]:{stringValue:xa},[Ua]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Ys(o)&&(o=xr(o)),o&&(a.fields[Ba]=o),{mapValue:a}})(e,t):r instanceof Vr?Xa(r,t):r instanceof Dr?Ja(r,t):(function(i,o){const a=$h(i,o),u=Mo(a)+Mo(i.Ae);return Ns(a)&&Ns(i.Ae)?Kh(u):Hh(i.serializer,u)})(r,t)}function Wh(r,t,e){return r instanceof Vr?Xa(r,t):r instanceof Dr?Ja(r,t):e}function $h(r,t){return r instanceof xs?(function(n){return Ns(n)||(function(o){return!!o&&"doubleValue"in o})(n)})(t)?t:{integerValue:0}:null}class Ms extends jr{}class Vr extends jr{constructor(t){super(),this.elements=t}}function Xa(r,t){const e=Za(t);for(const n of r.elements)e.some((i=>jt(i,n)))||e.push(n);return{arrayValue:{values:e}}}class Dr extends jr{constructor(t){super(),this.elements=t}}function Ja(r,t){let e=Za(t);for(const n of r.elements)e=e.filter((i=>!jt(i,n)));return{arrayValue:{values:e}}}class xs extends jr{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function Mo(r){return st(r.integerValue||r.doubleValue)}function Za(r){return Xs(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function Yh(r,t){return r.field.isEqual(t.field)&&(function(n,i){return n instanceof Vr&&i instanceof Vr||n instanceof Dr&&i instanceof Dr?We(n.elements,i.elements,jt):n instanceof xs&&i instanceof xs?jt(n.Ae,i.Ae):n instanceof Ms&&i instanceof Ms})(r.transform,t.transform)}class Ce{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Ce}static exists(t){return new Ce(void 0,t)}static updateTime(t){return new Ce(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Er(r,t){return r.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(r.updateTime):r.exists===void 0||r.exists===t.isFoundDocument()}class ei{}function tl(r,t){if(!r.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return r.isNoDocument()?new Jh(r.key,Ce.none()):new ni(r.key,r.data,Ce.none());{const e=r.data,n=Ft.empty();let i=new mt(Ct.comparator);for(let o of t.fields)if(!i.has(o)){let a=e.field(o);a===null&&o.length>1&&(o=o.popLast(),a=e.field(o)),a===null?n.delete(o):n.set(o,a),i=i.add(o)}return new qr(r.key,n,new ee(i.toArray()),Ce.none())}}function Xh(r,t,e){r instanceof ni?(function(i,o,a){const u=i.value.clone(),f=Fo(i.fieldTransforms,o,a.transformResults);u.setAll(f),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()})(r,t,e):r instanceof qr?(function(i,o,a){if(!Er(i.precondition,o))return void o.convertToUnknownDocument(a.version);const u=Fo(i.fieldTransforms,o,a.transformResults),f=o.data;f.setAll(el(i)),f.setAll(u),o.convertToFoundDocument(a.version,f).setHasCommittedMutations()})(r,t,e):(function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()})(0,t,e)}function Mn(r,t,e,n){return r instanceof ni?(function(o,a,u,f){if(!Er(o.precondition,a))return u;const d=o.value.clone(),_=Bo(o.fieldTransforms,f,a);return d.setAll(_),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null})(r,t,e,n):r instanceof qr?(function(o,a,u,f){if(!Er(o.precondition,a))return u;const d=Bo(o.fieldTransforms,f,a),_=a.data;return _.setAll(el(o)),_.setAll(d),a.convertToFoundDocument(a.version,_).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((w=>w.field)))})(r,t,e,n):(function(o,a,u){return Er(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u})(r,t,e)}function xo(r,t){return r.type===t.type&&!!r.key.isEqual(t.key)&&!!r.precondition.isEqual(t.precondition)&&!!(function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&We(n,i,((o,a)=>Yh(o,a)))})(r.fieldTransforms,t.fieldTransforms)&&(r.type===0?r.value.isEqual(t.value):r.type!==1||r.data.isEqual(t.data)&&r.fieldMask.isEqual(t.fieldMask))}class ni extends ei{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class qr extends ei{constructor(t,e,n,i,o=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function el(r){const t=new Map;return r.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const n=r.data.field(e);t.set(e,n)}})),t}function Fo(r,t,e){const n=new Map;et(r.length===e.length,32656,{Re:e.length,Ve:r.length});for(let i=0;i<e.length;i++){const o=r[i],a=o.transform,u=t.data.field(o.field);n.set(o.field,Wh(a,u,e[i]))}return n}function Bo(r,t,e){const n=new Map;for(const i of r){const o=i.transform,a=e.data.field(i.field);n.set(i.field,Qh(o,a,t))}return n}class Jh extends ei{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Zh{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(t.key)&&Xh(o,t,n[i])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=Mn(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=Mn(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=Ya();return this.mutations.forEach((i=>{const o=t.get(i.key),a=o.overlayedDocument;let u=this.applyToLocalView(a,o.mutatedFields);u=e.has(i.key)?null:u;const f=tl(a,u);f!==null&&n.set(i.key,f),a.isValidDocument()||a.convertToNoDocument(j.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),W())}isEqual(t){return this.batchId===t.batchId&&We(this.mutations,t.mutations,((e,n)=>xo(e,n)))&&We(this.baseMutations,t.baseMutations,((e,n)=>xo(e,n)))}}class tf{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class ef{constructor(t,e){this.count=t,this.unchangedNames=e}}var ct,H;function nl(r){if(r===void 0)return Ht("GRPC error has no .code"),P.UNKNOWN;switch(r){case ct.OK:return P.OK;case ct.CANCELLED:return P.CANCELLED;case ct.UNKNOWN:return P.UNKNOWN;case ct.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case ct.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case ct.INTERNAL:return P.INTERNAL;case ct.UNAVAILABLE:return P.UNAVAILABLE;case ct.UNAUTHENTICATED:return P.UNAUTHENTICATED;case ct.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case ct.NOT_FOUND:return P.NOT_FOUND;case ct.ALREADY_EXISTS:return P.ALREADY_EXISTS;case ct.PERMISSION_DENIED:return P.PERMISSION_DENIED;case ct.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case ct.ABORTED:return P.ABORTED;case ct.OUT_OF_RANGE:return P.OUT_OF_RANGE;case ct.UNIMPLEMENTED:return P.UNIMPLEMENTED;case ct.DATA_LOSS:return P.DATA_LOSS;default:return q(39323,{code:r})}}(H=ct||(ct={}))[H.OK=0]="OK",H[H.CANCELLED=1]="CANCELLED",H[H.UNKNOWN=2]="UNKNOWN",H[H.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",H[H.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",H[H.NOT_FOUND=5]="NOT_FOUND",H[H.ALREADY_EXISTS=6]="ALREADY_EXISTS",H[H.PERMISSION_DENIED=7]="PERMISSION_DENIED",H[H.UNAUTHENTICATED=16]="UNAUTHENTICATED",H[H.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",H[H.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",H[H.ABORTED=10]="ABORTED",H[H.OUT_OF_RANGE=11]="OUT_OF_RANGE",H[H.UNIMPLEMENTED=12]="UNIMPLEMENTED",H[H.INTERNAL=13]="INTERNAL",H[H.UNAVAILABLE=14]="UNAVAILABLE",H[H.DATA_LOSS=15]="DATA_LOSS";function nf(){return new TextEncoder}const rf=new ie([4294967295,4294967295],0);function Uo(r){const t=nf().encode(r),e=new Ra;return e.update(t),new Uint8Array(e.digest())}function jo(r){const t=new DataView(r.buffer),e=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new ie([e,n],0),new ie([i,o],0)]}class ri{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new Vn(`Invalid padding: ${e}`);if(n<0)throw new Vn(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new Vn(`Invalid hash count: ${n}`);if(t.length===0&&e!==0)throw new Vn(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=ie.fromNumber(this.ge)}ye(t,e,n){let i=t.add(e.multiply(ie.fromNumber(n)));return i.compare(rf)===1&&(i=new ie([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=Uo(t),[n,i]=jo(e);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);if(!this.we(a))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,o=new Uint8Array(Math.ceil(t/8)),a=new ri(o,i,e);return n.forEach((u=>a.insert(u))),a}insert(t){if(this.ge===0)return;const e=Uo(t),[n,i]=jo(e);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);this.Se(a)}}Se(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class Vn extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Gr{constructor(t,e,n,i,o){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,Kn.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new Gr(j.min(),i,new it(z),ge(),W())}}class Kn{constructor(t,e,n,i,o){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new Kn(n,e,W(),W(),W())}}class vr{constructor(t,e,n,i){this.be=t,this.removedTargetIds=e,this.key=n,this.De=i}}class rl{constructor(t,e){this.targetId=t,this.Ce=e}}class sl{constructor(t,e,n=Tt.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class qo{constructor(){this.ve=0,this.Fe=Go(),this.Me=Tt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=W(),e=W(),n=W();return this.Fe.forEach(((i,o)=>{switch(o){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:q(38017,{changeType:o})}})),new Kn(this.Me,this.xe,t,e,n)}qe(){this.Oe=!1,this.Fe=Go()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,et(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class sf{constructor(t){this.Ge=t,this.ze=new Map,this.je=ge(),this.Je=mr(),this.He=mr(),this.Ye=new it(z)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const n=this.nt(e);switch(t.state){case 0:this.rt(e)&&n.Le(t.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(t.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(n.We(),n.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),n.Le(t.resumeToken));break;default:q(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((n,i)=>{this.rt(i)&&e(i)}))}st(t){const e=t.targetId,n=t.Ce.count,i=this.ot(e);if(i){const o=i.target;if(Os(o))if(n===0){const a=new F(o.path);this.et(e,a,St.newNoDocument(a,j.min()))}else et(n===1,20013,{expectedCount:n});else{const a=this._t(e);if(a!==n){const u=this.ut(t),f=u?this.ct(u,t,a):1;if(f!==0){this.it(e);const d=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,d)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=e;let a,u;try{a=fe(n).toUint8Array()}catch(f){if(f instanceof Ma)return Qe("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{u=new ri(a,i,o)}catch(f){return Qe(f instanceof Vn?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return u.ge===0?null:u}ct(t,e,n){return e.Ce.count===n-this.Pt(t,e.targetId)?0:2}Pt(t,e){const n=this.Ge.getRemoteKeysForTarget(e);let i=0;return n.forEach((o=>{const a=this.Ge.ht(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;t.mightContain(u)||(this.et(e,o,null),i++)})),i}Tt(t){const e=new Map;this.ze.forEach(((o,a)=>{const u=this.ot(a);if(u){if(o.current&&Os(u.target)){const f=new F(u.target.path);this.It(f).has(a)||this.Et(a,f)||this.et(a,f,St.newNoDocument(f,t))}o.Be&&(e.set(a,o.ke()),o.qe())}}));let n=W();this.He.forEach(((o,a)=>{let u=!0;a.forEachWhile((f=>{const d=this.ot(f);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(o))})),this.je.forEach(((o,a)=>a.setReadTime(t)));const i=new Gr(t,e,this.Ye,this.je,n);return this.je=ge(),this.Je=mr(),this.He=mr(),this.Ye=new it(z),i}Xe(t,e){if(!this.rt(t))return;const n=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,n),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,n){if(!this.rt(t))return;const i=this.nt(t);this.Et(t,e)?i.Qe(e,1):i.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),n&&(this.je=this.je.insert(e,n))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new qo,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new mt(z),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new mt(z),this.Je=this.Je.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||O("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new qo),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function mr(){return new it(F.comparator)}function Go(){return new it(F.comparator)}const of={asc:"ASCENDING",desc:"DESCENDING"},af={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lf={and:"AND",or:"OR"};class cf{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Fs(r,t){return r.useProto3Json||Mr(t)?t:{value:t}}function uf(r,t){return r.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function hf(r,t){return r.useProto3Json?t.toBase64():t.toUint8Array()}function ze(r){return et(!!r,49232),j.fromTimestamp((function(e){const n=he(e);return new ut(n.seconds,n.nanos)})(r))}function ff(r,t){return Bs(r,t).canonicalString()}function Bs(r,t){const e=(function(i){return new tt(["projects",i.projectId,"databases",i.database])})(r).child("documents");return t===void 0?e:e.child(t)}function il(r){const t=tt.fromString(r);return et(ul(t),10190,{key:t.toString()}),t}function ys(r,t){const e=il(t);if(e.get(1)!==r.databaseId.projectId)throw new M(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+r.databaseId.projectId);if(e.get(3)!==r.databaseId.database)throw new M(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+r.databaseId.database);return new F(al(e))}function ol(r,t){return ff(r.databaseId,t)}function df(r){const t=il(r);return t.length===4?tt.emptyPath():al(t)}function zo(r){return new tt(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function al(r){return et(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function gf(r,t){let e;if("targetChange"in t){t.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:q(39313,{state:d})})(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=(function(d,_){return d.useProto3Json?(et(_===void 0||typeof _=="string",58123),Tt.fromBase64String(_||"")):(et(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),Tt.fromUint8Array(_||new Uint8Array))})(r,t.targetChange.resumeToken),a=t.targetChange.cause,u=a&&(function(d){const _=d.code===void 0?P.UNKNOWN:nl(d.code);return new M(_,d.message||"")})(a);e=new sl(n,i,o,u||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const i=ys(r,n.document.name),o=ze(n.document.updateTime),a=n.document.createTime?ze(n.document.createTime):j.min(),u=new Ft({mapValue:{fields:n.document.fields}}),f=St.newFoundDocument(i,o,a,u),d=n.targetIds||[],_=n.removedTargetIds||[];e=new vr(d,_,f.key,f)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const i=ys(r,n.document),o=n.readTime?ze(n.readTime):j.min(),a=St.newNoDocument(i,o),u=n.removedTargetIds||[];e=new vr([],u,a.key,a)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const i=ys(r,n.document),o=n.removedTargetIds||[];e=new vr([],o,i,null)}else{if(!("filter"in t))return q(11601,{Rt:t});{t.filter;const n=t.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,a=new ef(i,o),u=n.targetId;e=new rl(u,a)}}return e}function mf(r,t){return{documents:[ol(r,t.path)]}}function pf(r,t){const e={structuredQuery:{}},n=t.path;let i;t.collectionGroup!==null?(i=n,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=n.popLast(),e.structuredQuery.from=[{collectionId:n.lastSegment()}]),e.parent=ol(r,i);const o=(function(d){if(d.length!==0)return cl(qt.create(d,"and"))})(t.filters);o&&(e.structuredQuery.where=o);const a=(function(d){if(d.length!==0)return d.map((_=>(function(R){return{field:je(R.field),direction:Ef(R.dir)}})(_)))})(t.orderBy);a&&(e.structuredQuery.orderBy=a);const u=Fs(r,t.limit);return u!==null&&(e.structuredQuery.limit=u),t.startAt&&(e.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(t.endAt)),{ft:e,parent:i}}function yf(r){let t=df(r.parent);const e=r.structuredQuery,n=e.from?e.from.length:0;let i=null;if(n>0){et(n===1,65062);const _=e.from[0];_.allDescendants?i=_.collectionId:t=t.child(_.collectionId)}let o=[];e.where&&(o=(function(w){const R=ll(w);return R instanceof qt&&Ga(R)?R.getFilters():[R]})(e.where));let a=[];e.orderBy&&(a=(function(w){return w.map((R=>(function(B){return new Pr(qe(B.field),(function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(B.direction))})(R)))})(e.orderBy));let u=null;e.limit&&(u=(function(w){let R;return R=typeof w=="object"?w.value:w,Mr(R)?null:R})(e.limit));let f=null;e.startAt&&(f=(function(w){const R=!!w.before,C=w.values||[];return new Cr(C,R)})(e.startAt));let d=null;return e.endAt&&(d=(function(w){const R=!w.before,C=w.values||[];return new Cr(C,R)})(e.endAt)),Lh(t,i,a,o,u,"F",f,d)}function _f(r,t){const e=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return q(28987,{purpose:i})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function ll(r){return r.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=qe(e.unaryFilter.field);return gt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=qe(e.unaryFilter.field);return gt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=qe(e.unaryFilter.field);return gt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=qe(e.unaryFilter.field);return gt.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return q(61313);default:return q(60726)}})(r):r.fieldFilter!==void 0?(function(e){return gt.create(qe(e.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return q(58110);default:return q(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(r):r.compositeFilter!==void 0?(function(e){return qt.create(e.compositeFilter.filters.map((n=>ll(n))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return q(1026)}})(e.compositeFilter.op))})(r):q(30097,{filter:r})}function Ef(r){return of[r]}function vf(r){return af[r]}function Tf(r){return lf[r]}function je(r){return{fieldPath:r.canonicalString()}}function qe(r){return Ct.fromServerFormat(r.fieldPath)}function cl(r){return r instanceof gt?(function(e){if(e.op==="=="){if(Do(e.value))return{unaryFilter:{field:je(e.field),op:"IS_NAN"}};if(Vo(e.value))return{unaryFilter:{field:je(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Do(e.value))return{unaryFilter:{field:je(e.field),op:"IS_NOT_NAN"}};if(Vo(e.value))return{unaryFilter:{field:je(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:je(e.field),op:vf(e.op),value:e.value}}})(r):r instanceof qt?(function(e){const n=e.getFilters().map((i=>cl(i)));return n.length===1?n[0]:{compositeFilter:{op:Tf(e.op),filters:n}}})(r):q(54877,{filter:r})}function ul(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}class ne{constructor(t,e,n,i,o=j.min(),a=j.min(),u=Tt.EMPTY_BYTE_STRING,f=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=f}withSequenceNumber(t){return new ne(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new ne(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ne(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ne(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class If{constructor(t){this.yt=t}}function Af(r){const t=yf({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Ls(t,t.limit,"L"):t}class wf{constructor(){this.Cn=new Sf}addToCollectionParentIndex(t,e){return this.Cn.add(e),b.resolve()}getCollectionParents(t,e){return b.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return b.resolve()}deleteFieldIndex(t,e){return b.resolve()}deleteAllFieldIndexes(t){return b.resolve()}createTargetIndexes(t,e){return b.resolve()}getDocumentsMatchingTarget(t,e){return b.resolve(null)}getIndexType(t,e){return b.resolve(0)}getFieldIndexes(t,e){return b.resolve([])}getNextCollectionGroupToUpdate(t){return b.resolve(null)}getMinOffset(t,e){return b.resolve(ue.min())}getMinOffsetFromCollectionGroup(t,e){return b.resolve(ue.min())}updateCollectionGroup(t,e,n){return b.resolve()}updateIndexEntries(t,e){return b.resolve()}}class Sf{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new mt(tt.comparator),o=!i.has(n);return this.index[e]=i.add(n),o}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new mt(tt.comparator)).toArray()}}const Ho={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},hl=41943040;class Pt{static withCacheSize(t){return new Pt(t,Pt.DEFAULT_COLLECTION_PERCENTILE,Pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}Pt.DEFAULT_COLLECTION_PERCENTILE=10,Pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pt.DEFAULT=new Pt(hl,Pt.DEFAULT_COLLECTION_PERCENTILE,Pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pt.DISABLED=new Pt(-1,0,0);class Xe{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new Xe(0)}static cr(){return new Xe(-1)}}const Ko="LruGarbageCollector",Rf=1048576;function Qo([r,t],[e,n]){const i=z(r,e);return i===0?z(t,n):i}class bf{constructor(t){this.Ir=t,this.buffer=new mt(Qo),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const n=this.buffer.last();Qo(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}}get maxValue(){return this.buffer.last()[0]}}class Cf{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){O(Ko,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){nn(e)?O(Ko,"Ignoring IndexedDB error during garbage collection: ",e):await Or(e)}await this.Vr(3e5)}))}}class Pf{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next((n=>Math.floor(e/100*n)))}nthSequenceNumber(t,e){if(e===0)return b.resolve(Lr.ce);const n=new bf(e);return this.mr.forEachTarget(t,(i=>n.Ar(i.sequenceNumber))).next((()=>this.mr.pr(t,(i=>n.Ar(i))))).next((()=>n.maxValue))}removeTargets(t,e,n){return this.mr.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),b.resolve(Ho)):this.getCacheSize(t).next((n=>n<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ho):this.yr(t,e)))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let n,i,o,a,u,f,d;const _=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),i=this.params.maximumSequenceNumbersToCollect):i=w,a=Date.now(),this.nthSequenceNumber(t,i)))).next((w=>(n=w,u=Date.now(),this.removeTargets(t,n,e)))).next((w=>(o=w,f=Date.now(),this.removeOrphanedDocuments(t,n)))).next((w=>(d=Date.now(),Be()<=K.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-_}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${o} targets in `+(f-u)+`ms
	Removed ${w} documents in `+(d-f)+`ms
Total Duration: ${d-_}ms`),b.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:w}))))}}function Vf(r,t){return new Pf(r,t)}class Df{constructor(){this.changes=new De((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,St.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return n!==void 0?b.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Nf{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class kf{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((i=>(n!==null&&Mn(n.mutation,i,ee.empty(),ut.now()),i)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((n=>this.getLocalViewOfDocuments(t,n,W()).next((()=>n))))}getLocalViewOfDocuments(t,e,n=W()){const i=be();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((o=>{let a=Pn();return o.forEach(((u,f)=>{a=a.insert(u,f.overlayedDocument)})),a}))))}getOverlayedDocuments(t,e){const n=be();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,W())))}populateOverlays(t,e,n){const i=[];return n.forEach((o=>{e.has(o)||i.push(o)})),this.documentOverlayCache.getOverlays(t,i).next((o=>{o.forEach(((a,u)=>{e.set(a,u)}))}))}computeViews(t,e,n,i){let o=ge();const a=Ln(),u=(function(){return Ln()})();return e.forEach(((f,d)=>{const _=n.get(d.key);i.has(d.key)&&(_===void 0||_.mutation instanceof qr)?o=o.insert(d.key,d):_!==void 0?(a.set(d.key,_.mutation.getFieldMask()),Mn(_.mutation,d,_.mutation.getFieldMask(),ut.now())):a.set(d.key,ee.empty())})),this.recalculateAndSaveOverlays(t,o).next((f=>(f.forEach(((d,_)=>a.set(d,_))),e.forEach(((d,_)=>u.set(d,new Nf(_,a.get(d)??null)))),u)))}recalculateAndSaveOverlays(t,e){const n=Ln();let i=new it(((a,u)=>a-u)),o=W();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((a=>{for(const u of a)u.keys().forEach((f=>{const d=e.get(f);if(d===null)return;let _=n.get(f)||ee.empty();_=u.applyToLocalView(d,_),n.set(f,_);const w=(i.get(u.batchId)||W()).add(f);i=i.insert(u.batchId,w)}))})).next((()=>{const a=[],u=i.getReverseIterator();for(;u.hasNext();){const f=u.getNext(),d=f.key,_=f.value,w=Ya();_.forEach((R=>{if(!o.has(R)){const C=tl(e.get(R),n.get(R));C!==null&&w.set(R,C),o=o.add(R)}})),a.push(this.documentOverlayCache.saveOverlays(t,d,w))}return b.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((n=>this.recalculateAndSaveOverlays(t,n)))}getDocumentsMatchingQuery(t,e,n,i){return(function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):Mh(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((o=>{const a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-o.size):b.resolve(be());let u=Un,f=o;return a.next((d=>b.forEach(d,((_,w)=>(u<w.largestBatchId&&(u=w.largestBatchId),o.get(_)?b.resolve():this.remoteDocumentCache.getEntry(t,_).next((R=>{f=f.insert(_,R)}))))).next((()=>this.populateOverlays(t,d,o))).next((()=>this.computeViews(t,f,d,W()))).next((_=>({batchId:u,changes:jh(_)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new F(e)).next((n=>{let i=Pn();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const o=e.collectionGroup;let a=Pn();return this.indexManager.getCollectionParents(t,o).next((u=>b.forEach(u,(f=>{const d=(function(w,R){return new Fr(R,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(e,f.child(o));return this.getDocumentsMatchingCollectionQuery(t,d,n,i).next((_=>{_.forEach(((w,R)=>{a=a.insert(w,R)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(t,e,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,o,i)))).next((a=>{o.forEach(((f,d)=>{const _=d.getKey();a.get(_)===null&&(a=a.insert(_,St.newInvalidDocument(_)))}));let u=Pn();return a.forEach(((f,d)=>{const _=o.get(f);_!==void 0&&Mn(_.mutation,d,ee.empty(),ut.now()),Ur(e,d)&&(u=u.insert(f,d))})),u}))}}class Of{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return b.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,(function(i){return{id:i.id,version:i.version,createTime:ze(i.createTime)}})(e)),b.resolve()}getNamedQuery(t,e){return b.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,(function(i){return{name:i.name,query:Af(i.bundledQuery),readTime:ze(i.readTime)}})(e)),b.resolve()}}class Lf{constructor(){this.overlays=new it(F.comparator),this.qr=new Map}getOverlay(t,e){return b.resolve(this.overlays.get(e))}getOverlays(t,e){const n=be();return b.forEach(e,(i=>this.getOverlay(t,i).next((o=>{o!==null&&n.set(i,o)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((i,o)=>{this.St(t,e,o)})),b.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(n)),b.resolve()}getOverlaysForCollection(t,e,n){const i=be(),o=e.length+1,a=new F(e.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const f=u.getNext().value,d=f.getKey();if(!e.isPrefixOf(d.path))break;d.path.length===o&&f.largestBatchId>n&&i.set(f.getKey(),f)}return b.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let o=new it(((d,_)=>d-_));const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===e&&d.largestBatchId>n){let _=o.get(d.largestBatchId);_===null&&(_=be(),o=o.insert(d.largestBatchId,_)),_.set(d.getKey(),d)}}const u=be(),f=o.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((d,_)=>u.set(d,_))),!(u.size()>=i)););return b.resolve(u)}St(t,e,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new tf(e,n));let o=this.qr.get(e);o===void 0&&(o=W(),this.qr.set(e,o)),this.qr.set(e,o.add(n.key))}}class Mf{constructor(){this.sessionToken=Tt.EMPTY_BYTE_STRING}getSessionToken(t){return b.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,b.resolve()}}class si{constructor(){this.Qr=new mt(_t.$r),this.Ur=new mt(_t.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const n=new _t(t,e);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(t,e){t.forEach((n=>this.addReference(n,e)))}removeReference(t,e){this.Gr(new _t(t,e))}zr(t,e){t.forEach((n=>this.removeReference(n,e)))}jr(t){const e=new F(new tt([])),n=new _t(e,t),i=new _t(e,t+1),o=[];return this.Ur.forEachInRange([n,i],(a=>{this.Gr(a),o.push(a.key)})),o}Jr(){this.Qr.forEach((t=>this.Gr(t)))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new F(new tt([])),n=new _t(e,t),i=new _t(e,t+1);let o=W();return this.Ur.forEachInRange([n,i],(a=>{o=o.add(a.key)})),o}containsKey(t){const e=new _t(t,0),n=this.Qr.firstAfterOrEqual(e);return n!==null&&t.isEqual(n.key)}}class _t{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return F.comparator(t.key,e.key)||z(t.Yr,e.Yr)}static Kr(t,e){return z(t.Yr,e.Yr)||F.comparator(t.key,e.key)}}class xf{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new mt(_t.$r)}checkEmpty(t){return b.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Zh(o,e,n,i);this.mutationQueue.push(a);for(const u of i)this.Zr=this.Zr.add(new _t(u.key,o)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast());return b.resolve(a)}lookupMutationBatch(t,e){return b.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.ei(n),o=i<0?0:i;return b.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return b.resolve(this.mutationQueue.length===0?gh:this.tr-1)}getAllMutationBatches(t){return b.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new _t(e,0),i=new _t(e,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],(a=>{const u=this.Xr(a.Yr);o.push(u)})),b.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new mt(z);return e.forEach((i=>{const o=new _t(i,0),a=new _t(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],(u=>{n=n.add(u.Yr)}))})),b.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let o=n;F.isDocumentKey(o)||(o=o.child(""));const a=new _t(new F(o),0);let u=new mt(z);return this.Zr.forEachWhile((f=>{const d=f.key.path;return!!n.isPrefixOf(d)&&(d.length===i&&(u=u.add(f.Yr)),!0)}),a),b.resolve(this.ti(u))}ti(t){const e=[];return t.forEach((n=>{const i=this.Xr(n);i!==null&&e.push(i)})),e}removeMutationBatch(t,e){et(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return b.forEach(e.mutations,(i=>{const o=new _t(i.key,e.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.Zr=n}))}ir(t){}containsKey(t,e){const n=new _t(e,0),i=this.Zr.firstAfterOrEqual(n);return b.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,b.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Ff{constructor(t){this.ri=t,this.docs=(function(){return new it(F.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),o=i?i.size:0,a=this.ri(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return b.resolve(n?n.document.mutableCopy():St.newInvalidDocument(e))}getEntries(t,e){let n=ge();return e.forEach((i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():St.newInvalidDocument(i))})),b.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let o=ge();const a=e.path,u=new F(a.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(u);for(;f.hasNext();){const{key:d,value:{document:_}}=f.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||uh(ch(_),n)<=0||(i.has(_.key)||Ur(e,_))&&(o=o.insert(_.key,_.mutableCopy()))}return b.resolve(o)}getAllFromCollectionGroup(t,e,n,i){q(9500)}ii(t,e){return b.forEach(this.docs,(n=>e(n)))}newChangeBuffer(t){return new Bf(this)}getSize(t){return b.resolve(this.size)}}class Bf extends Df{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.Nr.addEntry(t,i)):this.Nr.removeEntry(n)})),b.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}class Uf{constructor(t){this.persistence=t,this.si=new De((e=>Js(e)),Zs),this.lastRemoteSnapshotVersion=j.min(),this.highestTargetId=0,this.oi=0,this._i=new si,this.targetCount=0,this.ai=Xe.ur()}forEachTarget(t,e){return this.si.forEach(((n,i)=>e(i))),b.resolve()}getLastRemoteSnapshotVersion(t){return b.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return b.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),b.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.oi&&(this.oi=e),b.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new Xe(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,b.resolve()}updateTargetData(t,e){return this.Pr(e),b.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,b.resolve()}removeTargets(t,e,n){let i=0;const o=[];return this.si.forEach(((a,u)=>{u.sequenceNumber<=e&&n.get(u.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(t,u.targetId)),i++)})),b.waitFor(o).next((()=>i))}getTargetCount(t){return b.resolve(this.targetCount)}getTargetData(t,e){const n=this.si.get(e)||null;return b.resolve(n)}addMatchingKeys(t,e,n){return this._i.Wr(e,n),b.resolve()}removeMatchingKeys(t,e,n){this._i.zr(e,n);const i=this.persistence.referenceDelegate,o=[];return i&&e.forEach((a=>{o.push(i.markPotentiallyOrphaned(t,a))})),b.waitFor(o)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),b.resolve()}getMatchingKeysForTargetId(t,e){const n=this._i.Hr(e);return b.resolve(n)}containsKey(t,e){return b.resolve(this._i.containsKey(e))}}class fl{constructor(t,e){this.ui={},this.overlays={},this.ci=new Lr(0),this.li=!1,this.li=!0,this.hi=new Mf,this.referenceDelegate=t(this),this.Pi=new Uf(this),this.indexManager=new wf,this.remoteDocumentCache=(function(i){return new Ff(i)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new If(e),this.Ii=new Of(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Lf,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.ui[t.toKey()];return n||(n=new xf(e,this.referenceDelegate),this.ui[t.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,n){O("MemoryPersistence","Starting transaction:",t);const i=new jf(this.ci.next());return this.referenceDelegate.Ei(),n(i).next((o=>this.referenceDelegate.di(i).next((()=>o)))).toPromise().then((o=>(i.raiseOnCommittedEvent(),o)))}Ai(t,e){return b.or(Object.values(this.ui).map((n=>()=>n.containsKey(t,e))))}}class jf extends fh{constructor(t){super(),this.currentSequenceNumber=t}}class ii{constructor(t){this.persistence=t,this.Ri=new si,this.Vi=null}static mi(t){return new ii(t)}get fi(){if(this.Vi)return this.Vi;throw q(60996)}addReference(t,e,n){return this.Ri.addReference(n,e),this.fi.delete(n.toString()),b.resolve()}removeReference(t,e,n){return this.Ri.removeReference(n,e),this.fi.add(n.toString()),b.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),b.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach((i=>this.fi.add(i.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((i=>{i.forEach((o=>this.fi.add(o.toString())))})).next((()=>n.removeTargetData(t,e)))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return b.forEach(this.fi,(n=>{const i=F.fromPath(n);return this.gi(t,i).next((o=>{o||e.removeEntry(i,j.min())}))})).next((()=>(this.Vi=null,e.apply(t))))}updateLimboDocument(t,e){return this.gi(t,e).next((n=>{n?this.fi.delete(e.toString()):this.fi.add(e.toString())}))}Ti(t){return 0}gi(t,e){return b.or([()=>b.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class Nr{constructor(t,e){this.persistence=t,this.pi=new De((n=>mh(n.path)),((n,i)=>n.isEqual(i))),this.garbageCollector=Vf(this,e)}static mi(t,e){return new Nr(t,e)}Ei(){}di(t){return b.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next((n=>e.next((i=>n+i))))}wr(t){let e=0;return this.pr(t,(n=>{e++})).next((()=>e))}pr(t,e){return b.forEach(this.pi,((n,i)=>this.br(t,n,i).next((o=>o?b.resolve():e(i)))))}removeTargets(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)}removeOrphanedDocuments(t,e){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(t,(a=>this.br(t,a,e).next((u=>{u||(n++,o.removeEntry(a,j.min()))})))).next((()=>o.apply(t))).next((()=>n))}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),b.resolve()}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,e,n){return this.pi.set(n,t.currentSequenceNumber),b.resolve()}removeReference(t,e,n){return this.pi.set(n,t.currentSequenceNumber),b.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),b.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=_r(t.data.value)),e}br(t,e,n){return b.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const i=this.pi.get(e);return b.resolve(i!==void 0&&i>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class oi{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Es=n,this.ds=i}static As(t,e){let n=W(),i=W();for(const o of e.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new oi(t,e.fromCache,n,i)}}class qf{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class Gf{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Pc()?8:dh(bc())>0?6:4})()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,n,i){const o={result:null};return this.ys(t,e).next((a=>{o.result=a})).next((()=>{if(!o.result)return this.ws(t,e,i,n).next((a=>{o.result=a}))})).next((()=>{if(o.result)return;const a=new qf;return this.Ss(t,e,a).next((u=>{if(o.result=u,this.Vs)return this.bs(t,e,a,u.size)}))})).next((()=>o.result))}bs(t,e,n,i){return n.documentReadCount<this.fs?(Be()<=K.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",Ue(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),b.resolve()):(Be()<=K.DEBUG&&O("QueryEngine","Query:",Ue(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(Be()<=K.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",Ue(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ut(e))):b.resolve())}ys(t,e){if(Lo(e))return b.resolve(null);let n=Ut(e);return this.indexManager.getIndexType(t,n).next((i=>i===0?null:(e.limit!==null&&i===1&&(e=Ls(e,null,"F"),n=Ut(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((o=>{const a=W(...o);return this.ps.getDocuments(t,a).next((u=>this.indexManager.getMinOffset(t,n).next((f=>{const d=this.Ds(e,u);return this.Cs(e,d,a,f.readTime)?this.ys(t,Ls(e,null,"F")):this.vs(t,d,e,f)}))))})))))}ws(t,e,n,i){return Lo(e)||i.isEqual(j.min())?b.resolve(null):this.ps.getDocuments(t,n).next((o=>{const a=this.Ds(e,o);return this.Cs(e,a,n,i)?b.resolve(null):(Be()<=K.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ue(e)),this.vs(t,a,e,lh(i,Un)).next((u=>u)))}))}Ds(t,e){let n=new mt(Wa(t));return e.forEach(((i,o)=>{Ur(t,o)&&(n=n.add(o))})),n}Cs(t,e,n,i){if(t.limit===null)return!1;if(n.size!==e.size)return!0;const o=t.limitType==="F"?e.last():e.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(t,e,n){return Be()<=K.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",Ue(e)),this.ps.getDocumentsMatchingQuery(t,e,ue.min(),n)}vs(t,e,n,i){return this.ps.getDocumentsMatchingQuery(t,n,i).next((o=>(e.forEach((a=>{o=o.insert(a.key,a)})),o)))}}const ai="LocalStore",zf=3e8;class Hf{constructor(t,e,n,i){this.persistence=t,this.Fs=e,this.serializer=i,this.Ms=new it(z),this.xs=new De((o=>Js(o)),Zs),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(n)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new kf(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ms)))}}function Kf(r,t,e,n){return new Hf(r,t,e,n)}async function dl(r,t){const e=Q(r);return await e.persistence.runTransaction("Handle user change","readonly",(n=>{let i;return e.mutationQueue.getAllMutationBatches(n).next((o=>(i=o,e.Bs(t),e.mutationQueue.getAllMutationBatches(n)))).next((o=>{const a=[],u=[];let f=W();for(const d of i){a.push(d.batchId);for(const _ of d.mutations)f=f.add(_.key)}for(const d of o){u.push(d.batchId);for(const _ of d.mutations)f=f.add(_.key)}return e.localDocuments.getDocuments(n,f).next((d=>({Ls:d,removedBatchIds:a,addedBatchIds:u})))}))}))}function gl(r){const t=Q(r);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function Qf(r,t){const e=Q(r),n=t.snapshotVersion;let i=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const a=e.Ns.newChangeBuffer({trackRemovals:!0});i=e.Ms;const u=[];t.targetChanges.forEach(((_,w)=>{const R=i.get(w);if(!R)return;u.push(e.Pi.removeMatchingKeys(o,_.removedDocuments,w).next((()=>e.Pi.addMatchingKeys(o,_.addedDocuments,w))));let C=R.withSequenceNumber(o.currentSequenceNumber);t.targetMismatches.get(w)!==null?C=C.withResumeToken(Tt.EMPTY_BYTE_STRING,j.min()).withLastLimboFreeSnapshotVersion(j.min()):_.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(_.resumeToken,n)),i=i.insert(w,C),(function(U,L,Y){return U.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=zf?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0})(R,C,_)&&u.push(e.Pi.updateTargetData(o,C))}));let f=ge(),d=W();if(t.documentUpdates.forEach((_=>{t.resolvedLimboDocuments.has(_)&&u.push(e.persistence.referenceDelegate.updateLimboDocument(o,_))})),u.push(Wf(o,a,t.documentUpdates).next((_=>{f=_.ks,d=_.qs}))),!n.isEqual(j.min())){const _=e.Pi.getLastRemoteSnapshotVersion(o).next((w=>e.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n)));u.push(_)}return b.waitFor(u).next((()=>a.apply(o))).next((()=>e.localDocuments.getLocalViewOfDocuments(o,f,d))).next((()=>f))})).then((o=>(e.Ms=i,o)))}function Wf(r,t,e){let n=W(),i=W();return e.forEach((o=>n=n.add(o))),t.getEntries(r,n).next((o=>{let a=ge();return e.forEach(((u,f)=>{const d=o.get(u);f.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),f.isNoDocument()&&f.version.isEqual(j.min())?(t.removeEntry(u,f.readTime),a=a.insert(u,f)):!d.isValidDocument()||f.version.compareTo(d.version)>0||f.version.compareTo(d.version)===0&&d.hasPendingWrites?(t.addEntry(f),a=a.insert(u,f)):O(ai,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",f.version)})),{ks:a,qs:i}}))}function $f(r,t){const e=Q(r);return e.persistence.runTransaction("Allocate target","readwrite",(n=>{let i;return e.Pi.getTargetData(n,t).next((o=>o?(i=o,b.resolve(i)):e.Pi.allocateTargetId(n).next((a=>(i=new ne(t,a,"TargetPurposeListen",n.currentSequenceNumber),e.Pi.addTargetData(n,i).next((()=>i)))))))})).then((n=>{const i=e.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(n.targetId,n),e.xs.set(t,n.targetId)),n}))}async function Us(r,t,e){const n=Q(r),i=n.Ms.get(t),o=e?"readwrite":"readwrite-primary";try{e||await n.persistence.runTransaction("Release target",o,(a=>n.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!nn(a))throw a;O(ai,`Failed to update sequence numbers for target ${t}: ${a}`)}n.Ms=n.Ms.remove(t),n.xs.delete(i.target)}function Wo(r,t,e){const n=Q(r);let i=j.min(),o=W();return n.persistence.runTransaction("Execute query","readwrite",(a=>(function(f,d,_){const w=Q(f),R=w.xs.get(_);return R!==void 0?b.resolve(w.Ms.get(R)):w.Pi.getTargetData(d,_)})(n,a,Ut(t)).next((u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,u.targetId).next((f=>{o=f}))})).next((()=>n.Fs.getDocumentsMatchingQuery(a,t,e?i:j.min(),e?o:W()))).next((u=>(Yf(n,Fh(t),u),{documents:u,Qs:o})))))}function Yf(r,t,e){let n=r.Os.get(t)||j.min();e.forEach(((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)})),r.Os.set(t,n)}class $o{constructor(){this.activeTargetIds=zh()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Xf{constructor(){this.Mo=new $o,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,n){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new $o,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Jf{Oo(t){}shutdown(){}}const Yo="ConnectivityMonitor";class Xo{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){O(Yo,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){O(Yo,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let pr=null;function js(){return pr===null?pr=(function(){return 268435456+Math.round(2147483648*Math.random())})():pr++,"0x"+pr.toString(16)}const _s="RestConnection",Zf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class td{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===br?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(t,e,n,i,o){const a=js(),u=this.zo(t,e.toUriEncodedString());O(_s,`Sending RPC '${t}' ${a}:`,u,n);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,i,o);const{host:d}=new URL(u),_=Ks(d);return this.Jo(t,u,f,n,_).then((w=>(O(_s,`Received RPC '${t}' ${a}: `,w),w)),(w=>{throw Qe(_s,`RPC '${t}' ${a} failed with error: `,w,"url: ",u,"request:",n),w}))}Ho(t,e,n,i,o,a){return this.Go(t,e,n,i,o)}jo(t,e,n){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+en})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((i,o)=>t[o]=i)),n&&n.headers.forEach(((i,o)=>t[o]=i))}zo(t,e){const n=Zf[t];return`${this.Uo}/v1/${e}:${n}`}terminate(){}}class ed{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}const At="WebChannelConnection";class nd extends td{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,n,i,o){const a=js();return new Promise(((u,f)=>{const d=new ba;d.setWithCredentials(!0),d.listenOnce(Ca.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case yr.NO_ERROR:const w=d.getResponseJson();O(At,`XHR for RPC '${t}' ${a} received:`,JSON.stringify(w)),u(w);break;case yr.TIMEOUT:O(At,`RPC '${t}' ${a} timed out`),f(new M(P.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:const R=d.getStatus();if(O(At,`RPC '${t}' ${a} failed with status:`,R,"response text:",d.getResponseText()),R>0){let C=d.getResponseJson();Array.isArray(C)&&(C=C[0]);const B=C?.error;if(B&&B.status&&B.message){const U=(function(Y){const $=Y.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf($)>=0?$:P.UNKNOWN})(B.status);f(new M(U,B.message))}else f(new M(P.UNKNOWN,"Server responded with status "+d.getStatus()))}else f(new M(P.UNAVAILABLE,"Connection failed."));break;default:q(9055,{l_:t,streamId:a,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{O(At,`RPC '${t}' ${a} completed.`)}}));const _=JSON.stringify(i);O(At,`RPC '${t}' ${a} sending request:`,i),d.send(e,"POST",_,n,15)}))}T_(t,e,n){const i=js(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=Da(),u=Va(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(f.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,e,n),f.encodeInitMessageHeaders=!0;const _=o.join("");O(At,`Creating RPC '${t}' stream ${i}: ${_}`,f);const w=a.createWebChannel(_,f);this.I_(w);let R=!1,C=!1;const B=new ed({Yo:L=>{C?O(At,`Not sending because RPC '${t}' stream ${i} is closed:`,L):(R||(O(At,`Opening RPC '${t}' stream ${i} transport.`),w.open(),R=!0),O(At,`RPC '${t}' stream ${i} sending:`,L),w.send(L))},Zo:()=>w.close()}),U=(L,Y,$)=>{L.listen(Y,(X=>{try{$(X)}catch(Et){setTimeout((()=>{throw Et}),0)}}))};return U(w,Cn.EventType.OPEN,(()=>{C||(O(At,`RPC '${t}' stream ${i} transport opened.`),B.o_())})),U(w,Cn.EventType.CLOSE,(()=>{C||(C=!0,O(At,`RPC '${t}' stream ${i} transport closed`),B.a_(),this.E_(w))})),U(w,Cn.EventType.ERROR,(L=>{C||(C=!0,Qe(At,`RPC '${t}' stream ${i} transport errored. Name:`,L.name,"Message:",L.message),B.a_(new M(P.UNAVAILABLE,"The operation could not be completed")))})),U(w,Cn.EventType.MESSAGE,(L=>{if(!C){const Y=L.data[0];et(!!Y,16349);const $=Y,X=$?.error||$[0]?.error;if(X){O(At,`RPC '${t}' stream ${i} received error:`,X);const Et=X.status;let It=(function(m){const g=ct[m];if(g!==void 0)return nl(g)})(Et),ot=X.message;It===void 0&&(It=P.INTERNAL,ot="Unknown error status: "+Et+" with message "+X.message),C=!0,B.a_(new M(It,ot)),w.close()}else O(At,`RPC '${t}' stream ${i} received:`,Y),B.u_(Y)}})),U(u,Pa.STAT_EVENT,(L=>{L.stat===bs.PROXY?O(At,`RPC '${t}' stream ${i} detected buffering proxy`):L.stat===bs.NOPROXY&&O(At,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{B.__()}),0),B}terminate(){this.c_.forEach((t=>t.close())),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter((e=>e===t))}}function Es(){return typeof document<"u"?document:null}function ml(r){return new cf(r,!0)}class pl{constructor(t,e,n=1e3,i=1.5,o=6e4){this.Mi=t,this.timerId=e,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,e-n);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),t()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Jo="PersistentStream";class rd{constructor(t,e,n,i,o,a,u,f){this.Mi=t,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new pl(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===P.RESOURCE_EXHAUSTED?(Ht(e.toString()),Ht("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,i])=>{this.D_===e&&this.G_(n,i)}),(n=>{t((()=>{const i=new M(P.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)}))}))}G_(t,e){const n=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{n((()=>this.z_(i)))})),this.stream.onMessage((i=>{n((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return O(Jo,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget((()=>this.D_===t?e():(O(Jo,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class sd extends rd{constructor(t,e,n,i,o,a){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,a),this.serializer=o}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=gf(this.serializer,t),n=(function(o){if(!("targetChange"in o))return j.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?j.min():a.readTime?ze(a.readTime):j.min()})(t);return this.listener.H_(e,n)}Y_(t){const e={};e.database=zo(this.serializer),e.addTarget=(function(o,a){let u;const f=a.target;if(u=Os(f)?{documents:mf(o,f)}:{query:pf(o,f).ft},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=hf(o,a.resumeToken);const d=Fs(o,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(j.min())>0){u.readTime=uf(o,a.snapshotVersion.toTimestamp());const d=Fs(o,a.expectedCount);d!==null&&(u.expectedCount=d)}return u})(this.serializer,t);const n=_f(this.serializer,t);n&&(e.labels=n),this.q_(e)}Z_(t){const e={};e.database=zo(this.serializer),e.removeTarget=t,this.q_(e)}}class id{}class od extends id{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new M(P.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Go(t,Bs(e,n),i,o,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new M(P.UNKNOWN,o.toString())}))}Ho(t,e,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,u])=>this.connection.Ho(t,Bs(e,n),i,a,u,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new M(P.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class ad{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ht(e),this.aa=!1):O("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Je="RemoteStore";class ld{constructor(t,e,n,i,o){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((a=>{n.enqueueAndForget((async()=>{Wn(this)&&(O(Je,"Restarting streams for network reachability change."),await(async function(f){const d=Q(f);d.Ea.add(4),await Qn(d),d.Ra.set("Unknown"),d.Ea.delete(4),await zr(d)})(this))}))})),this.Ra=new ad(n,i)}}async function zr(r){if(Wn(r))for(const t of r.da)await t(!0)}async function Qn(r){for(const t of r.da)await t(!1)}function yl(r,t){const e=Q(r);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),hi(e)?ui(e):rn(e).O_()&&ci(e,t))}function li(r,t){const e=Q(r),n=rn(e);e.Ia.delete(t),n.O_()&&_l(e,t),e.Ia.size===0&&(n.O_()?n.L_():Wn(e)&&e.Ra.set("Unknown"))}function ci(r,t){if(r.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(j.min())>0){const e=r.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}rn(r).Y_(t)}function _l(r,t){r.Va.Ue(t),rn(r).Z_(t)}function ui(r){r.Va=new sf({getRemoteKeysForTarget:t=>r.remoteSyncer.getRemoteKeysForTarget(t),At:t=>r.Ia.get(t)||null,ht:()=>r.datastore.serializer.databaseId}),rn(r).start(),r.Ra.ua()}function hi(r){return Wn(r)&&!rn(r).x_()&&r.Ia.size>0}function Wn(r){return Q(r).Ea.size===0}function El(r){r.Va=void 0}async function cd(r){r.Ra.set("Online")}async function ud(r){r.Ia.forEach(((t,e)=>{ci(r,t)}))}async function hd(r,t){El(r),hi(r)?(r.Ra.ha(t),ui(r)):r.Ra.set("Unknown")}async function fd(r,t,e){if(r.Ra.set("Online"),t instanceof sl&&t.state===2&&t.cause)try{await(async function(i,o){const a=o.cause;for(const u of o.targetIds)i.Ia.has(u)&&(await i.remoteSyncer.rejectListen(u,a),i.Ia.delete(u),i.Va.removeTarget(u))})(r,t)}catch(n){O(Je,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Zo(r,n)}else if(t instanceof vr?r.Va.Ze(t):t instanceof rl?r.Va.st(t):r.Va.tt(t),!e.isEqual(j.min()))try{const n=await gl(r.localStore);e.compareTo(n)>=0&&await(function(o,a){const u=o.Va.Tt(a);return u.targetChanges.forEach(((f,d)=>{if(f.resumeToken.approximateByteSize()>0){const _=o.Ia.get(d);_&&o.Ia.set(d,_.withResumeToken(f.resumeToken,a))}})),u.targetMismatches.forEach(((f,d)=>{const _=o.Ia.get(f);if(!_)return;o.Ia.set(f,_.withResumeToken(Tt.EMPTY_BYTE_STRING,_.snapshotVersion)),_l(o,f);const w=new ne(_.target,f,d,_.sequenceNumber);ci(o,w)})),o.remoteSyncer.applyRemoteEvent(u)})(r,e)}catch(n){O(Je,"Failed to raise snapshot:",n),await Zo(r,n)}}async function Zo(r,t,e){if(!nn(t))throw t;r.Ea.add(1),await Qn(r),r.Ra.set("Offline"),e||(e=()=>gl(r.localStore)),r.asyncQueue.enqueueRetryable((async()=>{O(Je,"Retrying IndexedDB access"),await e(),r.Ea.delete(1),await zr(r)}))}async function ta(r,t){const e=Q(r);e.asyncQueue.verifyOperationInProgress(),O(Je,"RemoteStore received new credentials");const n=Wn(e);e.Ea.add(3),await Qn(e),n&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await zr(e)}async function dd(r,t){const e=Q(r);t?(e.Ea.delete(2),await zr(e)):t||(e.Ea.add(2),await Qn(e),e.Ra.set("Unknown"))}function rn(r){return r.ma||(r.ma=(function(e,n,i){const o=Q(e);return o.sa(),new sd(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(r.datastore,r.asyncQueue,{Xo:cd.bind(null,r),t_:ud.bind(null,r),r_:hd.bind(null,r),H_:fd.bind(null,r)}),r.da.push((async t=>{t?(r.ma.B_(),hi(r)?ui(r):r.Ra.set("Unknown")):(await r.ma.stop(),El(r))}))),r.ma}class fi{constructor(t,e,n,i,o){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new oe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,o){const a=Date.now()+n,u=new fi(t,e,a,i,o);return u.start(n),u}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(P.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vl(r,t){if(Ht("AsyncQueue",`${t}: ${r}`),nn(r))return new M(P.UNAVAILABLE,`${t}: ${r}`);throw r}class He{static emptySet(t){return new He(t.comparator)}constructor(t){this.comparator=t?(e,n)=>t(e,n)||F.comparator(e.key,n.key):(e,n)=>F.comparator(e.key,n.key),this.keyedMap=Pn(),this.sortedSet=new it(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof He)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const i=e.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const n=new He;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class ea{constructor(){this.ga=new it(F.comparator)}track(t){const e=t.doc.key,n=this.ga.get(e);n?t.type!==0&&n.type===3?this.ga=this.ga.insert(e,t):t.type===3&&n.type!==1?this.ga=this.ga.insert(e,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.ga=this.ga.remove(e):t.type===1&&n.type===2?this.ga=this.ga.insert(e,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):q(63341,{Rt:t,pa:n}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Ze{constructor(t,e,n,i,o,a,u,f,d){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=f,this.hasCachedResults=d}static fromInitialDocuments(t,e,n,i,o){const a=[];return e.forEach((u=>{a.push({type:0,doc:u})})),new Ze(t,e,He.emptySet(e),a,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Br(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0}}class gd{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((t=>t.Da()))}}class md{constructor(){this.queries=na(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,n){const i=Q(e),o=i.queries;i.queries=na(),o.forEach(((a,u)=>{for(const f of u.Sa)f.onError(n)}))})(this,new M(P.ABORTED,"Firestore shutting down"))}}function na(){return new De((r=>Qa(r)),Br)}async function Tl(r,t){const e=Q(r);let n=3;const i=t.query;let o=e.queries.get(i);o?!o.ba()&&t.Da()&&(n=2):(o=new gd,n=t.Da()?0:1);try{switch(n){case 0:o.wa=await e.onListen(i,!0);break;case 1:o.wa=await e.onListen(i,!1);break;case 2:await e.onFirstRemoteStoreListen(i)}}catch(a){const u=vl(a,`Initialization of query '${Ue(t.query)}' failed`);return void t.onError(u)}e.queries.set(i,o),o.Sa.push(t),t.va(e.onlineState),o.wa&&t.Fa(o.wa)&&di(e)}async function Il(r,t){const e=Q(r),n=t.query;let i=3;const o=e.queries.get(n);if(o){const a=o.Sa.indexOf(t);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?i=t.Da()?0:1:!o.ba()&&t.Da()&&(i=2))}switch(i){case 0:return e.queries.delete(n),e.onUnlisten(n,!0);case 1:return e.queries.delete(n),e.onUnlisten(n,!1);case 2:return e.onLastRemoteStoreUnlisten(n);default:return}}function pd(r,t){const e=Q(r);let n=!1;for(const i of t){const o=i.query,a=e.queries.get(o);if(a){for(const u of a.Sa)u.Fa(i)&&(n=!0);a.wa=i}}n&&di(e)}function yd(r,t,e){const n=Q(r),i=n.queries.get(t);if(i)for(const o of i.Sa)o.onError(e);n.queries.delete(t)}function di(r){r.Ca.forEach((t=>{t.next()}))}var qs,ra;(ra=qs||(qs={})).Ma="default",ra.Cache="cache";class Al{constructor(t,e,n){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(t){if(!this.options.includeMetadataChanges){const n=[];for(const i of t.docChanges)i.type!==3&&n.push(i);t=new Ze(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const n=e!=="Offline";return(!this.options.qa||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Ze.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==qs.Cache}}class wl{constructor(t){this.key=t}}class Sl{constructor(t){this.key=t}}class _d{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=W(),this.mutatedKeys=W(),this.eu=Wa(t),this.tu=new He(this.eu)}get nu(){return this.Ya}ru(t,e){const n=e?e.iu:new ea,i=e?e.tu:this.tu;let o=e?e.mutatedKeys:this.mutatedKeys,a=i,u=!1;const f=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((_,w)=>{const R=i.get(_),C=Ur(this.query,w)?w:null,B=!!R&&this.mutatedKeys.has(R.key),U=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let L=!1;R&&C?R.data.isEqual(C.data)?B!==U&&(n.track({type:3,doc:C}),L=!0):this.su(R,C)||(n.track({type:2,doc:C}),L=!0,(f&&this.eu(C,f)>0||d&&this.eu(C,d)<0)&&(u=!0)):!R&&C?(n.track({type:0,doc:C}),L=!0):R&&!C&&(n.track({type:1,doc:R}),L=!0,(f||d)&&(u=!0)),L&&(C?(a=a.add(C),o=U?o.add(_):o.delete(_)):(a=a.delete(_),o=o.delete(_)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const _=this.query.limitType==="F"?a.last():a.first();a=a.delete(_.key),o=o.delete(_.key),n.track({type:1,doc:_})}return{tu:a,iu:n,Cs:u,mutatedKeys:o}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const o=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const a=t.iu.ya();a.sort(((_,w)=>(function(C,B){const U=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return q(20277,{Rt:L})}};return U(C)-U(B)})(_.type,w.type)||this.eu(_.doc,w.doc))),this.ou(n),i=i??!1;const u=e&&!i?this._u():[],f=this.Xa.size===0&&this.current&&!i?1:0,d=f!==this.Za;return this.Za=f,a.length!==0||d?{snapshot:new Ze(this.query,t.tu,o,a,t.mutatedKeys,f===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new ea,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=W(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const e=[];return t.forEach((n=>{this.Xa.has(n)||e.push(new Sl(n))})),this.Xa.forEach((n=>{t.has(n)||e.push(new wl(n))})),e}cu(t){this.Ya=t.Qs,this.Xa=W();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Ze.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const gi="SyncEngine";class Ed{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class vd{constructor(t){this.key=t,this.hu=!1}}class Td{constructor(t,e,n,i,o,a){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new De((u=>Qa(u)),Br),this.Iu=new Map,this.Eu=new Set,this.du=new it(F.comparator),this.Au=new Map,this.Ru=new si,this.Vu={},this.mu=new Map,this.fu=Xe.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Id(r,t,e=!0){const n=Vl(r);let i;const o=n.Tu.get(t);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await Rl(n,t,e,!0),i}async function Ad(r,t){const e=Vl(r);await Rl(e,t,!0,!1)}async function Rl(r,t,e,n){const i=await $f(r.localStore,Ut(t)),o=i.targetId,a=r.sharedClientState.addLocalQueryTarget(o,e);let u;return n&&(u=await wd(r,t,o,a==="current",i.resumeToken)),r.isPrimaryClient&&e&&yl(r.remoteStore,i),u}async function wd(r,t,e,n,i){r.pu=(w,R,C)=>(async function(U,L,Y,$){let X=L.view.ru(Y);X.Cs&&(X=await Wo(U.localStore,L.query,!1).then((({documents:v})=>L.view.ru(v,X))));const Et=$&&$.targetChanges.get(L.targetId),It=$&&$.targetMismatches.get(L.targetId)!=null,ot=L.view.applyChanges(X,U.isPrimaryClient,Et,It);return ia(U,L.targetId,ot.au),ot.snapshot})(r,w,R,C);const o=await Wo(r.localStore,t,!0),a=new _d(t,o.Qs),u=a.ru(o.documents),f=Kn.createSynthesizedTargetChangeForCurrentChange(e,n&&r.onlineState!=="Offline",i),d=a.applyChanges(u,r.isPrimaryClient,f);ia(r,e,d.au);const _=new Ed(t,e,a);return r.Tu.set(t,_),r.Iu.has(e)?r.Iu.get(e).push(t):r.Iu.set(e,[t]),d.snapshot}async function Sd(r,t,e){const n=Q(r),i=n.Tu.get(t),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter((a=>!Br(a,t)))),void n.Tu.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Us(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),e&&li(n.remoteStore,i.targetId),Gs(n,i.targetId)})).catch(Or)):(Gs(n,i.targetId),await Us(n.localStore,i.targetId,!0))}async function Rd(r,t){const e=Q(r),n=e.Tu.get(t),i=e.Iu.get(n.targetId);e.isPrimaryClient&&i.length===1&&(e.sharedClientState.removeLocalQueryTarget(n.targetId),li(e.remoteStore,n.targetId))}async function bl(r,t){const e=Q(r);try{const n=await Qf(e.localStore,t);t.targetChanges.forEach(((i,o)=>{const a=e.Au.get(o);a&&(et(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?et(a.hu,14607):i.removedDocuments.size>0&&(et(a.hu,42227),a.hu=!1))})),await Pl(e,n,t)}catch(n){await Or(n)}}function sa(r,t,e){const n=Q(r);if(n.isPrimaryClient&&e===0||!n.isPrimaryClient&&e===1){const i=[];n.Tu.forEach(((o,a)=>{const u=a.view.va(t);u.snapshot&&i.push(u.snapshot)})),(function(a,u){const f=Q(a);f.onlineState=u;let d=!1;f.queries.forEach(((_,w)=>{for(const R of w.Sa)R.va(u)&&(d=!0)})),d&&di(f)})(n.eventManager,t),i.length&&n.Pu.H_(i),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function bd(r,t,e){const n=Q(r);n.sharedClientState.updateQueryState(t,"rejected",e);const i=n.Au.get(t),o=i&&i.key;if(o){let a=new it(F.comparator);a=a.insert(o,St.newNoDocument(o,j.min()));const u=W().add(o),f=new Gr(j.min(),new Map,new it(z),a,u);await bl(n,f),n.du=n.du.remove(o),n.Au.delete(t),mi(n)}else await Us(n.localStore,t,!1).then((()=>Gs(n,t,e))).catch(Or)}function Gs(r,t,e=null){r.sharedClientState.removeLocalQueryTarget(t);for(const n of r.Iu.get(t))r.Tu.delete(n),e&&r.Pu.yu(n,e);r.Iu.delete(t),r.isPrimaryClient&&r.Ru.jr(t).forEach((n=>{r.Ru.containsKey(n)||Cl(r,n)}))}function Cl(r,t){r.Eu.delete(t.path.canonicalString());const e=r.du.get(t);e!==null&&(li(r.remoteStore,e),r.du=r.du.remove(t),r.Au.delete(e),mi(r))}function ia(r,t,e){for(const n of e)n instanceof wl?(r.Ru.addReference(n.key,t),Cd(r,n)):n instanceof Sl?(O(gi,"Document no longer in limbo: "+n.key),r.Ru.removeReference(n.key,t),r.Ru.containsKey(n.key)||Cl(r,n.key)):q(19791,{wu:n})}function Cd(r,t){const e=t.key,n=e.path.canonicalString();r.du.get(e)||r.Eu.has(n)||(O(gi,"New document in limbo: "+e),r.Eu.add(n),mi(r))}function mi(r){for(;r.Eu.size>0&&r.du.size<r.maxConcurrentLimboResolutions;){const t=r.Eu.values().next().value;r.Eu.delete(t);const e=new F(tt.fromString(t)),n=r.fu.next();r.Au.set(n,new vd(e)),r.du=r.du.insert(e,n),yl(r.remoteStore,new ne(Ut(ti(e.path)),n,"TargetPurposeLimboResolution",Lr.ce))}}async function Pl(r,t,e){const n=Q(r),i=[],o=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,f)=>{a.push(n.pu(f,t,e).then((d=>{if((d||e)&&n.isPrimaryClient){const _=d?!d.fromCache:e?.targetChanges.get(f.targetId)?.current;n.sharedClientState.updateQueryState(f.targetId,_?"current":"not-current")}if(d){i.push(d);const _=oi.As(f.targetId,d);o.push(_)}})))})),await Promise.all(a),n.Pu.H_(i),await(async function(f,d){const _=Q(f);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>b.forEach(d,(R=>b.forEach(R.Es,(C=>_.persistence.referenceDelegate.addReference(w,R.targetId,C))).next((()=>b.forEach(R.ds,(C=>_.persistence.referenceDelegate.removeReference(w,R.targetId,C)))))))))}catch(w){if(!nn(w))throw w;O(ai,"Failed to update sequence numbers: "+w)}for(const w of d){const R=w.targetId;if(!w.fromCache){const C=_.Ms.get(R),B=C.snapshotVersion,U=C.withLastLimboFreeSnapshotVersion(B);_.Ms=_.Ms.insert(R,U)}}})(n.localStore,o))}async function Pd(r,t){const e=Q(r);if(!e.currentUser.isEqual(t)){O(gi,"User change. New user:",t.toKey());const n=await dl(e.localStore,t);e.currentUser=t,(function(o,a){o.mu.forEach((u=>{u.forEach((f=>{f.reject(new M(P.CANCELLED,a))}))})),o.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await Pl(e,n.Ls)}}function Vd(r,t){const e=Q(r),n=e.Au.get(t);if(n&&n.hu)return W().add(n.key);{let i=W();const o=e.Iu.get(t);if(!o)return i;for(const a of o){const u=e.Tu.get(a);i=i.unionWith(u.view.nu)}return i}}function Vl(r){const t=Q(r);return t.remoteStore.remoteSyncer.applyRemoteEvent=bl.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Vd.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=bd.bind(null,t),t.Pu.H_=pd.bind(null,t.eventManager),t.Pu.yu=yd.bind(null,t.eventManager),t}class kr{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=ml(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return Kf(this.persistence,new Gf,t.initialUser,this.serializer)}Cu(t){return new fl(ii.mi,this.serializer)}Du(t){return new Xf}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}kr.provider={build:()=>new kr};class Dd extends kr{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){et(this.persistence.referenceDelegate instanceof Nr,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Cf(n,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?Pt.withCacheSize(this.cacheSizeBytes):Pt.DEFAULT;return new fl((n=>Nr.mi(n,e)),this.serializer)}}class zs{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>sa(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Pd.bind(null,this.syncEngine),await dd(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new md})()}createDatastore(t){const e=ml(t.databaseInfo.databaseId),n=(function(o){return new nd(o)})(t.databaseInfo);return(function(o,a,u,f){return new od(o,a,u,f)})(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return(function(n,i,o,a,u){return new ld(n,i,o,a,u)})(this.localStore,this.datastore,t.asyncQueue,(e=>sa(this.syncEngine,e,0)),(function(){return Xo.v()?new Xo:new Jf})())}createSyncEngine(t,e){return(function(i,o,a,u,f,d,_){const w=new Td(i,o,a,u,f,d);return _&&(w.gu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const n=Q(e);O(Je,"RemoteStore shutting down."),n.Ea.add(5),await Qn(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}zs.provider={build:()=>new zs};class Dl{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):Ht("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}const me="FirestoreClient";class Nd{constructor(t,e,n,i,o){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=wt.UNAUTHENTICATED,this.clientId=$s.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,(async a=>{O(me,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(n,(a=>(O(me,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new oe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=vl(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function vs(r,t){r.asyncQueue.verifyOperationInProgress(),O(me,"Initializing OfflineComponentProvider");const e=r.configuration;await t.initialize(e);let n=e.initialUser;r.setCredentialChangeListener((async i=>{n.isEqual(i)||(await dl(t.localStore,i),n=i)})),t.persistence.setDatabaseDeletedListener((()=>r.terminate())),r._offlineComponents=t}async function oa(r,t){r.asyncQueue.verifyOperationInProgress();const e=await kd(r);O(me,"Initializing OnlineComponentProvider"),await t.initialize(e,r.configuration),r.setCredentialChangeListener((n=>ta(t.remoteStore,n))),r.setAppCheckTokenChangeListener(((n,i)=>ta(t.remoteStore,i))),r._onlineComponents=t}async function kd(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){O(me,"Using user provided OfflineComponentProvider");try{await vs(r,r._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(i){return i.name==="FirebaseError"?i.code===P.FAILED_PRECONDITION||i.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(e))throw e;Qe("Error using user provided cache. Falling back to memory cache: "+e),await vs(r,new kr)}}else O(me,"Using default OfflineComponentProvider"),await vs(r,new Dd(void 0));return r._offlineComponents}async function Od(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(O(me,"Using user provided OnlineComponentProvider"),await oa(r,r._uninitializedComponentsProvider._online)):(O(me,"Using default OnlineComponentProvider"),await oa(r,new zs))),r._onlineComponents}async function Nl(r){const t=await Od(r),e=t.eventManager;return e.onListen=Id.bind(null,t.syncEngine),e.onUnlisten=Sd.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=Ad.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=Rd.bind(null,t.syncEngine),e}function Ld(r,t,e={}){const n=new oe;return r.asyncQueue.enqueueAndForget((async()=>(function(o,a,u,f,d){const _=new Dl({next:R=>{_.Nu(),a.enqueueAndForget((()=>Il(o,w)));const C=R.docs.has(u);!C&&R.fromCache?d.reject(new M(P.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&R.fromCache&&f&&f.source==="server"?d.reject(new M(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(R)},error:R=>d.reject(R)}),w=new Al(ti(u.path),_,{includeMetadataChanges:!0,qa:!0});return Tl(o,w)})(await Nl(r),r.asyncQueue,t,e,n))),n.promise}function Md(r,t,e={}){const n=new oe;return r.asyncQueue.enqueueAndForget((async()=>(function(o,a,u,f,d){const _=new Dl({next:R=>{_.Nu(),a.enqueueAndForget((()=>Il(o,w))),R.fromCache&&f.source==="server"?d.reject(new M(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(R)},error:R=>d.reject(R)}),w=new Al(u,_,{includeMetadataChanges:!0,qa:!0});return Tl(o,w)})(await Nl(r),r.asyncQueue,t,e,n))),n.promise}function kl(r){const t={};return r.timeoutSeconds!==void 0&&(t.timeoutSeconds=r.timeoutSeconds),t}const aa=new Map;const Ol="firestore.googleapis.com",la=!0;class ca{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new M(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ol,this.ssl=la}else this.host=t.host,this.ssl=t.ssl??la;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=hl;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<Rf)throw new M(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}ih("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kl(t.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(n,i){return n.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Hr{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ca({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new M(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new M(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ca(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new $u;switch(n.type){case"firstParty":return new Zu(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new M(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const n=aa.get(e);n&&(O("ComponentProvider","Removing Datastore"),aa.delete(e),n.terminate())})(this),Promise.resolve()}}function xd(r,t,e,n={}){r=Bn(r,Hr);const i=Ks(t),o=r._getSettings(),a={...o,emulatorOptions:r._getEmulatorOptions()},u=`${t}:${e}`;i&&(Ic(`https://${u}`),Rc("Firestore",!0)),o.host!==Ol&&o.host!==u&&Qe("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...o,host:u,ssl:i,emulatorOptions:n};if(!wr(f,a)&&(r._setSettings(f),n.mockUserToken)){let d,_;if(typeof n.mockUserToken=="string")d=n.mockUserToken,_=wt.MOCK_USER;else{d=Ac(n.mockUserToken,r._app?.options.projectId);const w=n.mockUserToken.sub||n.mockUserToken.user_id;if(!w)throw new M(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new wt(w)}r._authCredentials=new Yu(new ka(d,_))}}class Kr{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Kr(this.firestore,t,this._query)}}class Rt{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ae(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Rt(this.firestore,t,this._key)}toJSON(){return{type:Rt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,n){if(zn(e,Rt._jsonSchema))return new Rt(t,n||null,new F(tt.fromString(e.referencePath)))}}Rt._jsonSchemaVersion="firestore/documentReference/1.0",Rt._jsonSchema={type:ht("string",Rt._jsonSchemaVersion),referencePath:ht("string")};class ae extends Kr{constructor(t,e,n){super(t,e,ti(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Rt(this.firestore,null,new F(t))}withConverter(t){return new ae(this.firestore,t,this._path)}}function Fd(r,t,...e){if(r=Ea(r),Oa("collection","path",t),r instanceof Hr){const n=tt.fromString(t,...e);return Io(n),new ae(r,null,n)}{if(!(r instanceof Rt||r instanceof ae))throw new M(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(tt.fromString(t,...e));return Io(n),new ae(r.firestore,null,n)}}function Bd(r,t,...e){if(r=Ea(r),arguments.length===1&&(t=$s.newId()),Oa("doc","path",t),r instanceof Hr){const n=tt.fromString(t,...e);return To(n),new Rt(r,null,new F(n))}{if(!(r instanceof Rt||r instanceof ae))throw new M(P.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(tt.fromString(t,...e));return To(n),new Rt(r.firestore,r instanceof ae?r.converter:null,new F(n))}}const ua="AsyncQueue";class ha{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new pl(this,"async_queue_retry"),this._c=()=>{const n=Es();n&&O(ua,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=t;const e=Es();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=Es();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new oe;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Xu.push(t),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!nn(t))throw t;O(ua,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((n=>{throw this.nc=n,this.rc=!1,Ht("INTERNAL UNHANDLED ERROR: ",fa(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=e,e}enqueueAfterDelay(t,e,n){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const i=fi.createAndSchedule(this,t,e,n,(o=>this.hc(o)));return this.tc.push(i),i}uc(){this.nc&&q(47125,{Pc:fa(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,n)=>e.targetTimeMs-n.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function fa(r){let t=r.message||"";return r.stack&&(t=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),t}class pi extends Hr{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new ha,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new ha(t),this._firestoreClient=void 0,await t}}}function Ud(r,t){const e=typeof r=="object"?r:Mu(),n=typeof r=="string"?r:br,i=Du(e,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=vc("firestore");o&&xd(i,...o)}return i}function Ll(r){if(r._terminated)throw new M(P.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||jd(r),r._firestoreClient}function jd(r){const t=r._freezeSettings(),e=(function(i,o,a,u){return new Eh(i,o,a,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,kl(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(r._databaseId,r._app?.options.appId||"",r._persistenceKey,t);r._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(r._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),r._firestoreClient=new Nd(r._authCredentials,r._appCheckCredentials,r._queue,e,r._componentsProvider&&(function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}})(r._componentsProvider))}class Bt{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Bt(Tt.fromBase64String(t))}catch(e){throw new M(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Bt(Tt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Bt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(zn(t,Bt._jsonSchema))return Bt.fromBase64String(t.bytes)}}Bt._jsonSchemaVersion="firestore/bytes/1.0",Bt._jsonSchema={type:ht("string",Bt._jsonSchemaVersion),bytes:ht("string")};class Ml{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new M(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ct(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class le{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new M(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new M(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return z(this._lat,t._lat)||z(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:le._jsonSchemaVersion}}static fromJSON(t){if(zn(t,le._jsonSchema))return new le(t.latitude,t.longitude)}}le._jsonSchemaVersion="firestore/geoPoint/1.0",le._jsonSchema={type:ht("string",le._jsonSchemaVersion),latitude:ht("number"),longitude:ht("number")};class ce{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0})(this._values,t._values)}toJSON(){return{type:ce._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(zn(t,ce._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new ce(t.vectorValues);throw new M(P.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ce._jsonSchemaVersion="firestore/vectorValue/1.0",ce._jsonSchema={type:ht("string",ce._jsonSchemaVersion),vectorValues:ht("object")};const qd=new RegExp("[~\\*/\\[\\]]");function Gd(r,t,e){if(t.search(qd)>=0)throw da(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,r);try{return new Ml(...t.split("."))._internalPath}catch{throw da(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r)}}function da(r,t,e,n,i){let o=`Function ${t}() called with invalid data`;o+=". ";let a="";return new M(P.INVALID_ARGUMENT,o+r+a)}class xl{constructor(t,e,n,i,o){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Rt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new zd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Fl("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class zd extends xl{data(){return super.data()}}function Fl(r,t){return typeof t=="string"?Gd(r,t):t instanceof Ml?t._internalPath:t._delegate._internalPath}function Hd(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new M(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Kd{convertValue(t,e="none"){switch(de(t)){case 0:return null;case 1:return t.booleanValue;case 2:return st(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(fe(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw q(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return Hn(t,((i,o)=>{n[i]=this.convertValue(o,e)})),n}convertVectorValue(t){const e=t.fields?.[Vs].arrayValue?.values?.map((n=>st(n.doubleValue)));return new ce(e)}convertGeoPoint(t){return new le(st(t.latitude),st(t.longitude))}convertArray(t,e){return(t.values||[]).map((n=>this.convertValue(n,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=xr(t);return n==null?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(jn(t));default:return null}}convertTimestamp(t){const e=he(t);return new ut(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=tt.fromString(t);et(ul(n),9688,{name:t});const i=new qn(n.get(1),n.get(3)),o=new F(n.popFirst(5));return i.isEqual(e)||Ht(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),o}}class Dn{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Pe extends xl{constructor(t,e,n,i,o,a){super(t,e,n,i,a),this._firestore=t,this._firestoreImpl=t,this.metadata=o}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Tr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(Fl("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new M(P.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=Pe._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}Pe._jsonSchemaVersion="firestore/documentSnapshot/1.0",Pe._jsonSchema={type:ht("string",Pe._jsonSchemaVersion),bundleSource:ht("string","DocumentSnapshot"),bundleName:ht("string"),bundle:ht("string")};class Tr extends Pe{data(t={}){return super.data(t)}}class Ke{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Dn(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new Tr(this._firestore,this._userDataWriter,n.key,n,new Dn(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new M(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((u=>{const f=new Tr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Dn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:f,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((u=>o||u.type!==3)).map((u=>{const f=new Tr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Dn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,_=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),_=a.indexOf(u.doc.key)),{type:Qd(u.type),doc:f,oldIndex:d,newIndex:_}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new M(P.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Ke._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=$s.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],n=[],i=[];return this.docs.forEach((o=>{o._document!==null&&(e.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function Qd(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return q(61501,{type:r})}}function Wd(r){r=Bn(r,Rt);const t=Bn(r.firestore,pi);return Ld(Ll(t),r._key).then((e=>Yd(t,r,e)))}Ke._jsonSchemaVersion="firestore/querySnapshot/1.0",Ke._jsonSchema={type:ht("string",Ke._jsonSchemaVersion),bundleSource:ht("string","QuerySnapshot"),bundleName:ht("string"),bundle:ht("string")};class Bl extends Kd{constructor(t){super(),this.firestore=t}convertBytes(t){return new Bt(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Rt(this.firestore,null,e)}}function $d(r){r=Bn(r,Kr);const t=Bn(r.firestore,pi),e=Ll(t),n=new Bl(t);return Hd(r._query),Md(e,r._query).then((i=>new Ke(t,n,r,i)))}function Yd(r,t,e){const n=e.docs.get(t._key),i=new Bl(r);return new Pe(r,i,t._key,n,new Dn(e.hasPendingWrites,e.fromCache),t.converter)}(function(t,e=!0){(function(i){en=i})(Lu),Rr(new xn("firestore",((n,{instanceIdentifier:i,options:o})=>{const a=n.getProvider("app").getImmediate(),u=new pi(new Xu(n.getProvider("auth-internal")),new th(a,n.getProvider("app-check-internal")),(function(d,_){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new M(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new qn(d.options.projectId,_)})(a,i),a);return o={useFetchStreams:e,...o},u._setSettings(o),u}),"PUBLIC").setMultipleInstances(!0)),Ge(yo,_o,t),Ge(yo,_o,"esm2020")})();const Xd={apiKey:"AIzaSyBBbaJwewCktbFWRB2K3PUvwZluvuVtBr0",authDomain:"seedra-b18d9.firebaseapp.com",projectId:"seedra-b18d9",storageBucket:"seedra-b18d9.firebasestorage.app",messagingSenderId:"678717536858",appId:"1:678717536858:web:f973d8d8bf9e92616cb663"},Ul=Aa(Xd),jl=Ud(Ul);async function Jd(){const r=Bd(jl,"products","main"),t=await Wd(r);if(!t.exists())return;const e=t.data();document.getElementById("hero-title").innerHTML=e.name,document.getElementById("hero-price").textContent=`$${e.price.toFixed(2)}`;const n=document.getElementById("hero-old-price");e.oldPrice?n.textContent=`$${e.oldPrice.toFixed(2)}`:n.style.display="none",document.getElementById("hero-image").src=e.photo}var Ir={exports:{}},Zd=Ir.exports,ga;function tg(){return ga||(ga=1,(function(r,t){(function(n,i){r.exports=i()})(Zd,function(){return(function(e){var n={};function i(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=e,i.c=n,i.d=function(o,a,u){i.o(o,a)||Object.defineProperty(o,a,{enumerable:!0,get:u})},i.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},i.t=function(o,a){if(a&1&&(o=i(o)),a&8||a&4&&typeof o=="object"&&o&&o.__esModule)return o;var u=Object.create(null);if(i.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:o}),a&2&&typeof o!="string")for(var f in o)i.d(u,f,(function(d){return o[d]}).bind(null,f));return u},i.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(a,"a",a),a},i.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},i.p="",i(i.s=0)})([(function(e,n,i){i.r(n);var o=function(y){return Array.isArray(y)?y:[y]},a=function(y){return y instanceof Node},u=function(y){return y instanceof NodeList},f=function(y,V){if(y&&V){y=u(y)?y:[y];for(var k=0;k<y.length&&V(y[k],k,y.length)!==!0;k++);}},d=function(y){return console.error("[scroll-lock] ".concat(y))},_=function(y){if(Array.isArray(y)){var V=y.join(", ");return V}},w=function(y){var V=[];return f(y,function(k){return V.push(k)}),V},R=function(y,V){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:document;if(k&&w(x.querySelectorAll(V)).indexOf(y)!==-1)return y;for(;(y=y.parentElement)&&w(x.querySelectorAll(V)).indexOf(y)===-1;);return y},C=function(y,V){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,x=w(k.querySelectorAll(V)).indexOf(y)!==-1;return x},B=function(y){if(y){var V=getComputedStyle(y),k=V.overflow==="hidden";return k}},U=function(y){if(y){if(B(y))return!0;var V=y.scrollTop;return V<=0}},L=function(y){if(y){if(B(y))return!0;var V=y.scrollTop,k=y.scrollHeight,x=V+y.offsetHeight;return x>=k}},Y=function(y){if(y){if(B(y))return!0;var V=y.scrollLeft;return V<=0}},$=function(y){if(y){if(B(y))return!0;var V=y.scrollLeft,k=y.scrollWidth,x=V+y.offsetWidth;return x>=k}},X=function(y){var V='textarea, [contenteditable="true"]';return C(y,V)},Et=function(y){var V='input[type="range"]';return C(y,V)};i.d(n,"disablePageScroll",function(){return T}),i.d(n,"enablePageScroll",function(){return E}),i.d(n,"getScrollState",function(){return I}),i.d(n,"clearQueueScrollLocks",function(){return p}),i.d(n,"getTargetScrollBarWidth",function(){return at}),i.d(n,"getCurrentTargetScrollBarWidth",function(){return Dt}),i.d(n,"getPageScrollBarWidth",function(){return on}),i.d(n,"getCurrentPageScrollBarWidth",function(){return an}),i.d(n,"addScrollableTarget",function(){return Gt}),i.d(n,"removeScrollableTarget",function(){return Kt}),i.d(n,"addScrollableSelector",function(){return $n}),i.d(n,"removeScrollableSelector",function(){return ln}),i.d(n,"addLockableTarget",function(){return cn}),i.d(n,"addLockableSelector",function(){return un}),i.d(n,"setFillGapMethod",function(){return pe}),i.d(n,"addFillGapTarget",function(){return ye}),i.d(n,"removeFillGapTarget",function(){return Ne}),i.d(n,"addFillGapSelector",function(){return Qt}),i.d(n,"removeFillGapSelector",function(){return ke}),i.d(n,"refillGaps",function(){return _e});function It(N){for(var y=1;y<arguments.length;y++){var V=arguments[y]!=null?arguments[y]:{},k=Object.keys(V);typeof Object.getOwnPropertySymbols=="function"&&(k=k.concat(Object.getOwnPropertySymbols(V).filter(function(x){return Object.getOwnPropertyDescriptor(V,x).enumerable}))),k.forEach(function(x){ot(N,x,V[x])})}return N}function ot(N,y,V){return y in N?Object.defineProperty(N,y,{value:V,enumerable:!0,configurable:!0,writable:!0}):N[y]=V,N}var v=["padding","margin","width","max-width","none"],m=3,g={scroll:!0,queue:0,scrollableSelectors:["[data-scroll-lock-scrollable]"],lockableSelectors:["body","[data-scroll-lock-lockable]"],fillGapSelectors:["body","[data-scroll-lock-fill-gap]","[data-scroll-lock-lockable]"],fillGapMethod:v[0],startTouchY:0,startTouchX:0},T=function(y){g.queue<=0&&(g.scroll=!1,hn(),Oe()),Gt(y),g.queue++},E=function(y){g.queue>0&&g.queue--,g.queue<=0&&(g.scroll=!0,Qr(),dn()),Kt(y)},I=function(){return g.scroll},p=function(){g.queue=0},at=function(y){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(a(y)){var k=y.style.overflowY;V?I()||(y.style.overflowY=y.getAttribute("data-scroll-lock-saved-overflow-y-property")):y.style.overflowY="scroll";var x=Dt(y);return y.style.overflowY=k,x}else return 0},Dt=function(y){if(a(y))if(y===document.body){var V=document.documentElement.clientWidth,k=window.innerWidth,x=k-V;return x}else{var bt=y.style.borderLeftWidth,Ot=y.style.borderRightWidth;y.style.borderLeftWidth="0px",y.style.borderRightWidth="0px";var Nt=y.offsetWidth-y.clientWidth;return y.style.borderLeftWidth=bt,y.style.borderRightWidth=Ot,Nt}else return 0},on=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return at(document.body,y)},an=function(){return Dt(document.body)},Gt=function(y){if(y){var V=o(y);V.map(function(k){f(k,function(x){a(x)?x.setAttribute("data-scroll-lock-scrollable",""):d('"'.concat(x,'" is not a Element.'))})})}},Kt=function(y){if(y){var V=o(y);V.map(function(k){f(k,function(x){a(x)?x.removeAttribute("data-scroll-lock-scrollable"):d('"'.concat(x,'" is not a Element.'))})})}},$n=function(y){if(y){var V=o(y);V.map(function(k){g.scrollableSelectors.push(k)})}},ln=function(y){if(y){var V=o(y);V.map(function(k){g.scrollableSelectors=g.scrollableSelectors.filter(function(x){return x!==k})})}},cn=function(y){if(y){var V=o(y);V.map(function(k){f(k,function(x){a(x)?x.setAttribute("data-scroll-lock-lockable",""):d('"'.concat(x,'" is not a Element.'))})}),I()||hn()}},un=function(y){if(y){var V=o(y);V.map(function(k){g.lockableSelectors.push(k)}),I()||hn(),Qt(y)}},pe=function(y){if(y)if(v.indexOf(y)!==-1)g.fillGapMethod=y,_e();else{var V=v.join(", ");d('"'.concat(y,`" method is not available!
Available fill gap methods: `).concat(V,"."))}},ye=function(y){if(y){var V=o(y);V.map(function(k){f(k,function(x){a(x)?(x.setAttribute("data-scroll-lock-fill-gap",""),g.scroll||ft(x)):d('"'.concat(x,'" is not a Element.'))})})}},Ne=function(y){if(y){var V=o(y);V.map(function(k){f(k,function(x){a(x)?(x.removeAttribute("data-scroll-lock-fill-gap"),g.scroll||Wt(x)):d('"'.concat(x,'" is not a Element.'))})})}},Qt=function(y){if(y){var V=o(y);V.map(function(k){g.fillGapSelectors.indexOf(k)===-1&&(g.fillGapSelectors.push(k),g.scroll||gn(k))})}},ke=function(y){if(y){var V=o(y);V.map(function(k){g.fillGapSelectors=g.fillGapSelectors.filter(function(x){return x!==k}),g.scroll||pt(k)})}},_e=function(){g.scroll||Oe()},hn=function(){var y=_(g.lockableSelectors);Yn(y)},Qr=function(){var y=_(g.lockableSelectors);fn(y)},Yn=function(y){var V=document.querySelectorAll(y);f(V,function(k){Xn(k)})},fn=function(y){var V=document.querySelectorAll(y);f(V,function(k){Wr(k)})},Xn=function(y){if(a(y)&&y.getAttribute("data-scroll-lock-locked")!=="true"){var V=window.getComputedStyle(y);y.setAttribute("data-scroll-lock-saved-overflow-y-property",V.overflowY),y.setAttribute("data-scroll-lock-saved-inline-overflow-property",y.style.overflow),y.setAttribute("data-scroll-lock-saved-inline-overflow-y-property",y.style.overflowY),y.style.overflow="hidden",y.setAttribute("data-scroll-lock-locked","true")}},Wr=function(y){a(y)&&y.getAttribute("data-scroll-lock-locked")==="true"&&(y.style.overflow=y.getAttribute("data-scroll-lock-saved-inline-overflow-property"),y.style.overflowY=y.getAttribute("data-scroll-lock-saved-inline-overflow-y-property"),y.removeAttribute("data-scroll-lock-saved-overflow-property"),y.removeAttribute("data-scroll-lock-saved-inline-overflow-property"),y.removeAttribute("data-scroll-lock-saved-inline-overflow-y-property"),y.removeAttribute("data-scroll-lock-locked"))},Oe=function(){g.fillGapSelectors.map(function(y){gn(y)})},dn=function(){g.fillGapSelectors.map(function(y){pt(y)})},gn=function(y){var V=document.querySelectorAll(y),k=g.lockableSelectors.indexOf(y)!==-1;f(V,function(x){ft(x,k)})},ft=function(y){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(a(y)){var k;if(y.getAttribute("data-scroll-lock-lockable")===""||V)k=at(y,!0);else{var x=R(y,_(g.lockableSelectors));k=at(x,!0)}y.getAttribute("data-scroll-lock-filled-gap")==="true"&&Wt(y);var bt=window.getComputedStyle(y);if(y.setAttribute("data-scroll-lock-filled-gap","true"),y.setAttribute("data-scroll-lock-current-fill-gap-method",g.fillGapMethod),g.fillGapMethod==="margin"){var Ot=parseFloat(bt.marginRight);y.style.marginRight="".concat(Ot+k,"px")}else if(g.fillGapMethod==="width")y.style.width="calc(100% - ".concat(k,"px)");else if(g.fillGapMethod==="max-width")y.style.maxWidth="calc(100% - ".concat(k,"px)");else if(g.fillGapMethod==="padding"){var Nt=parseFloat(bt.paddingRight);y.style.paddingRight="".concat(Nt+k,"px")}}},pt=function(y){var V=document.querySelectorAll(y);f(V,function(k){Wt(k)})},Wt=function(y){if(a(y)&&y.getAttribute("data-scroll-lock-filled-gap")==="true"){var V=y.getAttribute("data-scroll-lock-current-fill-gap-method");y.removeAttribute("data-scroll-lock-filled-gap"),y.removeAttribute("data-scroll-lock-current-fill-gap-method"),V==="margin"?y.style.marginRight="":V==="width"?y.style.width="":V==="max-width"?y.style.maxWidth="":V==="padding"&&(y.style.paddingRight="")}},$r=function(y){_e()},Jn=function(y){g.scroll||(g.startTouchY=y.touches[0].clientY,g.startTouchX=y.touches[0].clientX)},Yr=function(y){if(!g.scroll){var V=g.startTouchY,k=g.startTouchX,x=y.touches[0].clientY,bt=y.touches[0].clientX;if(y.touches.length<2){var Ot=_(g.scrollableSelectors),Nt={up:V<x,down:V>x,left:k<bt,right:k>bt},kt={up:V+m<x,down:V-m>x,left:k+m<bt,right:k-m>bt},er=function ve(rt){var Te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(rt){var Le=R(rt,Ot,!1);if(Et(rt))return!1;if(Te||X(rt)&&R(rt,Ot)||C(rt,Ot)){var lt=!1;Y(rt)&&$(rt)?(Nt.up&&U(rt)||Nt.down&&L(rt))&&(lt=!0):U(rt)&&L(rt)?(Nt.left&&Y(rt)||Nt.right&&$(rt))&&(lt=!0):(kt.up&&U(rt)||kt.down&&L(rt)||kt.left&&Y(rt)||kt.right&&$(rt))&&(lt=!0),lt&&(Le?ve(Le,!0):y.cancelable&&y.preventDefault())}else ve(Le)}else y.cancelable&&y.preventDefault()};er(y.target)}}},Ee=function(y){g.scroll||(g.startTouchY=0,g.startTouchX=0)};typeof window<"u"&&window.addEventListener("resize",$r),typeof document<"u"&&(document.addEventListener("touchstart",Jn),document.addEventListener("touchmove",Yr,{passive:!1}),document.addEventListener("touchend",Ee));var Zn={hide:function(y){d(`"hide" is deprecated! Use "disablePageScroll" instead. 
 https://github.com/FL3NKEY/scroll-lock#disablepagescrollscrollabletarget`),T(y)},show:function(y){d(`"show" is deprecated! Use "enablePageScroll" instead. 
 https://github.com/FL3NKEY/scroll-lock#enablepagescrollscrollabletarget`),E(y)},toggle:function(y){d('"toggle" is deprecated! Do not use it.'),I()?T():E(y)},getState:function(){return d(`"getState" is deprecated! Use "getScrollState" instead. 
 https://github.com/FL3NKEY/scroll-lock#getscrollstate`),I()},getWidth:function(){return d(`"getWidth" is deprecated! Use "getPageScrollBarWidth" instead. 
 https://github.com/FL3NKEY/scroll-lock#getpagescrollbarwidth`),on()},getCurrentWidth:function(){return d(`"getCurrentWidth" is deprecated! Use "getCurrentPageScrollBarWidth" instead. 
 https://github.com/FL3NKEY/scroll-lock#getcurrentpagescrollbarwidth`),an()},setScrollableTargets:function(y){d(`"setScrollableTargets" is deprecated! Use "addScrollableTarget" instead. 
 https://github.com/FL3NKEY/scroll-lock#addscrollabletargetscrollabletarget`),Gt(y)},setFillGapSelectors:function(y){d(`"setFillGapSelectors" is deprecated! Use "addFillGapSelector" instead. 
 https://github.com/FL3NKEY/scroll-lock#addfillgapselectorfillgapselector`),Qt(y)},setFillGapTargets:function(y){d(`"setFillGapTargets" is deprecated! Use "addFillGapTarget" instead. 
 https://github.com/FL3NKEY/scroll-lock#addfillgaptargetfillgaptarget`),ye(y)},clearQueue:function(){d(`"clearQueue" is deprecated! Use "clearQueueScrollLocks" instead. 
 https://github.com/FL3NKEY/scroll-lock#clearqueuescrolllocks`),p()}},tr=It({disablePageScroll:T,enablePageScroll:E,getScrollState:I,clearQueueScrollLocks:p,getTargetScrollBarWidth:at,getCurrentTargetScrollBarWidth:Dt,getPageScrollBarWidth:on,getCurrentPageScrollBarWidth:an,addScrollableSelector:$n,removeScrollableSelector:ln,addScrollableTarget:Gt,removeScrollableTarget:Kt,addLockableSelector:un,addLockableTarget:cn,addFillGapSelector:Qt,removeFillGapSelector:ke,addFillGapTarget:ye,removeFillGapTarget:Ne,setFillGapMethod:pe,refillGaps:_e,_state:g},Zn);n.default=tr})]).default})})(Ir)),Ir.exports}var Ts=tg();function eg(){const r=document.querySelector(".header__burger-btn"),t=document.querySelector(".burger"),e=document.querySelector(".burger__bg"),n=document.querySelector(".burger__menu-link");if(!r||!t)return;const i=()=>{const a=t.classList.toggle("active");r.classList.toggle("active",a),e.classList.toggle("active",a),a?Ts.disablePageScroll():Ts.enablePageScroll()},o=()=>{r.classList.remove("active"),t.classList.remove("active"),e.classList.remove("active"),Ts.enablePageScroll()};r.addEventListener("click",i),n?.addEventListener("click",o),e.addEventListener("click",o),document.querySelectorAll(".js-close-burger").forEach(a=>{a.addEventListener("click",o)}),window.addEventListener("resize",()=>{o()})}function ng(){document.querySelectorAll(".burger__category-btn").forEach(t=>{t.addEventListener("click",()=>{const e=t.closest(".burger__category-item");if(!e)return;const n=e.querySelector(".burger__subcategory");if(!n)return;const i=n.classList.contains("open");document.querySelectorAll(".burger__subcategory.open").forEach(o=>{o.classList.remove("open"),o.style.maxHeight=null,o.closest(".burger__category-item").querySelector(".burger__category-btn").classList.remove("active")}),i||(n.classList.add("open"),n.style.maxHeight=n.scrollHeight+"px",t.classList.add("active"))})})}console.log("Firebase ready",Ul);document.addEventListener("DOMContentLoaded",async()=>{await Jd(),eg(),ng()});const rg=await $d(Fd(jl,"products")),yi={};rg.forEach(r=>{yi[r.id]=r.data()});const sg=yi.main;console.log("main",sg);const sn=(r,t)=>{const e=document.getElementById(r);console.log(e);const n=yi[t];console.log("productsMap: ",n);const i=e.querySelector(".card__title"),o=e.querySelector(".card__photo"),a=e.querySelector(".card__price"),u=e.querySelector(".card__old-price"),f=e.querySelector(".card__fire-price");!n.name||!n.price||!n.photo||(console.log("product.img: ",n.photo),i.textContent=n.name,a.textContent=n.price,o.src=n.photo,n.firePrice&&(f.style.display="block"),n.oldPrice&&(u.textContent=n.oldPrice))};sn("card-1","product-1");sn("card-2","product-2");sn("card-3","product-3");sn("card-4","product-4");sn("card-5","product-5");sn("card-6","product-6");
