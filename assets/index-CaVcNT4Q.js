(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();const _c=()=>{};var ao={};const Ea=function(r){const t=[];let e=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=i&63|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=i&63|128)}return t},Ec=function(r){const t=[];let e=0,n=0;for(;e<r.length;){const i=r[e++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=r[e++];t[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=r[e++],a=r[e++],u=r[e++],d=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;t[n++]=String.fromCharCode(55296+(d>>10)),t[n++]=String.fromCharCode(56320+(d&1023))}else{const o=r[e++],a=r[e++];t[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return t.join("")},va={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,t){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const o=r[i],a=i+1<r.length,u=a?r[i+1]:0,d=i+2<r.length,f=d?r[i+2]:0,_=o>>2,A=(o&3)<<4|u>>4;let b=(u&15)<<2|f>>6,C=f&63;d||(C=64,a||(b=64)),n.push(e[_],e[A],e[b],e[C])}return n.join("")},encodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(r):this.encodeByteArray(Ea(r),t)},decodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(r):Ec(this.decodeStringToByteArray(r,t))},decodeStringToByteArray(r,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const o=e[r.charAt(i++)],u=i<r.length?e[r.charAt(i)]:0;++i;const f=i<r.length?e[r.charAt(i)]:64;++i;const A=i<r.length?e[r.charAt(i)]:64;if(++i,o==null||u==null||f==null||A==null)throw new vc;const b=o<<2|u>>4;if(n.push(b),f!==64){const C=u<<4&240|f>>2;if(n.push(C),A!==64){const B=f<<6&192|A;n.push(B)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class vc extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Tc=function(r){const t=Ea(r);return va.encodeByteArray(t,!0)},Ar=function(r){return Tc(r).replace(/\./g,"")},wc=function(r){try{return va.decodeString(r,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function Ic(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Ac=()=>Ic().__FIREBASE_DEFAULTS__,Sc=()=>{if(typeof process>"u"||typeof ao>"u")return;const r=ao.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},bc=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=r&&wc(r[1]);return t&&JSON.parse(t)},Ws=()=>{try{return _c()||Ac()||Sc()||bc()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},Rc=r=>Ws()?.emulatorHosts?.[r],Cc=r=>{const t=Rc(r);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),n]:[t.substring(0,e),n]},Ta=()=>Ws()?.config;class Pc{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,n))}}}function $s(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Vc(r){return(await fetch(r,{credentials:"include"})).ok}function Dc(r,t){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},n=t||"demo-project",i=r.iat||0,o=r.sub||r.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...r};return[Ar(JSON.stringify(e)),Ar(JSON.stringify(a)),""].join(".")}const Nn={};function Nc(){const r={prod:[],emulator:[]};for(const t of Object.keys(Nn))Nn[t]?r.emulator.push(t):r.prod.push(t);return r}function kc(r){let t=document.getElementById(r),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",r),e=!0),{created:e,element:t}}let lo=!1;function Oc(r,t){if(typeof window>"u"||typeof document>"u"||!$s(window.location.host)||Nn[r]===t||Nn[r]||lo)return;Nn[r]=t;function e(b){return`__firebase__banner__${b}`}const n="__firebase__banner",o=Nc().prod.length>0;function a(){const b=document.getElementById(n);b&&b.remove()}function u(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function d(b,C){b.setAttribute("width","24"),b.setAttribute("id",C),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function f(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{lo=!0,a()},b}function _(b,C){b.setAttribute("id",C),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function A(){const b=kc(n),C=e("text"),B=document.getElementById(C)||document.createElement("span"),U=e("learnmore"),L=document.getElementById(U)||document.createElement("a"),Y=e("preprendIcon"),$=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const X=b.element;u(X),_(L,U);const Et=f();d($,Y),X.append($,B,L,Et),document.body.appendChild(X)}o?(B.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,B.innerText="Preview backend running in this workspace."),B.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",A):A()}function Lc(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function xc(){const r=Ws()?.forceEnvironment;if(r==="node")return!0;if(r==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Mc(){return!xc()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Fc(){try{return typeof indexedDB=="object"}catch{return!1}}function Bc(){return new Promise((r,t)=>{try{let e=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}})}const Uc="FirebaseError";class tn extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name=Uc,Object.setPrototypeOf(this,tn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wa.prototype.create)}}class wa{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,o=this.errors[t],a=o?qc(o,n):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new tn(i,u,n)}}function qc(r,t){return r.replace(jc,(e,n)=>{const i=t[n];return i!=null?String(i):`<${n}?>`})}const jc=/\{\$([^}]+)}/g;function Sr(r,t){if(r===t)return!0;const e=Object.keys(r),n=Object.keys(t);for(const i of e){if(!n.includes(i))return!1;const o=r[i],a=t[i];if(co(o)&&co(a)){if(!Sr(o,a))return!1}else if(o!==a)return!1}for(const i of n)if(!e.includes(i))return!1;return!0}function co(r){return r!==null&&typeof r=="object"}function Ia(r){return r&&r._delegate?r._delegate:r}class Mn{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const be="[DEFAULT]";class Gc{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const n=new Pc;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),n=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Hc(t))try{this.getOrInitializeService({instanceIdentifier:be})}catch{}for(const[e,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(t=be){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=be){return this.instances.has(t)}getOptions(t=be){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[o,a]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);n===u&&a.resolve(i)}return i}onInit(t,e){const n=this.normalizeInstanceIdentifier(e),i=this.onInitCallbacks.get(n)??new Set;i.add(t),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&t(o,n),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:zc(t),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=be){return this.component?this.component.multipleInstances?t:be:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zc(r){return r===be?void 0:r}function Hc(r){return r.instantiationMode==="EAGER"}class Kc{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Gc(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var K;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(K||(K={}));const Qc={debug:K.DEBUG,verbose:K.VERBOSE,info:K.INFO,warn:K.WARN,error:K.ERROR,silent:K.SILENT},Wc=K.INFO,$c={[K.DEBUG]:"log",[K.VERBOSE]:"log",[K.INFO]:"info",[K.WARN]:"warn",[K.ERROR]:"error"},Yc=(r,t,...e)=>{if(t<r.logLevel)return;const n=new Date().toISOString(),i=$c[t];if(i)console[i](`[${n}]  ${r.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Aa{constructor(t){this.name=t,this._logLevel=Wc,this._logHandler=Yc,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in K))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Qc[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,K.DEBUG,...t),this._logHandler(this,K.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,K.VERBOSE,...t),this._logHandler(this,K.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,K.INFO,...t),this._logHandler(this,K.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,K.WARN,...t),this._logHandler(this,K.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,K.ERROR,...t),this._logHandler(this,K.ERROR,...t)}}const Xc=(r,t)=>t.some(e=>r instanceof e);let uo,ho;function Jc(){return uo||(uo=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Zc(){return ho||(ho=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Sa=new WeakMap,Ss=new WeakMap,ba=new WeakMap,gs=new WeakMap,Ys=new WeakMap;function tu(r){const t=new Promise((e,n)=>{const i=()=>{r.removeEventListener("success",o),r.removeEventListener("error",a)},o=()=>{e(re(r.result)),i()},a=()=>{n(r.error),i()};r.addEventListener("success",o),r.addEventListener("error",a)});return t.then(e=>{e instanceof IDBCursor&&Sa.set(e,r)}).catch(()=>{}),Ys.set(t,r),t}function eu(r){if(Ss.has(r))return;const t=new Promise((e,n)=>{const i=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",a),r.removeEventListener("abort",a)},o=()=>{e(),i()},a=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",o),r.addEventListener("error",a),r.addEventListener("abort",a)});Ss.set(r,t)}let bs={get(r,t,e){if(r instanceof IDBTransaction){if(t==="done")return Ss.get(r);if(t==="objectStoreNames")return r.objectStoreNames||ba.get(r);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return re(r[t])},set(r,t,e){return r[t]=e,!0},has(r,t){return r instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in r}};function nu(r){bs=r(bs)}function ru(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const n=r.call(ms(this),t,...e);return ba.set(n,t.sort?t.sort():[t]),re(n)}:Zc().includes(r)?function(...t){return r.apply(ms(this),t),re(Sa.get(this))}:function(...t){return re(r.apply(ms(this),t))}}function su(r){return typeof r=="function"?ru(r):(r instanceof IDBTransaction&&eu(r),Xc(r,Jc())?new Proxy(r,bs):r)}function re(r){if(r instanceof IDBRequest)return tu(r);if(gs.has(r))return gs.get(r);const t=su(r);return t!==r&&(gs.set(r,t),Ys.set(t,r)),t}const ms=r=>Ys.get(r);function iu(r,t,{blocked:e,upgrade:n,blocking:i,terminated:o}={}){const a=indexedDB.open(r,t),u=re(a);return n&&a.addEventListener("upgradeneeded",d=>{n(re(a.result),d.oldVersion,d.newVersion,re(a.transaction),d)}),e&&a.addEventListener("blocked",d=>e(d.oldVersion,d.newVersion,d)),u.then(d=>{o&&d.addEventListener("close",()=>o()),i&&d.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),u}const ou=["get","getKey","getAll","getAllKeys","count"],au=["put","add","delete","clear"],ps=new Map;function fo(r,t){if(!(r instanceof IDBDatabase&&!(t in r)&&typeof t=="string"))return;if(ps.get(t))return ps.get(t);const e=t.replace(/FromIndex$/,""),n=t!==e,i=au.includes(e);if(!(e in(n?IDBIndex:IDBObjectStore).prototype)||!(i||ou.includes(e)))return;const o=async function(a,...u){const d=this.transaction(a,i?"readwrite":"readonly");let f=d.store;return n&&(f=f.index(u.shift())),(await Promise.all([f[e](...u),i&&d.done]))[0]};return ps.set(t,o),o}nu(r=>({...r,get:(t,e,n)=>fo(t,e)||r.get(t,e,n),has:(t,e)=>!!fo(t,e)||r.has(t,e)}));class lu{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(cu(e)){const n=e.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(e=>e).join(" ")}}function cu(r){return r.getComponent()?.type==="VERSION"}const Rs="@firebase/app",go="0.14.6";const zt=new Aa("@firebase/app"),uu="@firebase/app-compat",hu="@firebase/analytics-compat",du="@firebase/analytics",fu="@firebase/app-check-compat",gu="@firebase/app-check",mu="@firebase/auth",pu="@firebase/auth-compat",yu="@firebase/database",_u="@firebase/data-connect",Eu="@firebase/database-compat",vu="@firebase/functions",Tu="@firebase/functions-compat",wu="@firebase/installations",Iu="@firebase/installations-compat",Au="@firebase/messaging",Su="@firebase/messaging-compat",bu="@firebase/performance",Ru="@firebase/performance-compat",Cu="@firebase/remote-config",Pu="@firebase/remote-config-compat",Vu="@firebase/storage",Du="@firebase/storage-compat",Nu="@firebase/firestore",ku="@firebase/ai",Ou="@firebase/firestore-compat",Lu="firebase",xu="12.6.0";const Cs="[DEFAULT]",Mu={[Rs]:"fire-core",[uu]:"fire-core-compat",[du]:"fire-analytics",[hu]:"fire-analytics-compat",[gu]:"fire-app-check",[fu]:"fire-app-check-compat",[mu]:"fire-auth",[pu]:"fire-auth-compat",[yu]:"fire-rtdb",[_u]:"fire-data-connect",[Eu]:"fire-rtdb-compat",[vu]:"fire-fn",[Tu]:"fire-fn-compat",[wu]:"fire-iid",[Iu]:"fire-iid-compat",[Au]:"fire-fcm",[Su]:"fire-fcm-compat",[bu]:"fire-perf",[Ru]:"fire-perf-compat",[Cu]:"fire-rc",[Pu]:"fire-rc-compat",[Vu]:"fire-gcs",[Du]:"fire-gcs-compat",[Nu]:"fire-fst",[Ou]:"fire-fst-compat",[ku]:"fire-vertex","fire-js":"fire-js",[Lu]:"fire-js-all"};const br=new Map,Fu=new Map,Ps=new Map;function mo(r,t){try{r.container.addComponent(t)}catch(e){zt.debug(`Component ${t.name} failed to register with FirebaseApp ${r.name}`,e)}}function Rr(r){const t=r.name;if(Ps.has(t))return zt.debug(`There were multiple attempts to register component ${t}.`),!1;Ps.set(t,r);for(const e of br.values())mo(e,r);for(const e of Fu.values())mo(e,r);return!0}function Bu(r,t){const e=r.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),r.container.getProvider(t)}function Uu(r){return r==null?!1:r.settings!==void 0}const qu={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},se=new wa("app","Firebase",qu);class ju{constructor(t,e,n){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Mn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw se.create("app-deleted",{appName:this._name})}}const Gu=xu;function Ra(r,t={}){let e=r;typeof t!="object"&&(t={name:t});const n={name:Cs,automaticDataCollectionEnabled:!0,...t},i=n.name;if(typeof i!="string"||!i)throw se.create("bad-app-name",{appName:String(i)});if(e||(e=Ta()),!e)throw se.create("no-options");const o=br.get(i);if(o){if(Sr(e,o.options)&&Sr(n,o.config))return o;throw se.create("duplicate-app",{appName:i})}const a=new Kc(i);for(const d of Ps.values())a.addComponent(d);const u=new ju(e,n,a);return br.set(i,u),u}function zu(r=Cs){const t=br.get(r);if(!t&&r===Cs&&Ta())return Ra();if(!t)throw se.create("no-app",{appName:r});return t}function Ge(r,t,e){let n=Mu[r]??r;e&&(n+=`-${e}`);const i=n.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const a=[`Unable to register library "${n}" with version "${t}":`];i&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),zt.warn(a.join(" "));return}Rr(new Mn(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}const Hu="firebase-heartbeat-database",Ku=1,Fn="firebase-heartbeat-store";let ys=null;function Ca(){return ys||(ys=iu(Hu,Ku,{upgrade:(r,t)=>{switch(t){case 0:try{r.createObjectStore(Fn)}catch(e){console.warn(e)}}}}).catch(r=>{throw se.create("idb-open",{originalErrorMessage:r.message})})),ys}async function Qu(r){try{const e=(await Ca()).transaction(Fn),n=await e.objectStore(Fn).get(Pa(r));return await e.done,n}catch(t){if(t instanceof tn)zt.warn(t.message);else{const e=se.create("idb-get",{originalErrorMessage:t?.message});zt.warn(e.message)}}}async function po(r,t){try{const n=(await Ca()).transaction(Fn,"readwrite");await n.objectStore(Fn).put(t,Pa(r)),await n.done}catch(e){if(e instanceof tn)zt.warn(e.message);else{const n=se.create("idb-set",{originalErrorMessage:e?.message});zt.warn(n.message)}}}function Pa(r){return`${r.name}!${r.options.appId}`}const Wu=1024,$u=30;class Yu{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Ju(e),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=yo();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:e}),this._heartbeatsCache.heartbeats.length>$u){const i=Zu(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){zt.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=yo(),{heartbeatsToSend:e,unsentEntries:n}=Xu(this._heartbeatsCache.heartbeats),i=Ar(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return zt.warn(t),""}}}function yo(){return new Date().toISOString().substring(0,10)}function Xu(r,t=Wu){const e=[];let n=r.slice();for(const i of r){const o=e.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),_o(e)>t){o.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),_o(e)>t){e.pop();break}n=n.slice(1)}return{heartbeatsToSend:e,unsentEntries:n}}class Ju{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Fc()?Bc().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await Qu(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return po(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return po(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}else return}}function _o(r){return Ar(JSON.stringify({version:2,heartbeats:r})).length}function Zu(r){if(r.length===0)return-1;let t=0,e=r[0].date;for(let n=1;n<r.length;n++)r[n].date<e&&(e=r[n].date,t=n);return t}function th(r){Rr(new Mn("platform-logger",t=>new lu(t),"PRIVATE")),Rr(new Mn("heartbeat",t=>new Yu(t),"PRIVATE")),Ge(Rs,go,r),Ge(Rs,go,"esm2020"),Ge("fire-js","")}th("");var eh="firebase",nh="12.7.0";Ge(eh,nh,"app");var Eo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ie,Va;(function(){var r;function t(v,m){function g(){}g.prototype=m.prototype,v.F=m.prototype,v.prototype=new g,v.prototype.constructor=v,v.D=function(T,E,w){for(var p=Array(arguments.length-2),at=2;at<arguments.length;at++)p[at-2]=arguments[at];return m.prototype[E].apply(T,p)}}function e(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(n,e),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(v,m,g){g||(g=0);const T=Array(16);if(typeof m=="string")for(var E=0;E<16;++E)T[E]=m.charCodeAt(g++)|m.charCodeAt(g++)<<8|m.charCodeAt(g++)<<16|m.charCodeAt(g++)<<24;else for(E=0;E<16;++E)T[E]=m[g++]|m[g++]<<8|m[g++]<<16|m[g++]<<24;m=v.g[0],g=v.g[1],E=v.g[2];let w=v.g[3],p;p=m+(w^g&(E^w))+T[0]+3614090360&4294967295,m=g+(p<<7&4294967295|p>>>25),p=w+(E^m&(g^E))+T[1]+3905402710&4294967295,w=m+(p<<12&4294967295|p>>>20),p=E+(g^w&(m^g))+T[2]+606105819&4294967295,E=w+(p<<17&4294967295|p>>>15),p=g+(m^E&(w^m))+T[3]+3250441966&4294967295,g=E+(p<<22&4294967295|p>>>10),p=m+(w^g&(E^w))+T[4]+4118548399&4294967295,m=g+(p<<7&4294967295|p>>>25),p=w+(E^m&(g^E))+T[5]+1200080426&4294967295,w=m+(p<<12&4294967295|p>>>20),p=E+(g^w&(m^g))+T[6]+2821735955&4294967295,E=w+(p<<17&4294967295|p>>>15),p=g+(m^E&(w^m))+T[7]+4249261313&4294967295,g=E+(p<<22&4294967295|p>>>10),p=m+(w^g&(E^w))+T[8]+1770035416&4294967295,m=g+(p<<7&4294967295|p>>>25),p=w+(E^m&(g^E))+T[9]+2336552879&4294967295,w=m+(p<<12&4294967295|p>>>20),p=E+(g^w&(m^g))+T[10]+4294925233&4294967295,E=w+(p<<17&4294967295|p>>>15),p=g+(m^E&(w^m))+T[11]+2304563134&4294967295,g=E+(p<<22&4294967295|p>>>10),p=m+(w^g&(E^w))+T[12]+1804603682&4294967295,m=g+(p<<7&4294967295|p>>>25),p=w+(E^m&(g^E))+T[13]+4254626195&4294967295,w=m+(p<<12&4294967295|p>>>20),p=E+(g^w&(m^g))+T[14]+2792965006&4294967295,E=w+(p<<17&4294967295|p>>>15),p=g+(m^E&(w^m))+T[15]+1236535329&4294967295,g=E+(p<<22&4294967295|p>>>10),p=m+(E^w&(g^E))+T[1]+4129170786&4294967295,m=g+(p<<5&4294967295|p>>>27),p=w+(g^E&(m^g))+T[6]+3225465664&4294967295,w=m+(p<<9&4294967295|p>>>23),p=E+(m^g&(w^m))+T[11]+643717713&4294967295,E=w+(p<<14&4294967295|p>>>18),p=g+(w^m&(E^w))+T[0]+3921069994&4294967295,g=E+(p<<20&4294967295|p>>>12),p=m+(E^w&(g^E))+T[5]+3593408605&4294967295,m=g+(p<<5&4294967295|p>>>27),p=w+(g^E&(m^g))+T[10]+38016083&4294967295,w=m+(p<<9&4294967295|p>>>23),p=E+(m^g&(w^m))+T[15]+3634488961&4294967295,E=w+(p<<14&4294967295|p>>>18),p=g+(w^m&(E^w))+T[4]+3889429448&4294967295,g=E+(p<<20&4294967295|p>>>12),p=m+(E^w&(g^E))+T[9]+568446438&4294967295,m=g+(p<<5&4294967295|p>>>27),p=w+(g^E&(m^g))+T[14]+3275163606&4294967295,w=m+(p<<9&4294967295|p>>>23),p=E+(m^g&(w^m))+T[3]+4107603335&4294967295,E=w+(p<<14&4294967295|p>>>18),p=g+(w^m&(E^w))+T[8]+1163531501&4294967295,g=E+(p<<20&4294967295|p>>>12),p=m+(E^w&(g^E))+T[13]+2850285829&4294967295,m=g+(p<<5&4294967295|p>>>27),p=w+(g^E&(m^g))+T[2]+4243563512&4294967295,w=m+(p<<9&4294967295|p>>>23),p=E+(m^g&(w^m))+T[7]+1735328473&4294967295,E=w+(p<<14&4294967295|p>>>18),p=g+(w^m&(E^w))+T[12]+2368359562&4294967295,g=E+(p<<20&4294967295|p>>>12),p=m+(g^E^w)+T[5]+4294588738&4294967295,m=g+(p<<4&4294967295|p>>>28),p=w+(m^g^E)+T[8]+2272392833&4294967295,w=m+(p<<11&4294967295|p>>>21),p=E+(w^m^g)+T[11]+1839030562&4294967295,E=w+(p<<16&4294967295|p>>>16),p=g+(E^w^m)+T[14]+4259657740&4294967295,g=E+(p<<23&4294967295|p>>>9),p=m+(g^E^w)+T[1]+2763975236&4294967295,m=g+(p<<4&4294967295|p>>>28),p=w+(m^g^E)+T[4]+1272893353&4294967295,w=m+(p<<11&4294967295|p>>>21),p=E+(w^m^g)+T[7]+4139469664&4294967295,E=w+(p<<16&4294967295|p>>>16),p=g+(E^w^m)+T[10]+3200236656&4294967295,g=E+(p<<23&4294967295|p>>>9),p=m+(g^E^w)+T[13]+681279174&4294967295,m=g+(p<<4&4294967295|p>>>28),p=w+(m^g^E)+T[0]+3936430074&4294967295,w=m+(p<<11&4294967295|p>>>21),p=E+(w^m^g)+T[3]+3572445317&4294967295,E=w+(p<<16&4294967295|p>>>16),p=g+(E^w^m)+T[6]+76029189&4294967295,g=E+(p<<23&4294967295|p>>>9),p=m+(g^E^w)+T[9]+3654602809&4294967295,m=g+(p<<4&4294967295|p>>>28),p=w+(m^g^E)+T[12]+3873151461&4294967295,w=m+(p<<11&4294967295|p>>>21),p=E+(w^m^g)+T[15]+530742520&4294967295,E=w+(p<<16&4294967295|p>>>16),p=g+(E^w^m)+T[2]+3299628645&4294967295,g=E+(p<<23&4294967295|p>>>9),p=m+(E^(g|~w))+T[0]+4096336452&4294967295,m=g+(p<<6&4294967295|p>>>26),p=w+(g^(m|~E))+T[7]+1126891415&4294967295,w=m+(p<<10&4294967295|p>>>22),p=E+(m^(w|~g))+T[14]+2878612391&4294967295,E=w+(p<<15&4294967295|p>>>17),p=g+(w^(E|~m))+T[5]+4237533241&4294967295,g=E+(p<<21&4294967295|p>>>11),p=m+(E^(g|~w))+T[12]+1700485571&4294967295,m=g+(p<<6&4294967295|p>>>26),p=w+(g^(m|~E))+T[3]+2399980690&4294967295,w=m+(p<<10&4294967295|p>>>22),p=E+(m^(w|~g))+T[10]+4293915773&4294967295,E=w+(p<<15&4294967295|p>>>17),p=g+(w^(E|~m))+T[1]+2240044497&4294967295,g=E+(p<<21&4294967295|p>>>11),p=m+(E^(g|~w))+T[8]+1873313359&4294967295,m=g+(p<<6&4294967295|p>>>26),p=w+(g^(m|~E))+T[15]+4264355552&4294967295,w=m+(p<<10&4294967295|p>>>22),p=E+(m^(w|~g))+T[6]+2734768916&4294967295,E=w+(p<<15&4294967295|p>>>17),p=g+(w^(E|~m))+T[13]+1309151649&4294967295,g=E+(p<<21&4294967295|p>>>11),p=m+(E^(g|~w))+T[4]+4149444226&4294967295,m=g+(p<<6&4294967295|p>>>26),p=w+(g^(m|~E))+T[11]+3174756917&4294967295,w=m+(p<<10&4294967295|p>>>22),p=E+(m^(w|~g))+T[2]+718787259&4294967295,E=w+(p<<15&4294967295|p>>>17),p=g+(w^(E|~m))+T[9]+3951481745&4294967295,v.g[0]=v.g[0]+m&4294967295,v.g[1]=v.g[1]+(E+(p<<21&4294967295|p>>>11))&4294967295,v.g[2]=v.g[2]+E&4294967295,v.g[3]=v.g[3]+w&4294967295}n.prototype.v=function(v,m){m===void 0&&(m=v.length);const g=m-this.blockSize,T=this.C;let E=this.h,w=0;for(;w<m;){if(E==0)for(;w<=g;)i(this,v,w),w+=this.blockSize;if(typeof v=="string"){for(;w<m;)if(T[E++]=v.charCodeAt(w++),E==this.blockSize){i(this,T),E=0;break}}else for(;w<m;)if(T[E++]=v[w++],E==this.blockSize){i(this,T),E=0;break}}this.h=E,this.o+=m},n.prototype.A=function(){var v=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);v[0]=128;for(var m=1;m<v.length-8;++m)v[m]=0;m=this.o*8;for(var g=v.length-8;g<v.length;++g)v[g]=m&255,m/=256;for(this.v(v),v=Array(16),m=0,g=0;g<4;++g)for(let T=0;T<32;T+=8)v[m++]=this.g[g]>>>T&255;return v};function o(v,m){var g=u;return Object.prototype.hasOwnProperty.call(g,v)?g[v]:g[v]=m(v)}function a(v,m){this.h=m;const g=[];let T=!0;for(let E=v.length-1;E>=0;E--){const w=v[E]|0;T&&w==m||(g[E]=w,T=!1)}this.g=g}var u={};function d(v){return-128<=v&&v<128?o(v,function(m){return new a([m|0],m<0?-1:0)}):new a([v|0],v<0?-1:0)}function f(v){if(isNaN(v)||!isFinite(v))return A;if(v<0)return L(f(-v));const m=[];let g=1;for(let T=0;v>=g;T++)m[T]=v/g|0,g*=4294967296;return new a(m,0)}function _(v,m){if(v.length==0)throw Error("number format error: empty string");if(m=m||10,m<2||36<m)throw Error("radix out of range: "+m);if(v.charAt(0)=="-")return L(_(v.substring(1),m));if(v.indexOf("-")>=0)throw Error('number format error: interior "-" character');const g=f(Math.pow(m,8));let T=A;for(let w=0;w<v.length;w+=8){var E=Math.min(8,v.length-w);const p=parseInt(v.substring(w,w+E),m);E<8?(E=f(Math.pow(m,E)),T=T.j(E).add(f(p))):(T=T.j(g),T=T.add(f(p)))}return T}var A=d(0),b=d(1),C=d(16777216);r=a.prototype,r.m=function(){if(U(this))return-L(this).m();let v=0,m=1;for(let g=0;g<this.g.length;g++){const T=this.i(g);v+=(T>=0?T:4294967296+T)*m,m*=4294967296}return v},r.toString=function(v){if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(B(this))return"0";if(U(this))return"-"+L(this).toString(v);const m=f(Math.pow(v,6));var g=this;let T="";for(;;){const E=Et(g,m).g;g=Y(g,E.j(m));let w=((g.g.length>0?g.g[0]:g.h)>>>0).toString(v);if(g=E,B(g))return w+T;for(;w.length<6;)w="0"+w;T=w+T}},r.i=function(v){return v<0?0:v<this.g.length?this.g[v]:this.h};function B(v){if(v.h!=0)return!1;for(let m=0;m<v.g.length;m++)if(v.g[m]!=0)return!1;return!0}function U(v){return v.h==-1}r.l=function(v){return v=Y(this,v),U(v)?-1:B(v)?0:1};function L(v){const m=v.g.length,g=[];for(let T=0;T<m;T++)g[T]=~v.g[T];return new a(g,~v.h).add(b)}r.abs=function(){return U(this)?L(this):this},r.add=function(v){const m=Math.max(this.g.length,v.g.length),g=[];let T=0;for(let E=0;E<=m;E++){let w=T+(this.i(E)&65535)+(v.i(E)&65535),p=(w>>>16)+(this.i(E)>>>16)+(v.i(E)>>>16);T=p>>>16,w&=65535,p&=65535,g[E]=p<<16|w}return new a(g,g[g.length-1]&-2147483648?-1:0)};function Y(v,m){return v.add(L(m))}r.j=function(v){if(B(this)||B(v))return A;if(U(this))return U(v)?L(this).j(L(v)):L(L(this).j(v));if(U(v))return L(this.j(L(v)));if(this.l(C)<0&&v.l(C)<0)return f(this.m()*v.m());const m=this.g.length+v.g.length,g=[];for(var T=0;T<2*m;T++)g[T]=0;for(T=0;T<this.g.length;T++)for(let E=0;E<v.g.length;E++){const w=this.i(T)>>>16,p=this.i(T)&65535,at=v.i(E)>>>16,Dt=v.i(E)&65535;g[2*T+2*E]+=p*Dt,$(g,2*T+2*E),g[2*T+2*E+1]+=w*Dt,$(g,2*T+2*E+1),g[2*T+2*E+1]+=p*at,$(g,2*T+2*E+1),g[2*T+2*E+2]+=w*at,$(g,2*T+2*E+2)}for(v=0;v<m;v++)g[v]=g[2*v+1]<<16|g[2*v];for(v=m;v<2*m;v++)g[v]=0;return new a(g,0)};function $(v,m){for(;(v[m]&65535)!=v[m];)v[m+1]+=v[m]>>>16,v[m]&=65535,m++}function X(v,m){this.g=v,this.h=m}function Et(v,m){if(B(m))throw Error("division by zero");if(B(v))return new X(A,A);if(U(v))return m=Et(L(v),m),new X(L(m.g),L(m.h));if(U(m))return m=Et(v,L(m)),new X(L(m.g),m.h);if(v.g.length>30){if(U(v)||U(m))throw Error("slowDivide_ only works with positive integers.");for(var g=b,T=m;T.l(v)<=0;)g=wt(g),T=wt(T);var E=ot(g,1),w=ot(T,1);for(T=ot(T,2),g=ot(g,2);!B(T);){var p=w.add(T);p.l(v)<=0&&(E=E.add(g),w=p),T=ot(T,1),g=ot(g,1)}return m=Y(v,E.j(m)),new X(E,m)}for(E=A;v.l(m)>=0;){for(g=Math.max(1,Math.floor(v.m()/m.m())),T=Math.ceil(Math.log(g)/Math.LN2),T=T<=48?1:Math.pow(2,T-48),w=f(g),p=w.j(m);U(p)||p.l(v)>0;)g-=T,w=f(g),p=w.j(m);B(w)&&(w=b),E=E.add(w),v=Y(v,p)}return new X(E,v)}r.B=function(v){return Et(this,v).h},r.and=function(v){const m=Math.max(this.g.length,v.g.length),g=[];for(let T=0;T<m;T++)g[T]=this.i(T)&v.i(T);return new a(g,this.h&v.h)},r.or=function(v){const m=Math.max(this.g.length,v.g.length),g=[];for(let T=0;T<m;T++)g[T]=this.i(T)|v.i(T);return new a(g,this.h|v.h)},r.xor=function(v){const m=Math.max(this.g.length,v.g.length),g=[];for(let T=0;T<m;T++)g[T]=this.i(T)^v.i(T);return new a(g,this.h^v.h)};function wt(v){const m=v.g.length+1,g=[];for(let T=0;T<m;T++)g[T]=v.i(T)<<1|v.i(T-1)>>>31;return new a(g,v.h)}function ot(v,m){const g=m>>5;m%=32;const T=v.g.length-g,E=[];for(let w=0;w<T;w++)E[w]=m>0?v.i(w+g)>>>m|v.i(w+g+1)<<32-m:v.i(w+g);return new a(E,v.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,Va=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=f,a.fromString=_,ie=a}).apply(typeof Eo<"u"?Eo:typeof self<"u"?self:typeof window<"u"?window:{});var fr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Da,Cn,Na,_r,Vs,ka,Oa,La;(function(){var r,t=Object.defineProperty;function e(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof fr=="object"&&fr];for(var l=0;l<s.length;++l){var c=s[l];if(c&&c.Math==Math)return c}throw Error("Cannot find global object")}var n=e(this);function i(s,l){if(l)t:{var c=n;s=s.split(".");for(var h=0;h<s.length-1;h++){var I=s[h];if(!(I in c))break t;c=c[I]}s=s[s.length-1],h=c[s],l=l(h),l!=h&&l!=null&&t(c,s,{configurable:!0,writable:!0,value:l})}}i("Symbol.dispose",function(s){return s||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(s){return s||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(s){return s||function(l){var c=[],h;for(h in l)Object.prototype.hasOwnProperty.call(l,h)&&c.push([h,l[h]]);return c}});var o=o||{},a=this||self;function u(s){var l=typeof s;return l=="object"&&s!=null||l=="function"}function d(s,l,c){return s.call.apply(s.bind,arguments)}function f(s,l,c){return f=d,f.apply(null,arguments)}function _(s,l){var c=Array.prototype.slice.call(arguments,1);return function(){var h=c.slice();return h.push.apply(h,arguments),s.apply(this,h)}}function A(s,l){function c(){}c.prototype=l.prototype,s.Z=l.prototype,s.prototype=new c,s.prototype.constructor=s,s.Ob=function(h,I,S){for(var D=Array(arguments.length-2),G=2;G<arguments.length;G++)D[G-2]=arguments[G];return l.prototype[I].apply(h,D)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?s=>s&&AsyncContext.Snapshot.wrap(s):s=>s;function C(s){const l=s.length;if(l>0){const c=Array(l);for(let h=0;h<l;h++)c[h]=s[h];return c}return[]}function B(s,l){for(let h=1;h<arguments.length;h++){const I=arguments[h];var c=typeof I;if(c=c!="object"?c:I?Array.isArray(I)?"array":c:"null",c=="array"||c=="object"&&typeof I.length=="number"){c=s.length||0;const S=I.length||0;s.length=c+S;for(let D=0;D<S;D++)s[c+D]=I[D]}else s.push(I)}}class U{constructor(l,c){this.i=l,this.j=c,this.h=0,this.g=null}get(){let l;return this.h>0?(this.h--,l=this.g,this.g=l.next,l.next=null):l=this.i(),l}}function L(s){a.setTimeout(()=>{throw s},0)}function Y(){var s=v;let l=null;return s.g&&(l=s.g,s.g=s.g.next,s.g||(s.h=null),l.next=null),l}class ${constructor(){this.h=this.g=null}add(l,c){const h=X.get();h.set(l,c),this.h?this.h.next=h:this.g=h,this.h=h}}var X=new U(()=>new Et,s=>s.reset());class Et{constructor(){this.next=this.g=this.h=null}set(l,c){this.h=l,this.g=c,this.next=null}reset(){this.next=this.g=this.h=null}}let wt,ot=!1,v=new $,m=()=>{const s=Promise.resolve(void 0);wt=()=>{s.then(g)}};function g(){for(var s;s=Y();){try{s.h.call(s.g)}catch(c){L(c)}var l=X;l.j(s),l.h<100&&(l.h++,s.next=l.g,l.g=s)}ot=!1}function T(){this.u=this.u,this.C=this.C}T.prototype.u=!1,T.prototype.dispose=function(){this.u||(this.u=!0,this.N())},T.prototype[Symbol.dispose]=function(){this.dispose()},T.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function E(s,l){this.type=s,this.g=this.target=l,this.defaultPrevented=!1}E.prototype.h=function(){this.defaultPrevented=!0};var w=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var s=!1,l=Object.defineProperty({},"passive",{get:function(){s=!0}});try{const c=()=>{};a.addEventListener("test",c,l),a.removeEventListener("test",c,l)}catch{}return s})();function p(s){return/^[\s\xa0]*$/.test(s)}function at(s,l){E.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s&&this.init(s,l)}A(at,E),at.prototype.init=function(s,l){const c=this.type=s.type,h=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;this.target=s.target||s.srcElement,this.g=l,l=s.relatedTarget,l||(c=="mouseover"?l=s.fromElement:c=="mouseout"&&(l=s.toElement)),this.relatedTarget=l,h?(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=s.pointerType,this.state=s.state,this.i=s,s.defaultPrevented&&at.Z.h.call(this)},at.prototype.h=function(){at.Z.h.call(this);const s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var Dt="closure_listenable_"+(Math.random()*1e6|0),on=0;function an(s,l,c,h,I){this.listener=s,this.proxy=null,this.src=l,this.type=c,this.capture=!!h,this.ha=I,this.key=++on,this.da=this.fa=!1}function Gt(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function Kt(s,l,c){for(const h in s)l.call(c,s[h],h,s)}function Yn(s,l){for(const c in s)l.call(void 0,s[c],c,s)}function ln(s){const l={};for(const c in s)l[c]=s[c];return l}const cn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function un(s,l){let c,h;for(let I=1;I<arguments.length;I++){h=arguments[I];for(c in h)s[c]=h[c];for(let S=0;S<cn.length;S++)c=cn[S],Object.prototype.hasOwnProperty.call(h,c)&&(s[c]=h[c])}}function pe(s){this.src=s,this.g={},this.h=0}pe.prototype.add=function(s,l,c,h,I){const S=s.toString();s=this.g[S],s||(s=this.g[S]=[],this.h++);const D=Ne(s,l,h,I);return D>-1?(l=s[D],c||(l.fa=!1)):(l=new an(l,this.src,S,!!h,I),l.fa=c,s.push(l)),l};function ye(s,l){const c=l.type;if(c in s.g){var h=s.g[c],I=Array.prototype.indexOf.call(h,l,void 0),S;(S=I>=0)&&Array.prototype.splice.call(h,I,1),S&&(Gt(l),s.g[c].length==0&&(delete s.g[c],s.h--))}}function Ne(s,l,c,h){for(let I=0;I<s.length;++I){const S=s[I];if(!S.da&&S.listener==l&&S.capture==!!c&&S.ha==h)return I}return-1}var Qt="closure_lm_"+(Math.random()*1e6|0),ke={};function _e(s,l,c,h,I){if(Array.isArray(l)){for(let S=0;S<l.length;S++)_e(s,l[S],c,h,I);return null}return c=gn(c),s&&s[Dt]?s.J(l,c,u(h)?!!h.capture:!1,I):hn(s,l,c,!1,h,I)}function hn(s,l,c,h,I,S){if(!l)throw Error("Invalid event type");const D=u(I)?!!I.capture:!!I;let G=Oe(s);if(G||(s[Qt]=G=new pe(s)),c=G.add(l,c,h,D,S),c.proxy)return c;if(h=Yr(),c.proxy=h,h.src=s,h.listener=c,s.addEventListener)w||(I=D),I===void 0&&(I=!1),s.addEventListener(l.toString(),h,I);else if(s.attachEvent)s.attachEvent(Jn(l.toString()),h);else if(s.addListener&&s.removeListener)s.addListener(h);else throw Error("addEventListener and attachEvent are unavailable.");return c}function Yr(){function s(c){return l.call(s.src,s.listener,c)}const l=Xr;return s}function Xn(s,l,c,h,I){if(Array.isArray(l))for(var S=0;S<l.length;S++)Xn(s,l[S],c,h,I);else h=u(h)?!!h.capture:!!h,c=gn(c),s&&s[Dt]?(s=s.i,S=String(l).toString(),S in s.g&&(l=s.g[S],c=Ne(l,c,h,I),c>-1&&(Gt(l[c]),Array.prototype.splice.call(l,c,1),l.length==0&&(delete s.g[S],s.h--)))):s&&(s=Oe(s))&&(l=s.g[l.toString()],s=-1,l&&(s=Ne(l,c,h,I)),(c=s>-1?l[s]:null)&&dn(c))}function dn(s){if(typeof s!="number"&&s&&!s.da){var l=s.src;if(l&&l[Dt])ye(l.i,s);else{var c=s.type,h=s.proxy;l.removeEventListener?l.removeEventListener(c,h,s.capture):l.detachEvent?l.detachEvent(Jn(c),h):l.addListener&&l.removeListener&&l.removeListener(h),(c=Oe(l))?(ye(c,s),c.h==0&&(c.src=null,l[Qt]=null)):Gt(s)}}}function Jn(s){return s in ke?ke[s]:ke[s]="on"+s}function Xr(s,l){if(s.da)s=!0;else{l=new at(l,this);const c=s.listener,h=s.ha||s.src;s.fa&&dn(s),s=c.call(h,l)}return s}function Oe(s){return s=s[Qt],s instanceof pe?s:null}var fn="__closure_events_fn_"+(Math.random()*1e9>>>0);function gn(s){return typeof s=="function"?s:(s[fn]||(s[fn]=function(l){return s.handleEvent(l)}),s[fn])}function dt(){T.call(this),this.i=new pe(this),this.M=this,this.G=null}A(dt,T),dt.prototype[Dt]=!0,dt.prototype.removeEventListener=function(s,l,c,h){Xn(this,s,l,c,h)};function pt(s,l){var c,h=s.G;if(h)for(c=[];h;h=h.G)c.push(h);if(s=s.M,h=l.type||l,typeof l=="string")l=new E(l,s);else if(l instanceof E)l.target=l.target||s;else{var I=l;l=new E(h,s),un(l,I)}I=!0;let S,D;if(c)for(D=c.length-1;D>=0;D--)S=l.g=c[D],I=Wt(S,h,!0,l)&&I;if(S=l.g=s,I=Wt(S,h,!0,l)&&I,I=Wt(S,h,!1,l)&&I,c)for(D=0;D<c.length;D++)S=l.g=c[D],I=Wt(S,h,!1,l)&&I}dt.prototype.N=function(){if(dt.Z.N.call(this),this.i){var s=this.i;for(const l in s.g){const c=s.g[l];for(let h=0;h<c.length;h++)Gt(c[h]);delete s.g[l],s.h--}}this.G=null},dt.prototype.J=function(s,l,c,h){return this.i.add(String(s),l,!1,c,h)},dt.prototype.K=function(s,l,c,h){return this.i.add(String(s),l,!0,c,h)};function Wt(s,l,c,h){if(l=s.i.g[String(l)],!l)return!0;l=l.concat();let I=!0;for(let S=0;S<l.length;++S){const D=l[S];if(D&&!D.da&&D.capture==c){const G=D.listener,ft=D.ha||D.src;D.fa&&ye(s.i,D),I=G.call(ft,h)!==!1&&I}}return I&&!h.defaultPrevented}function Jr(s,l){if(typeof s!="function")if(s&&typeof s.handleEvent=="function")s=f(s.handleEvent,s);else throw Error("Invalid listener argument");return Number(l)>2147483647?-1:a.setTimeout(s,l||0)}function Zn(s){s.g=Jr(()=>{s.g=null,s.i&&(s.i=!1,Zn(s))},s.l);const l=s.h;s.h=null,s.m.apply(null,l)}class Zr extends T{constructor(l,c){super(),this.m=l,this.l=c,this.h=null,this.i=!1,this.g=null}j(l){this.h=arguments,this.g?this.i=!0:Zn(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ee(s){T.call(this),this.h=s,this.g={}}A(Ee,T);var tr=[];function er(s){Kt(s.g,function(l,c){this.g.hasOwnProperty(c)&&dn(l)},s),s.g={}}Ee.prototype.N=function(){Ee.Z.N.call(this),er(this)},Ee.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var N=a.JSON.stringify,y=a.JSON.parse,V=class{stringify(s){return a.JSON.stringify(s,void 0)}parse(s){return a.JSON.parse(s,void 0)}};function k(){}function M(){}var Rt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ot(){E.call(this,"d")}A(Ot,E);function Nt(){E.call(this,"c")}A(Nt,E);var kt={},nr=null;function ve(){return nr=nr||new dt}kt.Ia="serverreachability";function rt(s){E.call(this,kt.Ia,s)}A(rt,E);function Te(s){const l=ve();pt(l,new rt(l))}kt.STAT_EVENT="statevent";function Le(s,l){E.call(this,kt.STAT_EVENT,s),this.stat=l}A(Le,E);function lt(s){const l=ve();pt(l,new Le(l,s))}kt.Ja="timingevent";function Ti(s,l){E.call(this,kt.Ja,s),this.size=l}A(Ti,E);function mn(s,l){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){s()},l)}function pn(){this.g=!0}pn.prototype.ua=function(){this.g=!1};function Yl(s,l,c,h,I,S){s.info(function(){if(s.g)if(S){var D="",G=S.split("&");for(let J=0;J<G.length;J++){var ft=G[J].split("=");if(ft.length>1){const yt=ft[0];ft=ft[1];const xt=yt.split("_");D=xt.length>=2&&xt[1]=="type"?D+(yt+"="+ft+"&"):D+(yt+"=redacted&")}}}else D=null;else D=S;return"XMLHTTP REQ ("+h+") [attempt "+I+"]: "+l+`
`+c+`
`+D})}function Xl(s,l,c,h,I,S,D){s.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+I+"]: "+l+`
`+c+`
`+S+" "+D})}function xe(s,l,c,h){s.info(function(){return"XMLHTTP TEXT ("+l+"): "+Zl(s,c)+(h?" "+h:"")})}function Jl(s,l){s.info(function(){return"TIMEOUT: "+l})}pn.prototype.info=function(){};function Zl(s,l){if(!s.g)return l;if(!l)return null;try{const S=JSON.parse(l);if(S){for(s=0;s<S.length;s++)if(Array.isArray(S[s])){var c=S[s];if(!(c.length<2)){var h=c[1];if(Array.isArray(h)&&!(h.length<1)){var I=h[0];if(I!="noop"&&I!="stop"&&I!="close")for(let D=1;D<h.length;D++)h[D]=""}}}}return N(S)}catch{return l}}var rr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},wi={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ii;function ts(){}A(ts,k),ts.prototype.g=function(){return new XMLHttpRequest},Ii=new ts;function yn(s){return encodeURIComponent(String(s))}function tc(s){var l=1;s=s.split(":");const c=[];for(;l>0&&s.length;)c.push(s.shift()),l--;return s.length&&c.push(s.join(":")),c}function $t(s,l,c,h){this.j=s,this.i=l,this.l=c,this.S=h||1,this.V=new Ee(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ai}function Ai(){this.i=null,this.g="",this.h=!1}var Si={},es={};function ns(s,l,c){s.M=1,s.A=ir(Lt(l)),s.u=c,s.R=!0,bi(s,null)}function bi(s,l){s.F=Date.now(),sr(s),s.B=Lt(s.A);var c=s.B,h=s.S;Array.isArray(h)||(h=[String(h)]),Bi(c.i,"t",h),s.C=0,c=s.j.L,s.h=new Ai,s.g=ro(s.j,c?l:null,!s.u),s.P>0&&(s.O=new Zr(f(s.Y,s,s.g),s.P)),l=s.V,c=s.g,h=s.ba;var I="readystatechange";Array.isArray(I)||(I&&(tr[0]=I.toString()),I=tr);for(let S=0;S<I.length;S++){const D=_e(c,I[S],h||l.handleEvent,!1,l.h||l);if(!D)break;l.g[D.key]=D}l=s.J?ln(s.J):{},s.u?(s.v||(s.v="POST"),l["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.B,s.v,s.u,l)):(s.v="GET",s.g.ea(s.B,s.v,null,l)),Te(),Yl(s.i,s.v,s.B,s.l,s.S,s.u)}$t.prototype.ba=function(s){s=s.target;const l=this.O;l&&Jt(s)==3?l.j():this.Y(s)},$t.prototype.Y=function(s){try{if(s==this.g)t:{const G=Jt(this.g),ft=this.g.ya(),J=this.g.ca();if(!(G<3)&&(G!=3||this.g&&(this.h.h||this.g.la()||Ki(this.g)))){this.K||G!=4||ft==7||(ft==8||J<=0?Te(3):Te(2)),rs(this);var l=this.g.ca();this.X=l;var c=ec(this);if(this.o=l==200,Xl(this.i,this.v,this.B,this.l,this.S,G,l),this.o){if(this.U&&!this.L){e:{if(this.g){var h,I=this.g;if((h=I.g?I.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(h)){var S=h;break e}}S=null}if(s=S)xe(this.i,this.l,s,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ss(this,s);else{this.o=!1,this.m=3,lt(12),we(this),_n(this);break t}}if(this.R){s=!0;let yt;for(;!this.K&&this.C<c.length;)if(yt=nc(this,c),yt==es){G==4&&(this.m=4,lt(14),s=!1),xe(this.i,this.l,null,"[Incomplete Response]");break}else if(yt==Si){this.m=4,lt(15),xe(this.i,this.l,c,"[Invalid Chunk]"),s=!1;break}else xe(this.i,this.l,yt,null),ss(this,yt);if(Ri(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),G!=4||c.length!=0||this.h.h||(this.m=1,lt(16),s=!1),this.o=this.o&&s,!s)xe(this.i,this.l,c,"[Invalid Chunked Response]"),we(this),_n(this);else if(c.length>0&&!this.W){this.W=!0;var D=this.j;D.g==this&&D.aa&&!D.P&&(D.j.info("Great, no buffering proxy detected. Bytes received: "+c.length),ds(D),D.P=!0,lt(11))}}else xe(this.i,this.l,c,null),ss(this,c);G==4&&we(this),this.o&&!this.K&&(G==4?Zi(this.j,this):(this.o=!1,sr(this)))}else pc(this.g),l==400&&c.indexOf("Unknown SID")>0?(this.m=3,lt(12)):(this.m=0,lt(13)),we(this),_n(this)}}}catch{}};function ec(s){if(!Ri(s))return s.g.la();const l=Ki(s.g);if(l==="")return"";let c="";const h=l.length,I=Jt(s.g)==4;if(!s.h.i){if(typeof TextDecoder>"u")return we(s),_n(s),"";s.h.i=new a.TextDecoder}for(let S=0;S<h;S++)s.h.h=!0,c+=s.h.i.decode(l[S],{stream:!(I&&S==h-1)});return l.length=0,s.h.g+=c,s.C=0,s.h.g}function Ri(s){return s.g?s.v=="GET"&&s.M!=2&&s.j.Aa:!1}function nc(s,l){var c=s.C,h=l.indexOf(`
`,c);return h==-1?es:(c=Number(l.substring(c,h)),isNaN(c)?Si:(h+=1,h+c>l.length?es:(l=l.slice(h,h+c),s.C=h+c,l)))}$t.prototype.cancel=function(){this.K=!0,we(this)};function sr(s){s.T=Date.now()+s.H,Ci(s,s.H)}function Ci(s,l){if(s.D!=null)throw Error("WatchDog timer not null");s.D=mn(f(s.aa,s),l)}function rs(s){s.D&&(a.clearTimeout(s.D),s.D=null)}$t.prototype.aa=function(){this.D=null;const s=Date.now();s-this.T>=0?(Jl(this.i,this.B),this.M!=2&&(Te(),lt(17)),we(this),this.m=2,_n(this)):Ci(this,this.T-s)};function _n(s){s.j.I==0||s.K||Zi(s.j,s)}function we(s){rs(s);var l=s.O;l&&typeof l.dispose=="function"&&l.dispose(),s.O=null,er(s.V),s.g&&(l=s.g,s.g=null,l.abort(),l.dispose())}function ss(s,l){try{var c=s.j;if(c.I!=0&&(c.g==s||is(c.h,s))){if(!s.L&&is(c.h,s)&&c.I==3){try{var h=c.Ba.g.parse(l)}catch{h=null}if(Array.isArray(h)&&h.length==3){var I=h;if(I[0]==0){t:if(!c.v){if(c.g)if(c.g.F+3e3<s.F)ur(c),lr(c);else break t;hs(c),lt(18)}}else c.xa=I[1],0<c.xa-c.K&&I[2]<37500&&c.F&&c.A==0&&!c.C&&(c.C=mn(f(c.Va,c),6e3));Di(c.h)<=1&&c.ta&&(c.ta=void 0)}else Ae(c,11)}else if((s.L||c.g==s)&&ur(c),!p(l))for(I=c.Ba.g.parse(l),l=0;l<I.length;l++){let J=I[l];const yt=J[0];if(!(yt<=c.K))if(c.K=yt,J=J[1],c.I==2)if(J[0]=="c"){c.M=J[1],c.ba=J[2];const xt=J[3];xt!=null&&(c.ka=xt,c.j.info("VER="+c.ka));const Se=J[4];Se!=null&&(c.za=Se,c.j.info("SVER="+c.za));const Zt=J[5];Zt!=null&&typeof Zt=="number"&&Zt>0&&(h=1.5*Zt,c.O=h,c.j.info("backChannelRequestTimeoutMs_="+h)),h=c;const te=s.g;if(te){const dr=te.g?te.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(dr){var S=h.h;S.g||dr.indexOf("spdy")==-1&&dr.indexOf("quic")==-1&&dr.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(os(S,S.h),S.h=null))}if(h.G){const fs=te.g?te.g.getResponseHeader("X-HTTP-Session-Id"):null;fs&&(h.wa=fs,Z(h.J,h.G,fs))}}c.I=3,c.l&&c.l.ra(),c.aa&&(c.T=Date.now()-s.F,c.j.info("Handshake RTT: "+c.T+"ms")),h=c;var D=s;if(h.na=no(h,h.L?h.ba:null,h.W),D.L){Ni(h.h,D);var G=D,ft=h.O;ft&&(G.H=ft),G.D&&(rs(G),sr(G)),h.g=D}else Xi(h);c.i.length>0&&cr(c)}else J[0]!="stop"&&J[0]!="close"||Ae(c,7);else c.I==3&&(J[0]=="stop"||J[0]=="close"?J[0]=="stop"?Ae(c,7):us(c):J[0]!="noop"&&c.l&&c.l.qa(J),c.A=0)}}Te(4)}catch{}}var rc=class{constructor(s,l){this.g=s,this.map=l}};function Pi(s){this.l=s||10,a.PerformanceNavigationTiming?(s=a.performance.getEntriesByType("navigation"),s=s.length>0&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Vi(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function Di(s){return s.h?1:s.g?s.g.size:0}function is(s,l){return s.h?s.h==l:s.g?s.g.has(l):!1}function os(s,l){s.g?s.g.add(l):s.h=l}function Ni(s,l){s.h&&s.h==l?s.h=null:s.g&&s.g.has(l)&&s.g.delete(l)}Pi.prototype.cancel=function(){if(this.i=ki(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const s of this.g.values())s.cancel();this.g.clear()}};function ki(s){if(s.h!=null)return s.i.concat(s.h.G);if(s.g!=null&&s.g.size!==0){let l=s.i;for(const c of s.g.values())l=l.concat(c.G);return l}return C(s.i)}var Oi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function sc(s,l){if(s){s=s.split("&");for(let c=0;c<s.length;c++){const h=s[c].indexOf("=");let I,S=null;h>=0?(I=s[c].substring(0,h),S=s[c].substring(h+1)):I=s[c],l(I,S?decodeURIComponent(S.replace(/\+/g," ")):"")}}}function Yt(s){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let l;s instanceof Yt?(this.l=s.l,En(this,s.j),this.o=s.o,this.g=s.g,vn(this,s.u),this.h=s.h,as(this,Ui(s.i)),this.m=s.m):s&&(l=String(s).match(Oi))?(this.l=!1,En(this,l[1]||"",!0),this.o=Tn(l[2]||""),this.g=Tn(l[3]||"",!0),vn(this,l[4]),this.h=Tn(l[5]||"",!0),as(this,l[6]||"",!0),this.m=Tn(l[7]||"")):(this.l=!1,this.i=new In(null,this.l))}Yt.prototype.toString=function(){const s=[];var l=this.j;l&&s.push(wn(l,Li,!0),":");var c=this.g;return(c||l=="file")&&(s.push("//"),(l=this.o)&&s.push(wn(l,Li,!0),"@"),s.push(yn(c).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.u,c!=null&&s.push(":",String(c))),(c=this.h)&&(this.g&&c.charAt(0)!="/"&&s.push("/"),s.push(wn(c,c.charAt(0)=="/"?ac:oc,!0))),(c=this.i.toString())&&s.push("?",c),(c=this.m)&&s.push("#",wn(c,cc)),s.join("")},Yt.prototype.resolve=function(s){const l=Lt(this);let c=!!s.j;c?En(l,s.j):c=!!s.o,c?l.o=s.o:c=!!s.g,c?l.g=s.g:c=s.u!=null;var h=s.h;if(c)vn(l,s.u);else if(c=!!s.h){if(h.charAt(0)!="/")if(this.g&&!this.h)h="/"+h;else{var I=l.h.lastIndexOf("/");I!=-1&&(h=l.h.slice(0,I+1)+h)}if(I=h,I==".."||I==".")h="";else if(I.indexOf("./")!=-1||I.indexOf("/.")!=-1){h=I.lastIndexOf("/",0)==0,I=I.split("/");const S=[];for(let D=0;D<I.length;){const G=I[D++];G=="."?h&&D==I.length&&S.push(""):G==".."?((S.length>1||S.length==1&&S[0]!="")&&S.pop(),h&&D==I.length&&S.push("")):(S.push(G),h=!0)}h=S.join("/")}else h=I}return c?l.h=h:c=s.i.toString()!=="",c?as(l,Ui(s.i)):c=!!s.m,c&&(l.m=s.m),l};function Lt(s){return new Yt(s)}function En(s,l,c){s.j=c?Tn(l,!0):l,s.j&&(s.j=s.j.replace(/:$/,""))}function vn(s,l){if(l){if(l=Number(l),isNaN(l)||l<0)throw Error("Bad port number "+l);s.u=l}else s.u=null}function as(s,l,c){l instanceof In?(s.i=l,uc(s.i,s.l)):(c||(l=wn(l,lc)),s.i=new In(l,s.l))}function Z(s,l,c){s.i.set(l,c)}function ir(s){return Z(s,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),s}function Tn(s,l){return s?l?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function wn(s,l,c){return typeof s=="string"?(s=encodeURI(s).replace(l,ic),c&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function ic(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var Li=/[#\/\?@]/g,oc=/[#\?:]/g,ac=/[#\?]/g,lc=/[#\?@]/g,cc=/#/g;function In(s,l){this.h=this.g=null,this.i=s||null,this.j=!!l}function Ie(s){s.g||(s.g=new Map,s.h=0,s.i&&sc(s.i,function(l,c){s.add(decodeURIComponent(l.replace(/\+/g," ")),c)}))}r=In.prototype,r.add=function(s,l){Ie(this),this.i=null,s=Me(this,s);let c=this.g.get(s);return c||this.g.set(s,c=[]),c.push(l),this.h+=1,this};function xi(s,l){Ie(s),l=Me(s,l),s.g.has(l)&&(s.i=null,s.h-=s.g.get(l).length,s.g.delete(l))}function Mi(s,l){return Ie(s),l=Me(s,l),s.g.has(l)}r.forEach=function(s,l){Ie(this),this.g.forEach(function(c,h){c.forEach(function(I){s.call(l,I,h,this)},this)},this)};function Fi(s,l){Ie(s);let c=[];if(typeof l=="string")Mi(s,l)&&(c=c.concat(s.g.get(Me(s,l))));else for(s=Array.from(s.g.values()),l=0;l<s.length;l++)c=c.concat(s[l]);return c}r.set=function(s,l){return Ie(this),this.i=null,s=Me(this,s),Mi(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[l]),this.h+=1,this},r.get=function(s,l){return s?(s=Fi(this,s),s.length>0?String(s[0]):l):l};function Bi(s,l,c){xi(s,l),c.length>0&&(s.i=null,s.g.set(Me(s,l),C(c)),s.h+=c.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const s=[],l=Array.from(this.g.keys());for(let h=0;h<l.length;h++){var c=l[h];const I=yn(c);c=Fi(this,c);for(let S=0;S<c.length;S++){let D=I;c[S]!==""&&(D+="="+yn(c[S])),s.push(D)}}return this.i=s.join("&")};function Ui(s){const l=new In;return l.i=s.i,s.g&&(l.g=new Map(s.g),l.h=s.h),l}function Me(s,l){return l=String(l),s.j&&(l=l.toLowerCase()),l}function uc(s,l){l&&!s.j&&(Ie(s),s.i=null,s.g.forEach(function(c,h){const I=h.toLowerCase();h!=I&&(xi(this,h),Bi(this,I,c))},s)),s.j=l}function hc(s,l){const c=new pn;if(a.Image){const h=new Image;h.onload=_(Xt,c,"TestLoadImage: loaded",!0,l,h),h.onerror=_(Xt,c,"TestLoadImage: error",!1,l,h),h.onabort=_(Xt,c,"TestLoadImage: abort",!1,l,h),h.ontimeout=_(Xt,c,"TestLoadImage: timeout",!1,l,h),a.setTimeout(function(){h.ontimeout&&h.ontimeout()},1e4),h.src=s}else l(!1)}function dc(s,l){const c=new pn,h=new AbortController,I=setTimeout(()=>{h.abort(),Xt(c,"TestPingServer: timeout",!1,l)},1e4);fetch(s,{signal:h.signal}).then(S=>{clearTimeout(I),S.ok?Xt(c,"TestPingServer: ok",!0,l):Xt(c,"TestPingServer: server error",!1,l)}).catch(()=>{clearTimeout(I),Xt(c,"TestPingServer: error",!1,l)})}function Xt(s,l,c,h,I){try{I&&(I.onload=null,I.onerror=null,I.onabort=null,I.ontimeout=null),h(c)}catch{}}function fc(){this.g=new V}function ls(s){this.i=s.Sb||null,this.h=s.ab||!1}A(ls,k),ls.prototype.g=function(){return new or(this.i,this.h)};function or(s,l){dt.call(this),this.H=s,this.o=l,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}A(or,dt),r=or.prototype,r.open=function(s,l){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=s,this.D=l,this.readyState=1,Sn(this)},r.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const l={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};s&&(l.body=s),(this.H||a).fetch(new Request(this.D,l)).then(this.Pa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,An(this)),this.readyState=0},r.Pa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,Sn(this)),this.g&&(this.readyState=3,Sn(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;qi(this)}else s.text().then(this.Oa.bind(this),this.ga.bind(this))};function qi(s){s.j.read().then(s.Ma.bind(s)).catch(s.ga.bind(s))}r.Ma=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var l=s.value?s.value:new Uint8Array(0);(l=this.B.decode(l,{stream:!s.done}))&&(this.response=this.responseText+=l)}s.done?An(this):Sn(this),this.readyState==3&&qi(this)}},r.Oa=function(s){this.g&&(this.response=this.responseText=s,An(this))},r.Na=function(s){this.g&&(this.response=s,An(this))},r.ga=function(){this.g&&An(this)};function An(s){s.readyState=4,s.l=null,s.j=null,s.B=null,Sn(s)}r.setRequestHeader=function(s,l){this.A.append(s,l)},r.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const s=[],l=this.h.entries();for(var c=l.next();!c.done;)c=c.value,s.push(c[0]+": "+c[1]),c=l.next();return s.join(`\r
`)};function Sn(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(or.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function ji(s){let l="";return Kt(s,function(c,h){l+=h,l+=":",l+=c,l+=`\r
`}),l}function cs(s,l,c){t:{for(h in c){var h=!1;break t}h=!0}h||(c=ji(c),typeof s=="string"?c!=null&&yn(c):Z(s,l,c))}function nt(s){dt.call(this),this.headers=new Map,this.L=s||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}A(nt,dt);var gc=/^https?$/i,mc=["POST","PUT"];r=nt.prototype,r.Fa=function(s){this.H=s},r.ea=function(s,l,c,h){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);l=l?l.toUpperCase():"GET",this.D=s,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ii.g(),this.g.onreadystatechange=b(f(this.Ca,this));try{this.B=!0,this.g.open(l,String(s),!0),this.B=!1}catch(S){Gi(this,S);return}if(s=c||"",c=new Map(this.headers),h)if(Object.getPrototypeOf(h)===Object.prototype)for(var I in h)c.set(I,h[I]);else if(typeof h.keys=="function"&&typeof h.get=="function")for(const S of h.keys())c.set(S,h.get(S));else throw Error("Unknown input type for opt_headers: "+String(h));h=Array.from(c.keys()).find(S=>S.toLowerCase()=="content-type"),I=a.FormData&&s instanceof a.FormData,!(Array.prototype.indexOf.call(mc,l,void 0)>=0)||h||I||c.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[S,D]of c)this.g.setRequestHeader(S,D);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(s),this.v=!1}catch(S){Gi(this,S)}};function Gi(s,l){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=l,s.o=5,zi(s),ar(s)}function zi(s){s.A||(s.A=!0,pt(s,"complete"),pt(s,"error"))}r.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=s||7,pt(this,"complete"),pt(this,"abort"),ar(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ar(this,!0)),nt.Z.N.call(this)},r.Ca=function(){this.u||(this.B||this.v||this.j?Hi(this):this.Xa())},r.Xa=function(){Hi(this)};function Hi(s){if(s.h&&typeof o<"u"){if(s.v&&Jt(s)==4)setTimeout(s.Ca.bind(s),0);else if(pt(s,"readystatechange"),Jt(s)==4){s.h=!1;try{const S=s.ca();t:switch(S){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var l=!0;break t;default:l=!1}var c;if(!(c=l)){var h;if(h=S===0){let D=String(s.D).match(Oi)[1]||null;!D&&a.self&&a.self.location&&(D=a.self.location.protocol.slice(0,-1)),h=!gc.test(D?D.toLowerCase():"")}c=h}if(c)pt(s,"complete"),pt(s,"success");else{s.o=6;try{var I=Jt(s)>2?s.g.statusText:""}catch{I=""}s.l=I+" ["+s.ca()+"]",zi(s)}}finally{ar(s)}}}}function ar(s,l){if(s.g){s.m&&(clearTimeout(s.m),s.m=null);const c=s.g;s.g=null,l||pt(s,"ready");try{c.onreadystatechange=null}catch{}}}r.isActive=function(){return!!this.g};function Jt(s){return s.g?s.g.readyState:0}r.ca=function(){try{return Jt(this)>2?this.g.status:-1}catch{return-1}},r.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.La=function(s){if(this.g){var l=this.g.responseText;return s&&l.indexOf(s)==0&&(l=l.substring(s.length)),y(l)}};function Ki(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.F){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function pc(s){const l={};s=(s.g&&Jt(s)>=2&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let h=0;h<s.length;h++){if(p(s[h]))continue;var c=tc(s[h]);const I=c[0];if(c=c[1],typeof c!="string")continue;c=c.trim();const S=l[I]||[];l[I]=S,S.push(c)}Yn(l,function(h){return h.join(", ")})}r.ya=function(){return this.o},r.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function bn(s,l,c){return c&&c.internalChannelParams&&c.internalChannelParams[s]||l}function Qi(s){this.za=0,this.i=[],this.j=new pn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=bn("failFast",!1,s),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=bn("baseRetryDelayMs",5e3,s),this.Za=bn("retryDelaySeedMs",1e4,s),this.Ta=bn("forwardChannelMaxRetries",2,s),this.va=bn("forwardChannelRequestTimeoutMs",2e4,s),this.ma=s&&s.xmlHttpFactory||void 0,this.Ua=s&&s.Rb||void 0,this.Aa=s&&s.useFetchStreams||!1,this.O=void 0,this.L=s&&s.supportsCrossDomainXhr||!1,this.M="",this.h=new Pi(s&&s.concurrentRequestLimit),this.Ba=new fc,this.S=s&&s.fastHandshake||!1,this.R=s&&s.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=s&&s.Pb||!1,s&&s.ua&&this.j.ua(),s&&s.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&s&&s.detectBufferingProxy||!1,this.ia=void 0,s&&s.longPollingTimeout&&s.longPollingTimeout>0&&(this.ia=s.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}r=Qi.prototype,r.ka=8,r.I=1,r.connect=function(s,l,c,h){lt(0),this.W=s,this.H=l||{},c&&h!==void 0&&(this.H.OSID=c,this.H.OAID=h),this.F=this.X,this.J=no(this,null,this.W),cr(this)};function us(s){if(Wi(s),s.I==3){var l=s.V++,c=Lt(s.J);if(Z(c,"SID",s.M),Z(c,"RID",l),Z(c,"TYPE","terminate"),Rn(s,c),l=new $t(s,s.j,l),l.M=2,l.A=ir(Lt(c)),c=!1,a.navigator&&a.navigator.sendBeacon)try{c=a.navigator.sendBeacon(l.A.toString(),"")}catch{}!c&&a.Image&&(new Image().src=l.A,c=!0),c||(l.g=ro(l.j,null),l.g.ea(l.A)),l.F=Date.now(),sr(l)}eo(s)}function lr(s){s.g&&(ds(s),s.g.cancel(),s.g=null)}function Wi(s){lr(s),s.v&&(a.clearTimeout(s.v),s.v=null),ur(s),s.h.cancel(),s.m&&(typeof s.m=="number"&&a.clearTimeout(s.m),s.m=null)}function cr(s){if(!Vi(s.h)&&!s.m){s.m=!0;var l=s.Ea;wt||m(),ot||(wt(),ot=!0),v.add(l,s),s.D=0}}function yc(s,l){return Di(s.h)>=s.h.j-(s.m?1:0)?!1:s.m?(s.i=l.G.concat(s.i),!0):s.I==1||s.I==2||s.D>=(s.Sa?0:s.Ta)?!1:(s.m=mn(f(s.Ea,s,l),to(s,s.D)),s.D++,!0)}r.Ea=function(s){if(this.m)if(this.m=null,this.I==1){if(!s){this.V=Math.floor(Math.random()*1e5),s=this.V++;const I=new $t(this,this.j,s);let S=this.o;if(this.U&&(S?(S=ln(S),un(S,this.U)):S=this.U),this.u!==null||this.R||(I.J=S,S=null),this.S)t:{for(var l=0,c=0;c<this.i.length;c++){e:{var h=this.i[c];if("__data__"in h.map&&(h=h.map.__data__,typeof h=="string")){h=h.length;break e}h=void 0}if(h===void 0)break;if(l+=h,l>4096){l=c;break t}if(l===4096||c===this.i.length-1){l=c+1;break t}}l=1e3}else l=1e3;l=Yi(this,I,l),c=Lt(this.J),Z(c,"RID",s),Z(c,"CVER",22),this.G&&Z(c,"X-HTTP-Session-Id",this.G),Rn(this,c),S&&(this.R?l="headers="+yn(ji(S))+"&"+l:this.u&&cs(c,this.u,S)),os(this.h,I),this.Ra&&Z(c,"TYPE","init"),this.S?(Z(c,"$req",l),Z(c,"SID","null"),I.U=!0,ns(I,c,null)):ns(I,c,l),this.I=2}}else this.I==3&&(s?$i(this,s):this.i.length==0||Vi(this.h)||$i(this))};function $i(s,l){var c;l?c=l.l:c=s.V++;const h=Lt(s.J);Z(h,"SID",s.M),Z(h,"RID",c),Z(h,"AID",s.K),Rn(s,h),s.u&&s.o&&cs(h,s.u,s.o),c=new $t(s,s.j,c,s.D+1),s.u===null&&(c.J=s.o),l&&(s.i=l.G.concat(s.i)),l=Yi(s,c,1e3),c.H=Math.round(s.va*.5)+Math.round(s.va*.5*Math.random()),os(s.h,c),ns(c,h,l)}function Rn(s,l){s.H&&Kt(s.H,function(c,h){Z(l,h,c)}),s.l&&Kt({},function(c,h){Z(l,h,c)})}function Yi(s,l,c){c=Math.min(s.i.length,c);const h=s.l?f(s.l.Ka,s.l,s):null;t:{var I=s.i;let G=-1;for(;;){const ft=["count="+c];G==-1?c>0?(G=I[0].g,ft.push("ofs="+G)):G=0:ft.push("ofs="+G);let J=!0;for(let yt=0;yt<c;yt++){var S=I[yt].g;const xt=I[yt].map;if(S-=G,S<0)G=Math.max(0,I[yt].g-100),J=!1;else try{S="req"+S+"_"||"";try{var D=xt instanceof Map?xt:Object.entries(xt);for(const[Se,Zt]of D){let te=Zt;u(Zt)&&(te=N(Zt)),ft.push(S+Se+"="+encodeURIComponent(te))}}catch(Se){throw ft.push(S+"type="+encodeURIComponent("_badmap")),Se}}catch{h&&h(xt)}}if(J){D=ft.join("&");break t}}D=void 0}return s=s.i.splice(0,c),l.G=s,D}function Xi(s){if(!s.g&&!s.v){s.Y=1;var l=s.Da;wt||m(),ot||(wt(),ot=!0),v.add(l,s),s.A=0}}function hs(s){return s.g||s.v||s.A>=3?!1:(s.Y++,s.v=mn(f(s.Da,s),to(s,s.A)),s.A++,!0)}r.Da=function(){if(this.v=null,Ji(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var s=4*this.T;this.j.info("BP detection timer enabled: "+s),this.B=mn(f(this.Wa,this),s)}},r.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,lt(10),lr(this),Ji(this))};function ds(s){s.B!=null&&(a.clearTimeout(s.B),s.B=null)}function Ji(s){s.g=new $t(s,s.j,"rpc",s.Y),s.u===null&&(s.g.J=s.o),s.g.P=0;var l=Lt(s.na);Z(l,"RID","rpc"),Z(l,"SID",s.M),Z(l,"AID",s.K),Z(l,"CI",s.F?"0":"1"),!s.F&&s.ia&&Z(l,"TO",s.ia),Z(l,"TYPE","xmlhttp"),Rn(s,l),s.u&&s.o&&cs(l,s.u,s.o),s.O&&(s.g.H=s.O);var c=s.g;s=s.ba,c.M=1,c.A=ir(Lt(l)),c.u=null,c.R=!0,bi(c,s)}r.Va=function(){this.C!=null&&(this.C=null,lr(this),hs(this),lt(19))};function ur(s){s.C!=null&&(a.clearTimeout(s.C),s.C=null)}function Zi(s,l){var c=null;if(s.g==l){ur(s),ds(s),s.g=null;var h=2}else if(is(s.h,l))c=l.G,Ni(s.h,l),h=1;else return;if(s.I!=0){if(l.o)if(h==1){c=l.u?l.u.length:0,l=Date.now()-l.F;var I=s.D;h=ve(),pt(h,new Ti(h,c)),cr(s)}else Xi(s);else if(I=l.m,I==3||I==0&&l.X>0||!(h==1&&yc(s,l)||h==2&&hs(s)))switch(c&&c.length>0&&(l=s.h,l.i=l.i.concat(c)),I){case 1:Ae(s,5);break;case 4:Ae(s,10);break;case 3:Ae(s,6);break;default:Ae(s,2)}}}function to(s,l){let c=s.Qa+Math.floor(Math.random()*s.Za);return s.isActive()||(c*=2),c*l}function Ae(s,l){if(s.j.info("Error code "+l),l==2){var c=f(s.bb,s),h=s.Ua;const I=!h;h=new Yt(h||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||En(h,"https"),ir(h),I?hc(h.toString(),c):dc(h.toString(),c)}else lt(2);s.I=0,s.l&&s.l.pa(l),eo(s),Wi(s)}r.bb=function(s){s?(this.j.info("Successfully pinged google.com"),lt(2)):(this.j.info("Failed to ping google.com"),lt(1))};function eo(s){if(s.I=0,s.ja=[],s.l){const l=ki(s.h);(l.length!=0||s.i.length!=0)&&(B(s.ja,l),B(s.ja,s.i),s.h.i.length=0,C(s.i),s.i.length=0),s.l.oa()}}function no(s,l,c){var h=c instanceof Yt?Lt(c):new Yt(c);if(h.g!="")l&&(h.g=l+"."+h.g),vn(h,h.u);else{var I=a.location;h=I.protocol,l=l?l+"."+I.hostname:I.hostname,I=+I.port;const S=new Yt(null);h&&En(S,h),l&&(S.g=l),I&&vn(S,I),c&&(S.h=c),h=S}return c=s.G,l=s.wa,c&&l&&Z(h,c,l),Z(h,"VER",s.ka),Rn(s,h),h}function ro(s,l,c){if(l&&!s.L)throw Error("Can't create secondary domain capable XhrIo object.");return l=s.Aa&&!s.ma?new nt(new ls({ab:c})):new nt(s.ma),l.Fa(s.L),l}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function so(){}r=so.prototype,r.ra=function(){},r.qa=function(){},r.pa=function(){},r.oa=function(){},r.isActive=function(){return!0},r.Ka=function(){};function hr(){}hr.prototype.g=function(s,l){return new Vt(s,l)};function Vt(s,l){dt.call(this),this.g=new Qi(l),this.l=s,this.h=l&&l.messageUrlParams||null,s=l&&l.messageHeaders||null,l&&l.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=l&&l.initMessageHeaders||null,l&&l.messageContentType&&(s?s["X-WebChannel-Content-Type"]=l.messageContentType:s={"X-WebChannel-Content-Type":l.messageContentType}),l&&l.sa&&(s?s["X-WebChannel-Client-Profile"]=l.sa:s={"X-WebChannel-Client-Profile":l.sa}),this.g.U=s,(s=l&&l.Qb)&&!p(s)&&(this.g.u=s),this.A=l&&l.supportsCrossDomainXhr||!1,this.v=l&&l.sendRawJson||!1,(l=l&&l.httpSessionIdParam)&&!p(l)&&(this.g.G=l,s=this.h,s!==null&&l in s&&(s=this.h,l in s&&delete s[l])),this.j=new Fe(this)}A(Vt,dt),Vt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Vt.prototype.close=function(){us(this.g)},Vt.prototype.o=function(s){var l=this.g;if(typeof s=="string"){var c={};c.__data__=s,s=c}else this.v&&(c={},c.__data__=N(s),s=c);l.i.push(new rc(l.Ya++,s)),l.I==3&&cr(l)},Vt.prototype.N=function(){this.g.l=null,delete this.j,us(this.g),delete this.g,Vt.Z.N.call(this)};function io(s){Ot.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var l=s.__sm__;if(l){t:{for(const c in l){s=c;break t}s=void 0}(this.i=s)&&(s=this.i,l=l!==null&&s in l?l[s]:void 0),this.data=l}else this.data=s}A(io,Ot);function oo(){Nt.call(this),this.status=1}A(oo,Nt);function Fe(s){this.g=s}A(Fe,so),Fe.prototype.ra=function(){pt(this.g,"a")},Fe.prototype.qa=function(s){pt(this.g,new io(s))},Fe.prototype.pa=function(s){pt(this.g,new oo)},Fe.prototype.oa=function(){pt(this.g,"b")},hr.prototype.createWebChannel=hr.prototype.g,Vt.prototype.send=Vt.prototype.o,Vt.prototype.open=Vt.prototype.m,Vt.prototype.close=Vt.prototype.close,La=function(){return new hr},Oa=function(){return ve()},ka=kt,Vs={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},rr.NO_ERROR=0,rr.TIMEOUT=8,rr.HTTP_ERROR=6,_r=rr,wi.COMPLETE="complete",Na=wi,M.EventType=Rt,Rt.OPEN="a",Rt.CLOSE="b",Rt.ERROR="c",Rt.MESSAGE="d",dt.prototype.listen=dt.prototype.J,Cn=M,nt.prototype.listenOnce=nt.prototype.K,nt.prototype.getLastError=nt.prototype.Ha,nt.prototype.getLastErrorCode=nt.prototype.ya,nt.prototype.getStatus=nt.prototype.ca,nt.prototype.getResponseJson=nt.prototype.La,nt.prototype.getResponseText=nt.prototype.la,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Fa,Da=nt}).apply(typeof fr<"u"?fr:typeof self<"u"?self:typeof window<"u"?window:{});const vo="@firebase/firestore",To="4.9.3";class At{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}At.UNAUTHENTICATED=new At(null),At.GOOGLE_CREDENTIALS=new At("google-credentials-uid"),At.FIRST_PARTY=new At("first-party-uid"),At.MOCK_USER=new At("mock-user");let en="12.7.0";const Ve=new Aa("@firebase/firestore");function Be(){return Ve.logLevel}function O(r,...t){if(Ve.logLevel<=K.DEBUG){const e=t.map(Xs);Ve.debug(`Firestore (${en}): ${r}`,...e)}}function Ht(r,...t){if(Ve.logLevel<=K.ERROR){const e=t.map(Xs);Ve.error(`Firestore (${en}): ${r}`,...e)}}function Qe(r,...t){if(Ve.logLevel<=K.WARN){const e=t.map(Xs);Ve.warn(`Firestore (${en}): ${r}`,...e)}}function Xs(r){if(typeof r=="string")return r;try{return(function(e){return JSON.stringify(e)})(r)}catch{return r}}function j(r,t,e){let n="Unexpected state";typeof t=="string"?n=t:e=t,xa(r,n,e)}function xa(r,t,e){let n=`FIRESTORE (${en}) INTERNAL ASSERTION FAILED: ${t} (ID: ${r.toString(16)})`;if(e!==void 0)try{n+=" CONTEXT: "+JSON.stringify(e)}catch{n+=" CONTEXT: "+e}throw Ht(n),new Error(n)}function et(r,t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,r||xa(t,i,n)}function Q(r,t){return r}const P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class x extends tn{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class oe{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Ma{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class rh{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(At.UNAUTHENTICATED)))}shutdown(){}}class sh{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class ih{constructor(t){this.t=t,this.currentUser=At.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){et(this.o===void 0,42304);let n=this.i;const i=d=>this.i!==n?(n=this.i,e(d)):Promise.resolve();let o=new oe;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new oe,t.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const d=o;t.enqueueRetryable((async()=>{await d.promise,await i(this.currentUser)}))},u=d=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((d=>u(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?u(d):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new oe)}}),0),a()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((n=>this.i!==t?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(et(typeof n.accessToken=="string",31837,{l:n}),new Ma(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return et(t===null||typeof t=="string",2055,{h:t}),new At(t)}}class oh{constructor(t,e,n){this.P=t,this.T=e,this.I=n,this.type="FirstParty",this.user=At.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class ah{constructor(t,e,n){this.P=t,this.T=e,this.I=n}getToken(){return Promise.resolve(new oh(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(At.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class wo{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class lh{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Uu(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){et(this.o===void 0,3512);const n=o=>{o.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,O("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?e(o.token):Promise.resolve()};this.o=o=>{t.enqueueRetryable((()=>n(o)))};const i=o=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>i(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new wo(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(et(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new wo(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function ch(r){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(r);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let n=0;n<r;n++)e[n]=Math.floor(256*Math.random());return e}class Js{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=ch(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<e&&(n+=t.charAt(i[o]%62))}return n}}function z(r,t){return r<t?-1:r>t?1:0}function Ds(r,t){const e=Math.min(r.length,t.length);for(let n=0;n<e;n++){const i=r.charAt(n),o=t.charAt(n);if(i!==o)return _s(i)===_s(o)?z(i,o):_s(i)?1:-1}return z(r.length,t.length)}const uh=55296,hh=57343;function _s(r){const t=r.charCodeAt(0);return t>=uh&&t<=hh}function We(r,t,e){return r.length===t.length&&r.every(((n,i)=>e(n,t[i])))}const Io="__name__";class Mt{constructor(t,e,n){e===void 0?e=0:e>t.length&&j(637,{offset:e,range:t.length}),n===void 0?n=t.length-e:n>t.length-e&&j(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return Mt.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Mt?t.forEach((n=>{e.push(n)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const o=Mt.compareSegments(t.get(i),e.get(i));if(o!==0)return o}return z(t.length,e.length)}static compareSegments(t,e){const n=Mt.isNumericId(t),i=Mt.isNumericId(e);return n&&!i?-1:!n&&i?1:n&&i?Mt.extractNumericId(t).compare(Mt.extractNumericId(e)):Ds(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return ie.fromString(t.substring(4,t.length-2))}}class tt extends Mt{construct(t,e,n){return new tt(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new x(P.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((i=>i.length>0)))}return new tt(e)}static emptyPath(){return new tt([])}}const dh=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ct extends Mt{construct(t,e,n){return new Ct(t,e,n)}static isValidIdentifier(t){return dh.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ct.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Io}static keyField(){return new Ct([Io])}static fromServerFormat(t){const e=[];let n="",i=0;const o=()=>{if(n.length===0)throw new x(P.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let a=!1;for(;i<t.length;){const u=t[i];if(u==="\\"){if(i+1===t.length)throw new x(P.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const d=t[i+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new x(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=d,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(n+=u,i++):(o(),i++)}if(o(),a)throw new x(P.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ct(e)}static emptyPath(){return new Ct([])}}class F{constructor(t){this.path=t}static fromPath(t){return new F(tt.fromString(t))}static fromName(t){return new F(tt.fromString(t).popFirst(5))}static empty(){return new F(tt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&tt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return tt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new F(new tt(t.slice()))}}function Fa(r,t,e){if(!e)throw new x(P.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${t}.`)}function fh(r,t,e,n){if(t===!0&&n===!0)throw new x(P.INVALID_ARGUMENT,`${r} and ${e} cannot be used together.`)}function Ao(r){if(!F.isDocumentKey(r))throw new x(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function So(r){if(F.isDocumentKey(r))throw new x(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function gh(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function mh(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const t=(function(n){return n.constructor?n.constructor.name:null})(r);return t?`a custom ${t} object`:"an object"}}return typeof r=="function"?"a function":j(12329,{type:typeof r})}function Bn(r,t){if("_delegate"in r&&(r=r._delegate),!(r instanceof t)){if(t.name===r.constructor.name)throw new x(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=mh(r);throw new x(P.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return r}function ht(r,t){const e={typeString:r};return t&&(e.value=t),e}function zn(r,t){if(!gh(r))throw new x(P.INVALID_ARGUMENT,"JSON must be an object");let e;for(const n in t)if(t[n]){const i=t[n].typeString,o="value"in t[n]?{value:t[n].value}:void 0;if(!(n in r)){e=`JSON missing required field: '${n}'`;break}const a=r[n];if(i&&typeof a!==i){e=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&a!==o.value){e=`Expected '${n}' field to equal '${o.value}'`;break}}if(e)throw new x(P.INVALID_ARGUMENT,e);return!0}const bo=-62135596800,Ro=1e6;class ut{static now(){return ut.fromMillis(Date.now())}static fromDate(t){return ut.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*Ro);return new ut(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new x(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new x(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<bo)throw new x(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new x(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Ro}_compareTo(t){return this.seconds===t.seconds?z(this.nanoseconds,t.nanoseconds):z(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ut._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(zn(t,ut._jsonSchema))return new ut(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-bo;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ut._jsonSchemaVersion="firestore/timestamp/1.0",ut._jsonSchema={type:ht("string",ut._jsonSchemaVersion),seconds:ht("number"),nanoseconds:ht("number")};class q{static fromTimestamp(t){return new q(t)}static min(){return new q(new ut(0,0))}static max(){return new q(new ut(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Un=-1;function ph(r,t){const e=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=q.fromTimestamp(n===1e9?new ut(e+1,0):new ut(e,n));return new ue(i,F.empty(),t)}function yh(r){return new ue(r.readTime,r.key,Un)}class ue{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new ue(q.min(),F.empty(),Un)}static max(){return new ue(q.max(),F.empty(),Un)}}function _h(r,t){let e=r.readTime.compareTo(t.readTime);return e!==0?e:(e=F.comparator(r.documentKey,t.documentKey),e!==0?e:z(r.largestBatchId,t.largestBatchId))}const Eh="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vh{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Mr(r){if(r.code!==P.FAILED_PRECONDITION||r.message!==Eh)throw r;O("LocalStore","Unexpectedly lost primary lease")}class R{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&j(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new R(((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(t,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(e,o).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof R?e:R.resolve(e)}catch(e){return R.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):R.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):R.reject(e)}static resolve(t){return new R(((e,n)=>{e(t)}))}static reject(t){return new R(((e,n)=>{n(t)}))}static waitFor(t){return new R(((e,n)=>{let i=0,o=0,a=!1;t.forEach((u=>{++i,u.next((()=>{++o,a&&o===i&&e()}),(d=>n(d)))})),a=!0,o===i&&e()}))}static or(t){let e=R.resolve(!1);for(const n of t)e=e.next((i=>i?R.resolve(i):n()));return e}static forEach(t,e){const n=[];return t.forEach(((i,o)=>{n.push(e.call(this,i,o))})),this.waitFor(n)}static mapArray(t,e){return new R(((n,i)=>{const o=t.length,a=new Array(o);let u=0;for(let d=0;d<o;d++){const f=d;e(t[f]).next((_=>{a[f]=_,++u,u===o&&n(a)}),(_=>i(_)))}}))}static doWhile(t,e){return new R(((n,i)=>{const o=()=>{t()===!0?e().next((()=>{o()}),i):n()};o()}))}}function Th(r){const t=r.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function nn(r){return r.name==="IndexedDbTransactionError"}class Fr{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>e.writeSequenceNumber(n))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Fr.ce=-1;const wh=-1;function Br(r){return r==null}function Ns(r){return r===0&&1/r==-1/0}const Ba="";function Ih(r){let t="";for(let e=0;e<r.length;e++)t.length>0&&(t=Co(t)),t=Ah(r.get(e),t);return Co(t)}function Ah(r,t){let e=t;const n=r.length;for(let i=0;i<n;i++){const o=r.charAt(i);switch(o){case"\0":e+="";break;case Ba:e+="";break;default:e+=o}}return e}function Co(r){return r+Ba+""}function Po(r){let t=0;for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&t++;return t}function Hn(r,t){for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&t(e,r[e])}function Sh(r){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t))return!1;return!0}class it{constructor(t,e){this.comparator=t,this.root=e||vt.EMPTY}insert(t,e){return new it(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,vt.BLACK,null,null))}remove(t){return new it(this.comparator,this.root.remove(t,this.comparator).copy(null,null,vt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(n===0)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new gr(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new gr(this.root,t,this.comparator,!1)}getReverseIterator(){return new gr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new gr(this.root,t,this.comparator,!0)}}class gr{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!t.isEmpty();)if(o=e?n(t.key,e):1,e&&i&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(o===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class vt{constructor(t,e,n,i,o){this.key=t,this.value=e,this.color=n??vt.RED,this.left=i??vt.EMPTY,this.right=o??vt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,o){return new vt(t??this.key,e??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const o=n(t,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(t,e,n),null):o===0?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return vt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),e(t,i.key)===0){if(i.right.isEmpty())return vt.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw j(43730,{key:this.key,value:this.value});if(this.right.isRed())throw j(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw j(27949);return t+(this.isRed()?0:1)}}vt.EMPTY=null,vt.RED=!0,vt.BLACK=!1;vt.EMPTY=new class{constructor(){this.size=0}get key(){throw j(57766)}get value(){throw j(16141)}get color(){throw j(16727)}get left(){throw j(29726)}get right(){throw j(36894)}copy(t,e,n,i,o){return this}insert(t,e,n){return new vt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class mt{constructor(t){this.comparator=t,this.data=new it(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Vo(this.data.getIterator())}getIteratorFrom(t){return new Vo(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((n=>{e=e.add(n)})),e}isEqual(t){if(!(t instanceof mt)||this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const i=e.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new mt(this.comparator);return e.data=t,e}}class Vo{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ee{constructor(t){this.fields=t,t.sort(Ct.comparator)}static empty(){return new ee([])}unionWith(t){let e=new mt(Ct.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new ee(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return We(this.fields,t.fields,((e,n)=>e.isEqual(n)))}}class Ua extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Tt{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Ua("Invalid base64 string: "+o):o}})(t);return new Tt(e)}static fromUint8Array(t){const e=(function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o})(t);return new Tt(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return z(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Tt.EMPTY_BYTE_STRING=new Tt("");const bh=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function he(r){if(et(!!r,39018),typeof r=="string"){let t=0;const e=bh.exec(r);if(et(!!e,46558,{timestamp:r}),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:st(r.seconds),nanos:st(r.nanos)}}function st(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function de(r){return typeof r=="string"?Tt.fromBase64String(r):Tt.fromUint8Array(r)}const qa="server_timestamp",ja="__type__",Ga="__previous_value__",za="__local_write_time__";function Zs(r){return(r?.mapValue?.fields||{})[ja]?.stringValue===qa}function Ur(r){const t=r.mapValue.fields[Ga];return Zs(t)?Ur(t):t}function qn(r){const t=he(r.mapValue.fields[za].timestampValue);return new ut(t.seconds,t.nanos)}class Rh{constructor(t,e,n,i,o,a,u,d,f,_){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=d,this.useFetchStreams=f,this.isUsingEmulator=_}}const Cr="(default)";class jn{constructor(t,e){this.projectId=t,this.database=e||Cr}static empty(){return new jn("","")}get isDefaultDatabase(){return this.database===Cr}isEqual(t){return t instanceof jn&&t.projectId===this.projectId&&t.database===this.database}}const Ch="__type__",Ph="__max__",mr={mapValue:{}},Vh="__vector__",ks="value";function fe(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Zs(r)?4:Nh(r)?9007199254740991:Dh(r)?10:11:j(28295,{value:r})}function qt(r,t){if(r===t)return!0;const e=fe(r);if(e!==fe(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===t.booleanValue;case 4:return qn(r).isEqual(qn(t));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const a=he(i.timestampValue),u=he(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos})(r,t);case 5:return r.stringValue===t.stringValue;case 6:return(function(i,o){return de(i.bytesValue).isEqual(de(o.bytesValue))})(r,t);case 7:return r.referenceValue===t.referenceValue;case 8:return(function(i,o){return st(i.geoPointValue.latitude)===st(o.geoPointValue.latitude)&&st(i.geoPointValue.longitude)===st(o.geoPointValue.longitude)})(r,t);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return st(i.integerValue)===st(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const a=st(i.doubleValue),u=st(o.doubleValue);return a===u?Ns(a)===Ns(u):isNaN(a)&&isNaN(u)}return!1})(r,t);case 9:return We(r.arrayValue.values||[],t.arrayValue.values||[],qt);case 10:case 11:return(function(i,o){const a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(Po(a)!==Po(u))return!1;for(const d in a)if(a.hasOwnProperty(d)&&(u[d]===void 0||!qt(a[d],u[d])))return!1;return!0})(r,t);default:return j(52216,{left:r})}}function Gn(r,t){return(r.values||[]).find((e=>qt(e,t)))!==void 0}function $e(r,t){if(r===t)return 0;const e=fe(r),n=fe(t);if(e!==n)return z(e,n);switch(e){case 0:case 9007199254740991:return 0;case 1:return z(r.booleanValue,t.booleanValue);case 2:return(function(o,a){const u=st(o.integerValue||o.doubleValue),d=st(a.integerValue||a.doubleValue);return u<d?-1:u>d?1:u===d?0:isNaN(u)?isNaN(d)?0:-1:1})(r,t);case 3:return Do(r.timestampValue,t.timestampValue);case 4:return Do(qn(r),qn(t));case 5:return Ds(r.stringValue,t.stringValue);case 6:return(function(o,a){const u=de(o),d=de(a);return u.compareTo(d)})(r.bytesValue,t.bytesValue);case 7:return(function(o,a){const u=o.split("/"),d=a.split("/");for(let f=0;f<u.length&&f<d.length;f++){const _=z(u[f],d[f]);if(_!==0)return _}return z(u.length,d.length)})(r.referenceValue,t.referenceValue);case 8:return(function(o,a){const u=z(st(o.latitude),st(a.latitude));return u!==0?u:z(st(o.longitude),st(a.longitude))})(r.geoPointValue,t.geoPointValue);case 9:return No(r.arrayValue,t.arrayValue);case 10:return(function(o,a){const u=o.fields||{},d=a.fields||{},f=u[ks]?.arrayValue,_=d[ks]?.arrayValue,A=z(f?.values?.length||0,_?.values?.length||0);return A!==0?A:No(f,_)})(r.mapValue,t.mapValue);case 11:return(function(o,a){if(o===mr.mapValue&&a===mr.mapValue)return 0;if(o===mr.mapValue)return 1;if(a===mr.mapValue)return-1;const u=o.fields||{},d=Object.keys(u),f=a.fields||{},_=Object.keys(f);d.sort(),_.sort();for(let A=0;A<d.length&&A<_.length;++A){const b=Ds(d[A],_[A]);if(b!==0)return b;const C=$e(u[d[A]],f[_[A]]);if(C!==0)return C}return z(d.length,_.length)})(r.mapValue,t.mapValue);default:throw j(23264,{he:e})}}function Do(r,t){if(typeof r=="string"&&typeof t=="string"&&r.length===t.length)return z(r,t);const e=he(r),n=he(t),i=z(e.seconds,n.seconds);return i!==0?i:z(e.nanos,n.nanos)}function No(r,t){const e=r.values||[],n=t.values||[];for(let i=0;i<e.length&&i<n.length;++i){const o=$e(e[i],n[i]);if(o)return o}return z(e.length,n.length)}function Ye(r){return Os(r)}function Os(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?(function(e){const n=he(e);return`time(${n.seconds},${n.nanos})`})(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?(function(e){return de(e).toBase64()})(r.bytesValue):"referenceValue"in r?(function(e){return F.fromName(e).toString()})(r.referenceValue):"geoPointValue"in r?(function(e){return`geo(${e.latitude},${e.longitude})`})(r.geoPointValue):"arrayValue"in r?(function(e){let n="[",i=!0;for(const o of e.values||[])i?i=!1:n+=",",n+=Os(o);return n+"]"})(r.arrayValue):"mapValue"in r?(function(e){const n=Object.keys(e.fields||{}).sort();let i="{",o=!0;for(const a of n)o?o=!1:i+=",",i+=`${a}:${Os(e.fields[a])}`;return i+"}"})(r.mapValue):j(61005,{value:r})}function Er(r){switch(fe(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Ur(r);return t?16+Er(t):16;case 5:return 2*r.stringValue.length;case 6:return de(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((i,o)=>i+Er(o)),0)})(r.arrayValue);case 10:case 11:return(function(n){let i=0;return Hn(n.fields,((o,a)=>{i+=o.length+Er(a)})),i})(r.mapValue);default:throw j(13486,{value:r})}}function Ls(r){return!!r&&"integerValue"in r}function ti(r){return!!r&&"arrayValue"in r}function ko(r){return!!r&&"nullValue"in r}function Oo(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Es(r){return!!r&&"mapValue"in r}function Dh(r){return(r?.mapValue?.fields||{})[Ch]?.stringValue===Vh}function kn(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:{...r.timestampValue}};if(r.mapValue){const t={mapValue:{fields:{}}};return Hn(r.mapValue.fields,((e,n)=>t.mapValue.fields[e]=kn(n))),t}if(r.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(r.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=kn(r.arrayValue.values[e]);return t}return{...r}}function Nh(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===Ph}class Ft{constructor(t){this.value=t}static empty(){return new Ft({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Es(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=kn(e)}setAll(t){let e=Ct.emptyPath(),n={},i=[];t.forEach(((a,u)=>{if(!e.isImmediateParentOf(u)){const d=this.getFieldsMap(e);this.applyChanges(d,n,i),n={},i=[],e=u.popLast()}a?n[u.lastSegment()]=kn(a):i.push(u.lastSegment())}));const o=this.getFieldsMap(e);this.applyChanges(o,n,i)}delete(t){const e=this.field(t.popLast());Es(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return qt(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Es(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){Hn(e,((i,o)=>t[i]=o));for(const i of n)delete t[i]}clone(){return new Ft(kn(this.value))}}class St{constructor(t,e,n,i,o,a,u){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(t){return new St(t,0,q.min(),q.min(),q.min(),Ft.empty(),0)}static newFoundDocument(t,e,n,i){return new St(t,1,e,q.min(),n,i,0)}static newNoDocument(t,e){return new St(t,2,e,q.min(),q.min(),Ft.empty(),0)}static newUnknownDocument(t,e){return new St(t,3,e,q.min(),q.min(),Ft.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ft.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ft.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof St&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new St(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Pr{constructor(t,e){this.position=t,this.inclusive=e}}function Lo(r,t,e){let n=0;for(let i=0;i<r.position.length;i++){const o=t[i],a=r.position[i];if(o.field.isKeyField()?n=F.comparator(F.fromName(a.referenceValue),e.key):n=$e(a,e.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function xo(r,t){if(r===null)return t===null;if(t===null||r.inclusive!==t.inclusive||r.position.length!==t.position.length)return!1;for(let e=0;e<r.position.length;e++)if(!qt(r.position[e],t.position[e]))return!1;return!0}class Vr{constructor(t,e="asc"){this.field=t,this.dir=e}}function kh(r,t){return r.dir===t.dir&&r.field.isEqual(t.field)}class Ha{}class gt extends Ha{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,n):new Lh(t,e,n):e==="array-contains"?new Fh(t,n):e==="in"?new Bh(t,n):e==="not-in"?new Uh(t,n):e==="array-contains-any"?new qh(t,n):new gt(t,e,n)}static createKeyFieldInFilter(t,e,n){return e==="in"?new xh(t,n):new Mh(t,n)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison($e(e,this.value)):e!==null&&fe(this.value)===fe(e)&&this.matchesComparison($e(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return j(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class jt extends Ha{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new jt(t,e)}matches(t){return Ka(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ka(r){return r.op==="and"}function Qa(r){return Oh(r)&&Ka(r)}function Oh(r){for(const t of r.filters)if(t instanceof jt)return!1;return!0}function xs(r){if(r instanceof gt)return r.field.canonicalString()+r.op.toString()+Ye(r.value);if(Qa(r))return r.filters.map((t=>xs(t))).join(",");{const t=r.filters.map((e=>xs(e))).join(",");return`${r.op}(${t})`}}function Wa(r,t){return r instanceof gt?(function(n,i){return i instanceof gt&&n.op===i.op&&n.field.isEqual(i.field)&&qt(n.value,i.value)})(r,t):r instanceof jt?(function(n,i){return i instanceof jt&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce(((o,a,u)=>o&&Wa(a,i.filters[u])),!0):!1})(r,t):void j(19439)}function $a(r){return r instanceof gt?(function(e){return`${e.field.canonicalString()} ${e.op} ${Ye(e.value)}`})(r):r instanceof jt?(function(e){return e.op.toString()+" {"+e.getFilters().map($a).join(" ,")+"}"})(r):"Filter"}class Lh extends gt{constructor(t,e,n){super(t,e,n),this.key=F.fromName(n.referenceValue)}matches(t){const e=F.comparator(t.key,this.key);return this.matchesComparison(e)}}class xh extends gt{constructor(t,e){super(t,"in",e),this.keys=Ya("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Mh extends gt{constructor(t,e){super(t,"not-in",e),this.keys=Ya("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Ya(r,t){return(t.arrayValue?.values||[]).map((e=>F.fromName(e.referenceValue)))}class Fh extends gt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return ti(e)&&Gn(e.arrayValue,this.value)}}class Bh extends gt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Gn(this.value.arrayValue,e)}}class Uh extends gt{constructor(t,e){super(t,"not-in",e)}matches(t){if(Gn(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Gn(this.value.arrayValue,e)}}class qh extends gt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!ti(e)||!e.arrayValue.values)&&e.arrayValue.values.some((n=>Gn(this.value.arrayValue,n)))}}class jh{constructor(t,e=null,n=[],i=[],o=null,a=null,u=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.Te=null}}function Mo(r,t=null,e=[],n=[],i=null,o=null,a=null){return new jh(r,t,e,n,i,o,a)}function ei(r){const t=Q(r);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((n=>xs(n))).join(","),e+="|ob:",e+=t.orderBy.map((n=>(function(o){return o.field.canonicalString()+o.dir})(n))).join(","),Br(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((n=>Ye(n))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((n=>Ye(n))).join(",")),t.Te=e}return t.Te}function ni(r,t){if(r.limit!==t.limit||r.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<r.orderBy.length;e++)if(!kh(r.orderBy[e],t.orderBy[e]))return!1;if(r.filters.length!==t.filters.length)return!1;for(let e=0;e<r.filters.length;e++)if(!Wa(r.filters[e],t.filters[e]))return!1;return r.collectionGroup===t.collectionGroup&&!!r.path.isEqual(t.path)&&!!xo(r.startAt,t.startAt)&&xo(r.endAt,t.endAt)}function Ms(r){return F.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}class qr{constructor(t,e=null,n=[],i=[],o=null,a="F",u=null,d=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=d,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Gh(r,t,e,n,i,o,a,u){return new qr(r,t,e,n,i,o,a,u)}function ri(r){return new qr(r)}function Fo(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function zh(r){return r.collectionGroup!==null}function On(r){const t=Q(r);if(t.Ie===null){t.Ie=[];const e=new Set;for(const o of t.explicitOrderBy)t.Ie.push(o),e.add(o.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new mt(Ct.comparator);return a.filters.forEach((d=>{d.getFlattenedFilters().forEach((f=>{f.isInequality()&&(u=u.add(f.field))}))})),u})(t).forEach((o=>{e.has(o.canonicalString())||o.isKeyField()||t.Ie.push(new Vr(o,n))})),e.has(Ct.keyField().canonicalString())||t.Ie.push(new Vr(Ct.keyField(),n))}return t.Ie}function Ut(r){const t=Q(r);return t.Ee||(t.Ee=Hh(t,On(r))),t.Ee}function Hh(r,t){if(r.limitType==="F")return Mo(r.path,r.collectionGroup,t,r.filters,r.limit,r.startAt,r.endAt);{t=t.map((i=>{const o=i.dir==="desc"?"asc":"desc";return new Vr(i.field,o)}));const e=r.endAt?new Pr(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Pr(r.startAt.position,r.startAt.inclusive):null;return Mo(r.path,r.collectionGroup,t,r.filters,r.limit,e,n)}}function Fs(r,t,e){return new qr(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),t,e,r.startAt,r.endAt)}function jr(r,t){return ni(Ut(r),Ut(t))&&r.limitType===t.limitType}function Xa(r){return`${ei(Ut(r))}|lt:${r.limitType}`}function Ue(r){return`Query(target=${(function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map((i=>$a(i))).join(", ")}]`),Br(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>Ye(i))).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>Ye(i))).join(",")),`Target(${n})`})(Ut(r))}; limitType=${r.limitType})`}function Gr(r,t){return t.isFoundDocument()&&(function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):F.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)})(r,t)&&(function(n,i){for(const o of On(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(r,t)&&(function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0})(r,t)&&(function(n,i){return!(n.startAt&&!(function(a,u,d){const f=Lo(a,u,d);return a.inclusive?f<=0:f<0})(n.startAt,On(n),i)||n.endAt&&!(function(a,u,d){const f=Lo(a,u,d);return a.inclusive?f>=0:f>0})(n.endAt,On(n),i))})(r,t)}function Kh(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function Ja(r){return(t,e)=>{let n=!1;for(const i of On(r)){const o=Qh(i,t,e);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function Qh(r,t,e){const n=r.field.isKeyField()?F.comparator(t.key,e.key):(function(o,a,u){const d=a.data.field(o),f=u.data.field(o);return d!==null&&f!==null?$e(d,f):j(42886)})(r.field,t,e);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return j(19790,{direction:r.dir})}}class De{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,t))return o}}has(t){return this.get(t)!==void 0}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return this.inner[n]=[[t,e]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],t))return void(i[o]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return n.length===1?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Hn(this.inner,((e,n)=>{for(const[i,o]of n)t(i,o)}))}isEmpty(){return Sh(this.inner)}size(){return this.innerSize}}const Wh=new it(F.comparator);function ge(){return Wh}const Za=new it(F.comparator);function Pn(...r){let t=Za;for(const e of r)t=t.insert(e.key,e);return t}function $h(r){let t=Za;return r.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Re(){return Ln()}function tl(){return Ln()}function Ln(){return new De((r=>r.toString()),((r,t)=>r.isEqual(t)))}const Yh=new mt(F.comparator);function W(...r){let t=Yh;for(const e of r)t=t.add(e);return t}const Xh=new mt(z);function Jh(){return Xh}function Zh(r,t){if(r.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ns(t)?"-0":t}}function td(r){return{integerValue:""+r}}class zr{constructor(){this._=void 0}}function ed(r,t,e){return r instanceof Bs?(function(i,o){const a={fields:{[ja]:{stringValue:qa},[za]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Zs(o)&&(o=Ur(o)),o&&(a.fields[Ga]=o),{mapValue:a}})(e,t):r instanceof Dr?el(r,t):r instanceof Nr?nl(r,t):(function(i,o){const a=rd(i,o),u=Bo(a)+Bo(i.Ae);return Ls(a)&&Ls(i.Ae)?td(u):Zh(i.serializer,u)})(r,t)}function nd(r,t,e){return r instanceof Dr?el(r,t):r instanceof Nr?nl(r,t):e}function rd(r,t){return r instanceof Us?(function(n){return Ls(n)||(function(o){return!!o&&"doubleValue"in o})(n)})(t)?t:{integerValue:0}:null}class Bs extends zr{}class Dr extends zr{constructor(t){super(),this.elements=t}}function el(r,t){const e=rl(t);for(const n of r.elements)e.some((i=>qt(i,n)))||e.push(n);return{arrayValue:{values:e}}}class Nr extends zr{constructor(t){super(),this.elements=t}}function nl(r,t){let e=rl(t);for(const n of r.elements)e=e.filter((i=>!qt(i,n)));return{arrayValue:{values:e}}}class Us extends zr{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function Bo(r){return st(r.integerValue||r.doubleValue)}function rl(r){return ti(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function sd(r,t){return r.field.isEqual(t.field)&&(function(n,i){return n instanceof Dr&&i instanceof Dr||n instanceof Nr&&i instanceof Nr?We(n.elements,i.elements,qt):n instanceof Us&&i instanceof Us?qt(n.Ae,i.Ae):n instanceof Bs&&i instanceof Bs})(r.transform,t.transform)}class Ce{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Ce}static exists(t){return new Ce(void 0,t)}static updateTime(t){return new Ce(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function vr(r,t){return r.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(r.updateTime):r.exists===void 0||r.exists===t.isFoundDocument()}class si{}function sl(r,t){if(!r.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return r.isNoDocument()?new od(r.key,Ce.none()):new ii(r.key,r.data,Ce.none());{const e=r.data,n=Ft.empty();let i=new mt(Ct.comparator);for(let o of t.fields)if(!i.has(o)){let a=e.field(o);a===null&&o.length>1&&(o=o.popLast(),a=e.field(o)),a===null?n.delete(o):n.set(o,a),i=i.add(o)}return new Hr(r.key,n,new ee(i.toArray()),Ce.none())}}function id(r,t,e){r instanceof ii?(function(i,o,a){const u=i.value.clone(),d=qo(i.fieldTransforms,o,a.transformResults);u.setAll(d),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()})(r,t,e):r instanceof Hr?(function(i,o,a){if(!vr(i.precondition,o))return void o.convertToUnknownDocument(a.version);const u=qo(i.fieldTransforms,o,a.transformResults),d=o.data;d.setAll(il(i)),d.setAll(u),o.convertToFoundDocument(a.version,d).setHasCommittedMutations()})(r,t,e):(function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()})(0,t,e)}function xn(r,t,e,n){return r instanceof ii?(function(o,a,u,d){if(!vr(o.precondition,a))return u;const f=o.value.clone(),_=jo(o.fieldTransforms,d,a);return f.setAll(_),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),null})(r,t,e,n):r instanceof Hr?(function(o,a,u,d){if(!vr(o.precondition,a))return u;const f=jo(o.fieldTransforms,d,a),_=a.data;return _.setAll(il(o)),_.setAll(f),a.convertToFoundDocument(a.version,_).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((A=>A.field)))})(r,t,e,n):(function(o,a,u){return vr(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u})(r,t,e)}function Uo(r,t){return r.type===t.type&&!!r.key.isEqual(t.key)&&!!r.precondition.isEqual(t.precondition)&&!!(function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&We(n,i,((o,a)=>sd(o,a)))})(r.fieldTransforms,t.fieldTransforms)&&(r.type===0?r.value.isEqual(t.value):r.type!==1||r.data.isEqual(t.data)&&r.fieldMask.isEqual(t.fieldMask))}class ii extends si{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Hr extends si{constructor(t,e,n,i,o=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function il(r){const t=new Map;return r.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const n=r.data.field(e);t.set(e,n)}})),t}function qo(r,t,e){const n=new Map;et(r.length===e.length,32656,{Re:e.length,Ve:r.length});for(let i=0;i<e.length;i++){const o=r[i],a=o.transform,u=t.data.field(o.field);n.set(o.field,nd(a,u,e[i]))}return n}function jo(r,t,e){const n=new Map;for(const i of r){const o=i.transform,a=e.data.field(i.field);n.set(i.field,ed(o,a,t))}return n}class od extends si{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ad{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(t.key)&&id(o,t,n[i])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=xn(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=xn(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=tl();return this.mutations.forEach((i=>{const o=t.get(i.key),a=o.overlayedDocument;let u=this.applyToLocalView(a,o.mutatedFields);u=e.has(i.key)?null:u;const d=sl(a,u);d!==null&&n.set(i.key,d),a.isValidDocument()||a.convertToNoDocument(q.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),W())}isEqual(t){return this.batchId===t.batchId&&We(this.mutations,t.mutations,((e,n)=>Uo(e,n)))&&We(this.baseMutations,t.baseMutations,((e,n)=>Uo(e,n)))}}class ld{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class cd{constructor(t,e){this.count=t,this.unchangedNames=e}}var ct,H;function ol(r){if(r===void 0)return Ht("GRPC error has no .code"),P.UNKNOWN;switch(r){case ct.OK:return P.OK;case ct.CANCELLED:return P.CANCELLED;case ct.UNKNOWN:return P.UNKNOWN;case ct.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case ct.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case ct.INTERNAL:return P.INTERNAL;case ct.UNAVAILABLE:return P.UNAVAILABLE;case ct.UNAUTHENTICATED:return P.UNAUTHENTICATED;case ct.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case ct.NOT_FOUND:return P.NOT_FOUND;case ct.ALREADY_EXISTS:return P.ALREADY_EXISTS;case ct.PERMISSION_DENIED:return P.PERMISSION_DENIED;case ct.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case ct.ABORTED:return P.ABORTED;case ct.OUT_OF_RANGE:return P.OUT_OF_RANGE;case ct.UNIMPLEMENTED:return P.UNIMPLEMENTED;case ct.DATA_LOSS:return P.DATA_LOSS;default:return j(39323,{code:r})}}(H=ct||(ct={}))[H.OK=0]="OK",H[H.CANCELLED=1]="CANCELLED",H[H.UNKNOWN=2]="UNKNOWN",H[H.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",H[H.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",H[H.NOT_FOUND=5]="NOT_FOUND",H[H.ALREADY_EXISTS=6]="ALREADY_EXISTS",H[H.PERMISSION_DENIED=7]="PERMISSION_DENIED",H[H.UNAUTHENTICATED=16]="UNAUTHENTICATED",H[H.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",H[H.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",H[H.ABORTED=10]="ABORTED",H[H.OUT_OF_RANGE=11]="OUT_OF_RANGE",H[H.UNIMPLEMENTED=12]="UNIMPLEMENTED",H[H.INTERNAL=13]="INTERNAL",H[H.UNAVAILABLE=14]="UNAVAILABLE",H[H.DATA_LOSS=15]="DATA_LOSS";function ud(){return new TextEncoder}const hd=new ie([4294967295,4294967295],0);function Go(r){const t=ud().encode(r),e=new Va;return e.update(t),new Uint8Array(e.digest())}function zo(r){const t=new DataView(r.buffer),e=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new ie([e,n],0),new ie([i,o],0)]}class oi{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new Vn(`Invalid padding: ${e}`);if(n<0)throw new Vn(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new Vn(`Invalid hash count: ${n}`);if(t.length===0&&e!==0)throw new Vn(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=ie.fromNumber(this.ge)}ye(t,e,n){let i=t.add(e.multiply(ie.fromNumber(n)));return i.compare(hd)===1&&(i=new ie([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=Go(t),[n,i]=zo(e);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);if(!this.we(a))return!1}return!0}static create(t,e,n){const i=t%8==0?0:8-t%8,o=new Uint8Array(Math.ceil(t/8)),a=new oi(o,i,e);return n.forEach((u=>a.insert(u))),a}insert(t){if(this.ge===0)return;const e=Go(t),[n,i]=zo(e);for(let o=0;o<this.hashCount;o++){const a=this.ye(n,i,o);this.Se(a)}}Se(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class Vn extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Kr{constructor(t,e,n,i,o){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const i=new Map;return i.set(t,Kn.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new Kr(q.min(),i,new it(z),ge(),W())}}class Kn{constructor(t,e,n,i,o){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new Kn(n,e,W(),W(),W())}}class Tr{constructor(t,e,n,i){this.be=t,this.removedTargetIds=e,this.key=n,this.De=i}}class al{constructor(t,e){this.targetId=t,this.Ce=e}}class ll{constructor(t,e,n=Tt.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class Ho{constructor(){this.ve=0,this.Fe=Ko(),this.Me=Tt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=W(),e=W(),n=W();return this.Fe.forEach(((i,o)=>{switch(o){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:j(38017,{changeType:o})}})),new Kn(this.Me,this.xe,t,e,n)}qe(){this.Oe=!1,this.Fe=Ko()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,et(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class dd{constructor(t){this.Ge=t,this.ze=new Map,this.je=ge(),this.Je=pr(),this.He=pr(),this.Ye=new it(z)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const n=this.nt(e);switch(t.state){case 0:this.rt(e)&&n.Le(t.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(t.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(n.We(),n.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),n.Le(t.resumeToken));break;default:j(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((n,i)=>{this.rt(i)&&e(i)}))}st(t){const e=t.targetId,n=t.Ce.count,i=this.ot(e);if(i){const o=i.target;if(Ms(o))if(n===0){const a=new F(o.path);this.et(e,a,St.newNoDocument(a,q.min()))}else et(n===1,20013,{expectedCount:n});else{const a=this._t(e);if(a!==n){const u=this.ut(t),d=u?this.ct(u,t,a):1;if(d!==0){this.it(e);const f=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,f)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=e;let a,u;try{a=de(n).toUint8Array()}catch(d){if(d instanceof Ua)return Qe("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{u=new oi(a,i,o)}catch(d){return Qe(d instanceof Vn?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return u.ge===0?null:u}ct(t,e,n){return e.Ce.count===n-this.Pt(t,e.targetId)?0:2}Pt(t,e){const n=this.Ge.getRemoteKeysForTarget(e);let i=0;return n.forEach((o=>{const a=this.Ge.ht(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;t.mightContain(u)||(this.et(e,o,null),i++)})),i}Tt(t){const e=new Map;this.ze.forEach(((o,a)=>{const u=this.ot(a);if(u){if(o.current&&Ms(u.target)){const d=new F(u.target.path);this.It(d).has(a)||this.Et(a,d)||this.et(a,d,St.newNoDocument(d,t))}o.Be&&(e.set(a,o.ke()),o.qe())}}));let n=W();this.He.forEach(((o,a)=>{let u=!0;a.forEachWhile((d=>{const f=this.ot(d);return!f||f.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(o))})),this.je.forEach(((o,a)=>a.setReadTime(t)));const i=new Kr(t,e,this.Ye,this.je,n);return this.je=ge(),this.Je=pr(),this.He=pr(),this.Ye=new it(z),i}Xe(t,e){if(!this.rt(t))return;const n=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,n),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,n){if(!this.rt(t))return;const i=this.nt(t);this.Et(t,e)?i.Qe(e,1):i.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),n&&(this.je=this.je.insert(e,n))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new Ho,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new mt(z),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new mt(z),this.Je=this.Je.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||O("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new Ho),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function pr(){return new it(F.comparator)}function Ko(){return new it(F.comparator)}const fd={asc:"ASCENDING",desc:"DESCENDING"},gd={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},md={and:"AND",or:"OR"};class pd{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function qs(r,t){return r.useProto3Json||Br(t)?t:{value:t}}function yd(r,t){return r.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function _d(r,t){return r.useProto3Json?t.toBase64():t.toUint8Array()}function ze(r){return et(!!r,49232),q.fromTimestamp((function(e){const n=he(e);return new ut(n.seconds,n.nanos)})(r))}function Ed(r,t){return js(r,t).canonicalString()}function js(r,t){const e=(function(i){return new tt(["projects",i.projectId,"databases",i.database])})(r).child("documents");return t===void 0?e:e.child(t)}function cl(r){const t=tt.fromString(r);return et(gl(t),10190,{key:t.toString()}),t}function vs(r,t){const e=cl(t);if(e.get(1)!==r.databaseId.projectId)throw new x(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+r.databaseId.projectId);if(e.get(3)!==r.databaseId.database)throw new x(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+r.databaseId.database);return new F(hl(e))}function ul(r,t){return Ed(r.databaseId,t)}function vd(r){const t=cl(r);return t.length===4?tt.emptyPath():hl(t)}function Qo(r){return new tt(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function hl(r){return et(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function Td(r,t){let e;if("targetChange"in t){t.targetChange;const n=(function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:j(39313,{state:f})})(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=(function(f,_){return f.useProto3Json?(et(_===void 0||typeof _=="string",58123),Tt.fromBase64String(_||"")):(et(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),Tt.fromUint8Array(_||new Uint8Array))})(r,t.targetChange.resumeToken),a=t.targetChange.cause,u=a&&(function(f){const _=f.code===void 0?P.UNKNOWN:ol(f.code);return new x(_,f.message||"")})(a);e=new ll(n,i,o,u||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const i=vs(r,n.document.name),o=ze(n.document.updateTime),a=n.document.createTime?ze(n.document.createTime):q.min(),u=new Ft({mapValue:{fields:n.document.fields}}),d=St.newFoundDocument(i,o,a,u),f=n.targetIds||[],_=n.removedTargetIds||[];e=new Tr(f,_,d.key,d)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const i=vs(r,n.document),o=n.readTime?ze(n.readTime):q.min(),a=St.newNoDocument(i,o),u=n.removedTargetIds||[];e=new Tr([],u,a.key,a)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const i=vs(r,n.document),o=n.removedTargetIds||[];e=new Tr([],o,i,null)}else{if(!("filter"in t))return j(11601,{Rt:t});{t.filter;const n=t.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,a=new cd(i,o),u=n.targetId;e=new al(u,a)}}return e}function wd(r,t){return{documents:[ul(r,t.path)]}}function Id(r,t){const e={structuredQuery:{}},n=t.path;let i;t.collectionGroup!==null?(i=n,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=n.popLast(),e.structuredQuery.from=[{collectionId:n.lastSegment()}]),e.parent=ul(r,i);const o=(function(f){if(f.length!==0)return fl(jt.create(f,"and"))})(t.filters);o&&(e.structuredQuery.where=o);const a=(function(f){if(f.length!==0)return f.map((_=>(function(b){return{field:qe(b.field),direction:bd(b.dir)}})(_)))})(t.orderBy);a&&(e.structuredQuery.orderBy=a);const u=qs(r,t.limit);return u!==null&&(e.structuredQuery.limit=u),t.startAt&&(e.structuredQuery.startAt=(function(f){return{before:f.inclusive,values:f.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(f){return{before:!f.inclusive,values:f.position}})(t.endAt)),{ft:e,parent:i}}function Ad(r){let t=vd(r.parent);const e=r.structuredQuery,n=e.from?e.from.length:0;let i=null;if(n>0){et(n===1,65062);const _=e.from[0];_.allDescendants?i=_.collectionId:t=t.child(_.collectionId)}let o=[];e.where&&(o=(function(A){const b=dl(A);return b instanceof jt&&Qa(b)?b.getFilters():[b]})(e.where));let a=[];e.orderBy&&(a=(function(A){return A.map((b=>(function(B){return new Vr(je(B.field),(function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(B.direction))})(b)))})(e.orderBy));let u=null;e.limit&&(u=(function(A){let b;return b=typeof A=="object"?A.value:A,Br(b)?null:b})(e.limit));let d=null;e.startAt&&(d=(function(A){const b=!!A.before,C=A.values||[];return new Pr(C,b)})(e.startAt));let f=null;return e.endAt&&(f=(function(A){const b=!A.before,C=A.values||[];return new Pr(C,b)})(e.endAt)),Gh(t,i,a,o,u,"F",d,f)}function Sd(r,t){const e=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return j(28987,{purpose:i})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function dl(r){return r.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=je(e.unaryFilter.field);return gt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=je(e.unaryFilter.field);return gt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=je(e.unaryFilter.field);return gt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=je(e.unaryFilter.field);return gt.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return j(61313);default:return j(60726)}})(r):r.fieldFilter!==void 0?(function(e){return gt.create(je(e.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return j(58110);default:return j(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(r):r.compositeFilter!==void 0?(function(e){return jt.create(e.compositeFilter.filters.map((n=>dl(n))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return j(1026)}})(e.compositeFilter.op))})(r):j(30097,{filter:r})}function bd(r){return fd[r]}function Rd(r){return gd[r]}function Cd(r){return md[r]}function qe(r){return{fieldPath:r.canonicalString()}}function je(r){return Ct.fromServerFormat(r.fieldPath)}function fl(r){return r instanceof gt?(function(e){if(e.op==="=="){if(Oo(e.value))return{unaryFilter:{field:qe(e.field),op:"IS_NAN"}};if(ko(e.value))return{unaryFilter:{field:qe(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Oo(e.value))return{unaryFilter:{field:qe(e.field),op:"IS_NOT_NAN"}};if(ko(e.value))return{unaryFilter:{field:qe(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qe(e.field),op:Rd(e.op),value:e.value}}})(r):r instanceof jt?(function(e){const n=e.getFilters().map((i=>fl(i)));return n.length===1?n[0]:{compositeFilter:{op:Cd(e.op),filters:n}}})(r):j(54877,{filter:r})}function gl(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}class ne{constructor(t,e,n,i,o=q.min(),a=q.min(),u=Tt.EMPTY_BYTE_STRING,d=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=d}withSequenceNumber(t){return new ne(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new ne(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ne(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ne(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class Pd{constructor(t){this.yt=t}}function Vd(r){const t=Ad({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Fs(t,t.limit,"L"):t}class Dd{constructor(){this.Cn=new Nd}addToCollectionParentIndex(t,e){return this.Cn.add(e),R.resolve()}getCollectionParents(t,e){return R.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return R.resolve()}deleteFieldIndex(t,e){return R.resolve()}deleteAllFieldIndexes(t){return R.resolve()}createTargetIndexes(t,e){return R.resolve()}getDocumentsMatchingTarget(t,e){return R.resolve(null)}getIndexType(t,e){return R.resolve(0)}getFieldIndexes(t,e){return R.resolve([])}getNextCollectionGroupToUpdate(t){return R.resolve(null)}getMinOffset(t,e){return R.resolve(ue.min())}getMinOffsetFromCollectionGroup(t,e){return R.resolve(ue.min())}updateCollectionGroup(t,e,n){return R.resolve()}updateIndexEntries(t,e){return R.resolve()}}class Nd{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new mt(tt.comparator),o=!i.has(n);return this.index[e]=i.add(n),o}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new mt(tt.comparator)).toArray()}}const Wo={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ml=41943040;class Pt{static withCacheSize(t){return new Pt(t,Pt.DEFAULT_COLLECTION_PERCENTILE,Pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}Pt.DEFAULT_COLLECTION_PERCENTILE=10,Pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pt.DEFAULT=new Pt(ml,Pt.DEFAULT_COLLECTION_PERCENTILE,Pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pt.DISABLED=new Pt(-1,0,0);class Xe{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new Xe(0)}static cr(){return new Xe(-1)}}const $o="LruGarbageCollector",kd=1048576;function Yo([r,t],[e,n]){const i=z(r,e);return i===0?z(t,n):i}class Od{constructor(t){this.Ir=t,this.buffer=new mt(Yo),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const n=this.buffer.last();Yo(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}}get maxValue(){return this.buffer.last()[0]}}class Ld{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){O($o,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){nn(e)?O($o,"Ignoring IndexedDB error during garbage collection: ",e):await Mr(e)}await this.Vr(3e5)}))}}class xd{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next((n=>Math.floor(e/100*n)))}nthSequenceNumber(t,e){if(e===0)return R.resolve(Fr.ce);const n=new Od(e);return this.mr.forEachTarget(t,(i=>n.Ar(i.sequenceNumber))).next((()=>this.mr.pr(t,(i=>n.Ar(i))))).next((()=>n.maxValue))}removeTargets(t,e,n){return this.mr.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(Wo)):this.getCacheSize(t).next((n=>n<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Wo):this.yr(t,e)))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let n,i,o,a,u,d,f;const _=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((A=>(A>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${A}`),i=this.params.maximumSequenceNumbersToCollect):i=A,a=Date.now(),this.nthSequenceNumber(t,i)))).next((A=>(n=A,u=Date.now(),this.removeTargets(t,n,e)))).next((A=>(o=A,d=Date.now(),this.removeOrphanedDocuments(t,n)))).next((A=>(f=Date.now(),Be()<=K.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-_}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${o} targets in `+(d-u)+`ms
	Removed ${A} documents in `+(f-d)+`ms
Total Duration: ${f-_}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:A}))))}}function Md(r,t){return new xd(r,t)}class Fd{constructor(){this.changes=new De((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,St.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return n!==void 0?R.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Bd{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class Ud{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.remoteDocumentCache.getEntry(t,e)))).next((i=>(n!==null&&xn(n.mutation,i,ee.empty(),ut.now()),i)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((n=>this.getLocalViewOfDocuments(t,n,W()).next((()=>n))))}getLocalViewOfDocuments(t,e,n=W()){const i=Re();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((o=>{let a=Pn();return o.forEach(((u,d)=>{a=a.insert(u,d.overlayedDocument)})),a}))))}getOverlayedDocuments(t,e){const n=Re();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,W())))}populateOverlays(t,e,n){const i=[];return n.forEach((o=>{e.has(o)||i.push(o)})),this.documentOverlayCache.getOverlays(t,i).next((o=>{o.forEach(((a,u)=>{e.set(a,u)}))}))}computeViews(t,e,n,i){let o=ge();const a=Ln(),u=(function(){return Ln()})();return e.forEach(((d,f)=>{const _=n.get(f.key);i.has(f.key)&&(_===void 0||_.mutation instanceof Hr)?o=o.insert(f.key,f):_!==void 0?(a.set(f.key,_.mutation.getFieldMask()),xn(_.mutation,f,_.mutation.getFieldMask(),ut.now())):a.set(f.key,ee.empty())})),this.recalculateAndSaveOverlays(t,o).next((d=>(d.forEach(((f,_)=>a.set(f,_))),e.forEach(((f,_)=>u.set(f,new Bd(_,a.get(f)??null)))),u)))}recalculateAndSaveOverlays(t,e){const n=Ln();let i=new it(((a,u)=>a-u)),o=W();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((a=>{for(const u of a)u.keys().forEach((d=>{const f=e.get(d);if(f===null)return;let _=n.get(d)||ee.empty();_=u.applyToLocalView(f,_),n.set(d,_);const A=(i.get(u.batchId)||W()).add(d);i=i.insert(u.batchId,A)}))})).next((()=>{const a=[],u=i.getReverseIterator();for(;u.hasNext();){const d=u.getNext(),f=d.key,_=d.value,A=tl();_.forEach((b=>{if(!o.has(b)){const C=sl(e.get(b),n.get(b));C!==null&&A.set(b,C),o=o.add(b)}})),a.push(this.documentOverlayCache.saveOverlays(t,f,A))}return R.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((n=>this.recalculateAndSaveOverlays(t,n)))}getDocumentsMatchingQuery(t,e,n,i){return(function(a){return F.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):zh(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,i):this.getDocumentsMatchingCollectionQuery(t,e,n,i)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((o=>{const a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-o.size):R.resolve(Re());let u=Un,d=o;return a.next((f=>R.forEach(f,((_,A)=>(u<A.largestBatchId&&(u=A.largestBatchId),o.get(_)?R.resolve():this.remoteDocumentCache.getEntry(t,_).next((b=>{d=d.insert(_,b)}))))).next((()=>this.populateOverlays(t,f,o))).next((()=>this.computeViews(t,d,f,W()))).next((_=>({batchId:u,changes:$h(_)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new F(e)).next((n=>{let i=Pn();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,i){const o=e.collectionGroup;let a=Pn();return this.indexManager.getCollectionParents(t,o).next((u=>R.forEach(u,(d=>{const f=(function(A,b){return new qr(b,null,A.explicitOrderBy.slice(),A.filters.slice(),A.limit,A.limitType,A.startAt,A.endAt)})(e,d.child(o));return this.getDocumentsMatchingCollectionQuery(t,f,n,i).next((_=>{_.forEach(((A,b)=>{a=a.insert(A,b)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(t,e,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,o,i)))).next((a=>{o.forEach(((d,f)=>{const _=f.getKey();a.get(_)===null&&(a=a.insert(_,St.newInvalidDocument(_)))}));let u=Pn();return a.forEach(((d,f)=>{const _=o.get(d);_!==void 0&&xn(_.mutation,f,ee.empty(),ut.now()),Gr(e,f)&&(u=u.insert(d,f))})),u}))}}class qd{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return R.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,(function(i){return{id:i.id,version:i.version,createTime:ze(i.createTime)}})(e)),R.resolve()}getNamedQuery(t,e){return R.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,(function(i){return{name:i.name,query:Vd(i.bundledQuery),readTime:ze(i.readTime)}})(e)),R.resolve()}}class jd{constructor(){this.overlays=new it(F.comparator),this.qr=new Map}getOverlay(t,e){return R.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Re();return R.forEach(e,(i=>this.getOverlay(t,i).next((o=>{o!==null&&n.set(i,o)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((i,o)=>{this.St(t,e,o)})),R.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(n)),R.resolve()}getOverlaysForCollection(t,e,n){const i=Re(),o=e.length+1,a=new F(e.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){const d=u.getNext().value,f=d.getKey();if(!e.isPrefixOf(f.path))break;f.path.length===o&&d.largestBatchId>n&&i.set(d.getKey(),d)}return R.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let o=new it(((f,_)=>f-_));const a=this.overlays.getIterator();for(;a.hasNext();){const f=a.getNext().value;if(f.getKey().getCollectionGroup()===e&&f.largestBatchId>n){let _=o.get(f.largestBatchId);_===null&&(_=Re(),o=o.insert(f.largestBatchId,_)),_.set(f.getKey(),f)}}const u=Re(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((f,_)=>u.set(f,_))),!(u.size()>=i)););return R.resolve(u)}St(t,e,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new ld(e,n));let o=this.qr.get(e);o===void 0&&(o=W(),this.qr.set(e,o)),this.qr.set(e,o.add(n.key))}}class Gd{constructor(){this.sessionToken=Tt.EMPTY_BYTE_STRING}getSessionToken(t){return R.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,R.resolve()}}class ai{constructor(){this.Qr=new mt(_t.$r),this.Ur=new mt(_t.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const n=new _t(t,e);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(t,e){t.forEach((n=>this.addReference(n,e)))}removeReference(t,e){this.Gr(new _t(t,e))}zr(t,e){t.forEach((n=>this.removeReference(n,e)))}jr(t){const e=new F(new tt([])),n=new _t(e,t),i=new _t(e,t+1),o=[];return this.Ur.forEachInRange([n,i],(a=>{this.Gr(a),o.push(a.key)})),o}Jr(){this.Qr.forEach((t=>this.Gr(t)))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new F(new tt([])),n=new _t(e,t),i=new _t(e,t+1);let o=W();return this.Ur.forEachInRange([n,i],(a=>{o=o.add(a.key)})),o}containsKey(t){const e=new _t(t,0),n=this.Qr.firstAfterOrEqual(e);return n!==null&&t.isEqual(n.key)}}class _t{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return F.comparator(t.key,e.key)||z(t.Yr,e.Yr)}static Kr(t,e){return z(t.Yr,e.Yr)||F.comparator(t.key,e.key)}}class zd{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new mt(_t.$r)}checkEmpty(t){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new ad(o,e,n,i);this.mutationQueue.push(a);for(const u of i)this.Zr=this.Zr.add(new _t(u.key,o)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast());return R.resolve(a)}lookupMutationBatch(t,e){return R.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.ei(n),o=i<0?0:i;return R.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?wh:this.tr-1)}getAllMutationBatches(t){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new _t(e,0),i=new _t(e,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],(a=>{const u=this.Xr(a.Yr);o.push(u)})),R.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new mt(z);return e.forEach((i=>{const o=new _t(i,0),a=new _t(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],(u=>{n=n.add(u.Yr)}))})),R.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let o=n;F.isDocumentKey(o)||(o=o.child(""));const a=new _t(new F(o),0);let u=new mt(z);return this.Zr.forEachWhile((d=>{const f=d.key.path;return!!n.isPrefixOf(f)&&(f.length===i&&(u=u.add(d.Yr)),!0)}),a),R.resolve(this.ti(u))}ti(t){const e=[];return t.forEach((n=>{const i=this.Xr(n);i!==null&&e.push(i)})),e}removeMutationBatch(t,e){et(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return R.forEach(e.mutations,(i=>{const o=new _t(i.key,e.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.Zr=n}))}ir(t){}containsKey(t,e){const n=new _t(e,0),i=this.Zr.firstAfterOrEqual(n);return R.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,R.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Hd{constructor(t){this.ri=t,this.docs=(function(){return new it(F.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),o=i?i.size:0,a=this.ri(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return R.resolve(n?n.document.mutableCopy():St.newInvalidDocument(e))}getEntries(t,e){let n=ge();return e.forEach((i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():St.newInvalidDocument(i))})),R.resolve(n)}getDocumentsMatchingQuery(t,e,n,i){let o=ge();const a=e.path,u=new F(a.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(u);for(;d.hasNext();){const{key:f,value:{document:_}}=d.getNext();if(!a.isPrefixOf(f.path))break;f.path.length>a.length+1||_h(yh(_),n)<=0||(i.has(_.key)||Gr(e,_))&&(o=o.insert(_.key,_.mutableCopy()))}return R.resolve(o)}getAllFromCollectionGroup(t,e,n,i){j(9500)}ii(t,e){return R.forEach(this.docs,(n=>e(n)))}newChangeBuffer(t){return new Kd(this)}getSize(t){return R.resolve(this.size)}}class Kd extends Fd{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.Nr.addEntry(t,i)):this.Nr.removeEntry(n)})),R.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}class Qd{constructor(t){this.persistence=t,this.si=new De((e=>ei(e)),ni),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.oi=0,this._i=new ai,this.targetCount=0,this.ai=Xe.ur()}forEachTarget(t,e){return this.si.forEach(((n,i)=>e(i))),R.resolve()}getLastRemoteSnapshotVersion(t){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return R.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.oi&&(this.oi=e),R.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new Xe(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,R.resolve()}updateTargetData(t,e){return this.Pr(e),R.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,R.resolve()}removeTargets(t,e,n){let i=0;const o=[];return this.si.forEach(((a,u)=>{u.sequenceNumber<=e&&n.get(u.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(t,u.targetId)),i++)})),R.waitFor(o).next((()=>i))}getTargetCount(t){return R.resolve(this.targetCount)}getTargetData(t,e){const n=this.si.get(e)||null;return R.resolve(n)}addMatchingKeys(t,e,n){return this._i.Wr(e,n),R.resolve()}removeMatchingKeys(t,e,n){this._i.zr(e,n);const i=this.persistence.referenceDelegate,o=[];return i&&e.forEach((a=>{o.push(i.markPotentiallyOrphaned(t,a))})),R.waitFor(o)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),R.resolve()}getMatchingKeysForTargetId(t,e){const n=this._i.Hr(e);return R.resolve(n)}containsKey(t,e){return R.resolve(this._i.containsKey(e))}}class pl{constructor(t,e){this.ui={},this.overlays={},this.ci=new Fr(0),this.li=!1,this.li=!0,this.hi=new Gd,this.referenceDelegate=t(this),this.Pi=new Qd(this),this.indexManager=new Dd,this.remoteDocumentCache=(function(i){return new Hd(i)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new Pd(e),this.Ii=new qd(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new jd,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.ui[t.toKey()];return n||(n=new zd(e,this.referenceDelegate),this.ui[t.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,n){O("MemoryPersistence","Starting transaction:",t);const i=new Wd(this.ci.next());return this.referenceDelegate.Ei(),n(i).next((o=>this.referenceDelegate.di(i).next((()=>o)))).toPromise().then((o=>(i.raiseOnCommittedEvent(),o)))}Ai(t,e){return R.or(Object.values(this.ui).map((n=>()=>n.containsKey(t,e))))}}class Wd extends vh{constructor(t){super(),this.currentSequenceNumber=t}}class li{constructor(t){this.persistence=t,this.Ri=new ai,this.Vi=null}static mi(t){return new li(t)}get fi(){if(this.Vi)return this.Vi;throw j(60996)}addReference(t,e,n){return this.Ri.addReference(n,e),this.fi.delete(n.toString()),R.resolve()}removeReference(t,e,n){return this.Ri.removeReference(n,e),this.fi.add(n.toString()),R.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),R.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach((i=>this.fi.add(i.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((i=>{i.forEach((o=>this.fi.add(o.toString())))})).next((()=>n.removeTargetData(t,e)))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.fi,(n=>{const i=F.fromPath(n);return this.gi(t,i).next((o=>{o||e.removeEntry(i,q.min())}))})).next((()=>(this.Vi=null,e.apply(t))))}updateLimboDocument(t,e){return this.gi(t,e).next((n=>{n?this.fi.delete(e.toString()):this.fi.add(e.toString())}))}Ti(t){return 0}gi(t,e){return R.or([()=>R.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class kr{constructor(t,e){this.persistence=t,this.pi=new De((n=>Ih(n.path)),((n,i)=>n.isEqual(i))),this.garbageCollector=Md(this,e)}static mi(t,e){return new kr(t,e)}Ei(){}di(t){return R.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next((n=>e.next((i=>n+i))))}wr(t){let e=0;return this.pr(t,(n=>{e++})).next((()=>e))}pr(t,e){return R.forEach(this.pi,((n,i)=>this.br(t,n,i).next((o=>o?R.resolve():e(i)))))}removeTargets(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)}removeOrphanedDocuments(t,e){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(t,(a=>this.br(t,a,e).next((u=>{u||(n++,o.removeEntry(a,q.min()))})))).next((()=>o.apply(t))).next((()=>n))}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),R.resolve()}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,e,n){return this.pi.set(n,t.currentSequenceNumber),R.resolve()}removeReference(t,e,n){return this.pi.set(n,t.currentSequenceNumber),R.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),R.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=Er(t.data.value)),e}br(t,e,n){return R.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const i=this.pi.get(e);return R.resolve(i!==void 0&&i>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class ci{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Es=n,this.ds=i}static As(t,e){let n=W(),i=W();for(const o of e.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new ci(t,e.fromCache,n,i)}}class $d{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class Yd{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Mc()?8:Th(Lc())>0?6:4})()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,n,i){const o={result:null};return this.ys(t,e).next((a=>{o.result=a})).next((()=>{if(!o.result)return this.ws(t,e,i,n).next((a=>{o.result=a}))})).next((()=>{if(o.result)return;const a=new $d;return this.Ss(t,e,a).next((u=>{if(o.result=u,this.Vs)return this.bs(t,e,a,u.size)}))})).next((()=>o.result))}bs(t,e,n,i){return n.documentReadCount<this.fs?(Be()<=K.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",Ue(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),R.resolve()):(Be()<=K.DEBUG&&O("QueryEngine","Query:",Ue(e),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(Be()<=K.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",Ue(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ut(e))):R.resolve())}ys(t,e){if(Fo(e))return R.resolve(null);let n=Ut(e);return this.indexManager.getIndexType(t,n).next((i=>i===0?null:(e.limit!==null&&i===1&&(e=Fs(e,null,"F"),n=Ut(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((o=>{const a=W(...o);return this.ps.getDocuments(t,a).next((u=>this.indexManager.getMinOffset(t,n).next((d=>{const f=this.Ds(e,u);return this.Cs(e,f,a,d.readTime)?this.ys(t,Fs(e,null,"F")):this.vs(t,f,e,d)}))))})))))}ws(t,e,n,i){return Fo(e)||i.isEqual(q.min())?R.resolve(null):this.ps.getDocuments(t,n).next((o=>{const a=this.Ds(e,o);return this.Cs(e,a,n,i)?R.resolve(null):(Be()<=K.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ue(e)),this.vs(t,a,e,ph(i,Un)).next((u=>u)))}))}Ds(t,e){let n=new mt(Ja(t));return e.forEach(((i,o)=>{Gr(t,o)&&(n=n.add(o))})),n}Cs(t,e,n,i){if(t.limit===null)return!1;if(n.size!==e.size)return!0;const o=t.limitType==="F"?e.last():e.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(t,e,n){return Be()<=K.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",Ue(e)),this.ps.getDocumentsMatchingQuery(t,e,ue.min(),n)}vs(t,e,n,i){return this.ps.getDocumentsMatchingQuery(t,n,i).next((o=>(e.forEach((a=>{o=o.insert(a.key,a)})),o)))}}const ui="LocalStore",Xd=3e8;class Jd{constructor(t,e,n,i){this.persistence=t,this.Fs=e,this.serializer=i,this.Ms=new it(z),this.xs=new De((o=>ei(o)),ni),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(n)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Ud(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ms)))}}function Zd(r,t,e,n){return new Jd(r,t,e,n)}async function yl(r,t){const e=Q(r);return await e.persistence.runTransaction("Handle user change","readonly",(n=>{let i;return e.mutationQueue.getAllMutationBatches(n).next((o=>(i=o,e.Bs(t),e.mutationQueue.getAllMutationBatches(n)))).next((o=>{const a=[],u=[];let d=W();for(const f of i){a.push(f.batchId);for(const _ of f.mutations)d=d.add(_.key)}for(const f of o){u.push(f.batchId);for(const _ of f.mutations)d=d.add(_.key)}return e.localDocuments.getDocuments(n,d).next((f=>({Ls:f,removedBatchIds:a,addedBatchIds:u})))}))}))}function _l(r){const t=Q(r);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function tf(r,t){const e=Q(r),n=t.snapshotVersion;let i=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const a=e.Ns.newChangeBuffer({trackRemovals:!0});i=e.Ms;const u=[];t.targetChanges.forEach(((_,A)=>{const b=i.get(A);if(!b)return;u.push(e.Pi.removeMatchingKeys(o,_.removedDocuments,A).next((()=>e.Pi.addMatchingKeys(o,_.addedDocuments,A))));let C=b.withSequenceNumber(o.currentSequenceNumber);t.targetMismatches.get(A)!==null?C=C.withResumeToken(Tt.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):_.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(_.resumeToken,n)),i=i.insert(A,C),(function(U,L,Y){return U.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=Xd?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0})(b,C,_)&&u.push(e.Pi.updateTargetData(o,C))}));let d=ge(),f=W();if(t.documentUpdates.forEach((_=>{t.resolvedLimboDocuments.has(_)&&u.push(e.persistence.referenceDelegate.updateLimboDocument(o,_))})),u.push(ef(o,a,t.documentUpdates).next((_=>{d=_.ks,f=_.qs}))),!n.isEqual(q.min())){const _=e.Pi.getLastRemoteSnapshotVersion(o).next((A=>e.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n)));u.push(_)}return R.waitFor(u).next((()=>a.apply(o))).next((()=>e.localDocuments.getLocalViewOfDocuments(o,d,f))).next((()=>d))})).then((o=>(e.Ms=i,o)))}function ef(r,t,e){let n=W(),i=W();return e.forEach((o=>n=n.add(o))),t.getEntries(r,n).next((o=>{let a=ge();return e.forEach(((u,d)=>{const f=o.get(u);d.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(u)),d.isNoDocument()&&d.version.isEqual(q.min())?(t.removeEntry(u,d.readTime),a=a.insert(u,d)):!f.isValidDocument()||d.version.compareTo(f.version)>0||d.version.compareTo(f.version)===0&&f.hasPendingWrites?(t.addEntry(d),a=a.insert(u,d)):O(ui,"Ignoring outdated watch update for ",u,". Current version:",f.version," Watch version:",d.version)})),{ks:a,qs:i}}))}function nf(r,t){const e=Q(r);return e.persistence.runTransaction("Allocate target","readwrite",(n=>{let i;return e.Pi.getTargetData(n,t).next((o=>o?(i=o,R.resolve(i)):e.Pi.allocateTargetId(n).next((a=>(i=new ne(t,a,"TargetPurposeListen",n.currentSequenceNumber),e.Pi.addTargetData(n,i).next((()=>i)))))))})).then((n=>{const i=e.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(n.targetId,n),e.xs.set(t,n.targetId)),n}))}async function Gs(r,t,e){const n=Q(r),i=n.Ms.get(t),o=e?"readwrite":"readwrite-primary";try{e||await n.persistence.runTransaction("Release target",o,(a=>n.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!nn(a))throw a;O(ui,`Failed to update sequence numbers for target ${t}: ${a}`)}n.Ms=n.Ms.remove(t),n.xs.delete(i.target)}function Xo(r,t,e){const n=Q(r);let i=q.min(),o=W();return n.persistence.runTransaction("Execute query","readwrite",(a=>(function(d,f,_){const A=Q(d),b=A.xs.get(_);return b!==void 0?R.resolve(A.Ms.get(b)):A.Pi.getTargetData(f,_)})(n,a,Ut(t)).next((u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,u.targetId).next((d=>{o=d}))})).next((()=>n.Fs.getDocumentsMatchingQuery(a,t,e?i:q.min(),e?o:W()))).next((u=>(rf(n,Kh(t),u),{documents:u,Qs:o})))))}function rf(r,t,e){let n=r.Os.get(t)||q.min();e.forEach(((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)})),r.Os.set(t,n)}class Jo{constructor(){this.activeTargetIds=Jh()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class sf{constructor(){this.Mo=new Jo,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,n){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new Jo,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class of{Oo(t){}shutdown(){}}const Zo="ConnectivityMonitor";class ta{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){O(Zo,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){O(Zo,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let yr=null;function zs(){return yr===null?yr=(function(){return 268435456+Math.round(2147483648*Math.random())})():yr++,"0x"+yr.toString(16)}const Ts="RestConnection",af={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class lf{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===Cr?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(t,e,n,i,o){const a=zs(),u=this.zo(t,e.toUriEncodedString());O(Ts,`Sending RPC '${t}' ${a}:`,u,n);const d={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(d,i,o);const{host:f}=new URL(u),_=$s(f);return this.Jo(t,u,d,n,_).then((A=>(O(Ts,`Received RPC '${t}' ${a}: `,A),A)),(A=>{throw Qe(Ts,`RPC '${t}' ${a} failed with error: `,A,"url: ",u,"request:",n),A}))}Ho(t,e,n,i,o,a){return this.Go(t,e,n,i,o)}jo(t,e,n){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+en})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((i,o)=>t[o]=i)),n&&n.headers.forEach(((i,o)=>t[o]=i))}zo(t,e){const n=af[t];return`${this.Uo}/v1/${e}:${n}`}terminate(){}}class cf{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}const It="WebChannelConnection";class uf extends lf{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,n,i,o){const a=zs();return new Promise(((u,d)=>{const f=new Da;f.setWithCredentials(!0),f.listenOnce(Na.COMPLETE,(()=>{try{switch(f.getLastErrorCode()){case _r.NO_ERROR:const A=f.getResponseJson();O(It,`XHR for RPC '${t}' ${a} received:`,JSON.stringify(A)),u(A);break;case _r.TIMEOUT:O(It,`RPC '${t}' ${a} timed out`),d(new x(P.DEADLINE_EXCEEDED,"Request time out"));break;case _r.HTTP_ERROR:const b=f.getStatus();if(O(It,`RPC '${t}' ${a} failed with status:`,b,"response text:",f.getResponseText()),b>0){let C=f.getResponseJson();Array.isArray(C)&&(C=C[0]);const B=C?.error;if(B&&B.status&&B.message){const U=(function(Y){const $=Y.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf($)>=0?$:P.UNKNOWN})(B.status);d(new x(U,B.message))}else d(new x(P.UNKNOWN,"Server responded with status "+f.getStatus()))}else d(new x(P.UNAVAILABLE,"Connection failed."));break;default:j(9055,{l_:t,streamId:a,h_:f.getLastErrorCode(),P_:f.getLastError()})}}finally{O(It,`RPC '${t}' ${a} completed.`)}}));const _=JSON.stringify(i);O(It,`RPC '${t}' ${a} sending request:`,i),f.send(e,"POST",_,n,15)}))}T_(t,e,n){const i=zs(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=La(),u=Oa(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(d.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(d.useFetchStreams=!0),this.jo(d.initMessageHeaders,e,n),d.encodeInitMessageHeaders=!0;const _=o.join("");O(It,`Creating RPC '${t}' stream ${i}: ${_}`,d);const A=a.createWebChannel(_,d);this.I_(A);let b=!1,C=!1;const B=new cf({Yo:L=>{C?O(It,`Not sending because RPC '${t}' stream ${i} is closed:`,L):(b||(O(It,`Opening RPC '${t}' stream ${i} transport.`),A.open(),b=!0),O(It,`RPC '${t}' stream ${i} sending:`,L),A.send(L))},Zo:()=>A.close()}),U=(L,Y,$)=>{L.listen(Y,(X=>{try{$(X)}catch(Et){setTimeout((()=>{throw Et}),0)}}))};return U(A,Cn.EventType.OPEN,(()=>{C||(O(It,`RPC '${t}' stream ${i} transport opened.`),B.o_())})),U(A,Cn.EventType.CLOSE,(()=>{C||(C=!0,O(It,`RPC '${t}' stream ${i} transport closed`),B.a_(),this.E_(A))})),U(A,Cn.EventType.ERROR,(L=>{C||(C=!0,Qe(It,`RPC '${t}' stream ${i} transport errored. Name:`,L.name,"Message:",L.message),B.a_(new x(P.UNAVAILABLE,"The operation could not be completed")))})),U(A,Cn.EventType.MESSAGE,(L=>{if(!C){const Y=L.data[0];et(!!Y,16349);const $=Y,X=$?.error||$[0]?.error;if(X){O(It,`RPC '${t}' stream ${i} received error:`,X);const Et=X.status;let wt=(function(m){const g=ct[m];if(g!==void 0)return ol(g)})(Et),ot=X.message;wt===void 0&&(wt=P.INTERNAL,ot="Unknown error status: "+Et+" with message "+X.message),C=!0,B.a_(new x(wt,ot)),A.close()}else O(It,`RPC '${t}' stream ${i} received:`,Y),B.u_(Y)}})),U(u,ka.STAT_EVENT,(L=>{L.stat===Vs.PROXY?O(It,`RPC '${t}' stream ${i} detected buffering proxy`):L.stat===Vs.NOPROXY&&O(It,`RPC '${t}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{B.__()}),0),B}terminate(){this.c_.forEach((t=>t.close())),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter((e=>e===t))}}function ws(){return typeof document<"u"?document:null}function El(r){return new pd(r,!0)}class vl{constructor(t,e,n=1e3,i=1.5,o=6e4){this.Mi=t,this.timerId=e,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,e-n);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),t()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const ea="PersistentStream";class hf{constructor(t,e,n,i,o,a,u,d){this.Mi=t,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new vl(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===P.RESOURCE_EXHAUSTED?(Ht(e.toString()),Ht("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,i])=>{this.D_===e&&this.G_(n,i)}),(n=>{t((()=>{const i=new x(P.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)}))}))}G_(t,e){const n=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{n((()=>this.z_(i)))})),this.stream.onMessage((i=>{n((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return O(ea,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget((()=>this.D_===t?e():(O(ea,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class df extends hf{constructor(t,e,n,i,o,a){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,a),this.serializer=o}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=Td(this.serializer,t),n=(function(o){if(!("targetChange"in o))return q.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?q.min():a.readTime?ze(a.readTime):q.min()})(t);return this.listener.H_(e,n)}Y_(t){const e={};e.database=Qo(this.serializer),e.addTarget=(function(o,a){let u;const d=a.target;if(u=Ms(d)?{documents:wd(o,d)}:{query:Id(o,d).ft},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=_d(o,a.resumeToken);const f=qs(o,a.expectedCount);f!==null&&(u.expectedCount=f)}else if(a.snapshotVersion.compareTo(q.min())>0){u.readTime=yd(o,a.snapshotVersion.toTimestamp());const f=qs(o,a.expectedCount);f!==null&&(u.expectedCount=f)}return u})(this.serializer,t);const n=Sd(this.serializer,t);n&&(e.labels=n),this.q_(e)}Z_(t){const e={};e.database=Qo(this.serializer),e.removeTarget=t,this.q_(e)}}class ff{}class gf extends ff{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new x(P.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Go(t,js(e,n),i,o,a))).catch((o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new x(P.UNKNOWN,o.toString())}))}Ho(t,e,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,u])=>this.connection.Ho(t,js(e,n),i,a,u,o))).catch((a=>{throw a.name==="FirebaseError"?(a.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new x(P.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class mf{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ht(e),this.aa=!1):O("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Je="RemoteStore";class pf{constructor(t,e,n,i,o){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((a=>{n.enqueueAndForget((async()=>{Wn(this)&&(O(Je,"Restarting streams for network reachability change."),await(async function(d){const f=Q(d);f.Ea.add(4),await Qn(f),f.Ra.set("Unknown"),f.Ea.delete(4),await Qr(f)})(this))}))})),this.Ra=new mf(n,i)}}async function Qr(r){if(Wn(r))for(const t of r.da)await t(!0)}async function Qn(r){for(const t of r.da)await t(!1)}function Tl(r,t){const e=Q(r);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),gi(e)?fi(e):rn(e).O_()&&di(e,t))}function hi(r,t){const e=Q(r),n=rn(e);e.Ia.delete(t),n.O_()&&wl(e,t),e.Ia.size===0&&(n.O_()?n.L_():Wn(e)&&e.Ra.set("Unknown"))}function di(r,t){if(r.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(q.min())>0){const e=r.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}rn(r).Y_(t)}function wl(r,t){r.Va.Ue(t),rn(r).Z_(t)}function fi(r){r.Va=new dd({getRemoteKeysForTarget:t=>r.remoteSyncer.getRemoteKeysForTarget(t),At:t=>r.Ia.get(t)||null,ht:()=>r.datastore.serializer.databaseId}),rn(r).start(),r.Ra.ua()}function gi(r){return Wn(r)&&!rn(r).x_()&&r.Ia.size>0}function Wn(r){return Q(r).Ea.size===0}function Il(r){r.Va=void 0}async function yf(r){r.Ra.set("Online")}async function _f(r){r.Ia.forEach(((t,e)=>{di(r,t)}))}async function Ef(r,t){Il(r),gi(r)?(r.Ra.ha(t),fi(r)):r.Ra.set("Unknown")}async function vf(r,t,e){if(r.Ra.set("Online"),t instanceof ll&&t.state===2&&t.cause)try{await(async function(i,o){const a=o.cause;for(const u of o.targetIds)i.Ia.has(u)&&(await i.remoteSyncer.rejectListen(u,a),i.Ia.delete(u),i.Va.removeTarget(u))})(r,t)}catch(n){O(Je,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await na(r,n)}else if(t instanceof Tr?r.Va.Ze(t):t instanceof al?r.Va.st(t):r.Va.tt(t),!e.isEqual(q.min()))try{const n=await _l(r.localStore);e.compareTo(n)>=0&&await(function(o,a){const u=o.Va.Tt(a);return u.targetChanges.forEach(((d,f)=>{if(d.resumeToken.approximateByteSize()>0){const _=o.Ia.get(f);_&&o.Ia.set(f,_.withResumeToken(d.resumeToken,a))}})),u.targetMismatches.forEach(((d,f)=>{const _=o.Ia.get(d);if(!_)return;o.Ia.set(d,_.withResumeToken(Tt.EMPTY_BYTE_STRING,_.snapshotVersion)),wl(o,d);const A=new ne(_.target,d,f,_.sequenceNumber);di(o,A)})),o.remoteSyncer.applyRemoteEvent(u)})(r,e)}catch(n){O(Je,"Failed to raise snapshot:",n),await na(r,n)}}async function na(r,t,e){if(!nn(t))throw t;r.Ea.add(1),await Qn(r),r.Ra.set("Offline"),e||(e=()=>_l(r.localStore)),r.asyncQueue.enqueueRetryable((async()=>{O(Je,"Retrying IndexedDB access"),await e(),r.Ea.delete(1),await Qr(r)}))}async function ra(r,t){const e=Q(r);e.asyncQueue.verifyOperationInProgress(),O(Je,"RemoteStore received new credentials");const n=Wn(e);e.Ea.add(3),await Qn(e),n&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await Qr(e)}async function Tf(r,t){const e=Q(r);t?(e.Ea.delete(2),await Qr(e)):t||(e.Ea.add(2),await Qn(e),e.Ra.set("Unknown"))}function rn(r){return r.ma||(r.ma=(function(e,n,i){const o=Q(e);return o.sa(),new df(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(r.datastore,r.asyncQueue,{Xo:yf.bind(null,r),t_:_f.bind(null,r),r_:Ef.bind(null,r),H_:vf.bind(null,r)}),r.da.push((async t=>{t?(r.ma.B_(),gi(r)?fi(r):r.Ra.set("Unknown")):(await r.ma.stop(),Il(r))}))),r.ma}class mi{constructor(t,e,n,i,o){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new oe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,i,o){const a=Date.now()+n,u=new mi(t,e,a,i,o);return u.start(n),u}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(P.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Al(r,t){if(Ht("AsyncQueue",`${t}: ${r}`),nn(r))return new x(P.UNAVAILABLE,`${t}: ${r}`);throw r}class He{static emptySet(t){return new He(t.comparator)}constructor(t){this.comparator=t?(e,n)=>t(e,n)||F.comparator(e.key,n.key):(e,n)=>F.comparator(e.key,n.key),this.keyedMap=Pn(),this.sortedSet=new it(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof He)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const i=e.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const n=new He;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class sa{constructor(){this.ga=new it(F.comparator)}track(t){const e=t.doc.key,n=this.ga.get(e);n?t.type!==0&&n.type===3?this.ga=this.ga.insert(e,t):t.type===3&&n.type!==1?this.ga=this.ga.insert(e,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.ga=this.ga.remove(e):t.type===1&&n.type===2?this.ga=this.ga.insert(e,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):j(63341,{Rt:t,pa:n}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Ze{constructor(t,e,n,i,o,a,u,d,f){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=d,this.hasCachedResults=f}static fromInitialDocuments(t,e,n,i,o){const a=[];return e.forEach((u=>{a.push({type:0,doc:u})})),new Ze(t,e,He.emptySet(e),a,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&jr(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0}}class wf{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((t=>t.Da()))}}class If{constructor(){this.queries=ia(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,n){const i=Q(e),o=i.queries;i.queries=ia(),o.forEach(((a,u)=>{for(const d of u.Sa)d.onError(n)}))})(this,new x(P.ABORTED,"Firestore shutting down"))}}function ia(){return new De((r=>Xa(r)),jr)}async function Sl(r,t){const e=Q(r);let n=3;const i=t.query;let o=e.queries.get(i);o?!o.ba()&&t.Da()&&(n=2):(o=new wf,n=t.Da()?0:1);try{switch(n){case 0:o.wa=await e.onListen(i,!0);break;case 1:o.wa=await e.onListen(i,!1);break;case 2:await e.onFirstRemoteStoreListen(i)}}catch(a){const u=Al(a,`Initialization of query '${Ue(t.query)}' failed`);return void t.onError(u)}e.queries.set(i,o),o.Sa.push(t),t.va(e.onlineState),o.wa&&t.Fa(o.wa)&&pi(e)}async function bl(r,t){const e=Q(r),n=t.query;let i=3;const o=e.queries.get(n);if(o){const a=o.Sa.indexOf(t);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?i=t.Da()?0:1:!o.ba()&&t.Da()&&(i=2))}switch(i){case 0:return e.queries.delete(n),e.onUnlisten(n,!0);case 1:return e.queries.delete(n),e.onUnlisten(n,!1);case 2:return e.onLastRemoteStoreUnlisten(n);default:return}}function Af(r,t){const e=Q(r);let n=!1;for(const i of t){const o=i.query,a=e.queries.get(o);if(a){for(const u of a.Sa)u.Fa(i)&&(n=!0);a.wa=i}}n&&pi(e)}function Sf(r,t,e){const n=Q(r),i=n.queries.get(t);if(i)for(const o of i.Sa)o.onError(e);n.queries.delete(t)}function pi(r){r.Ca.forEach((t=>{t.next()}))}var Hs,oa;(oa=Hs||(Hs={})).Ma="default",oa.Cache="cache";class Rl{constructor(t,e,n){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(t){if(!this.options.includeMetadataChanges){const n=[];for(const i of t.docChanges)i.type!==3&&n.push(i);t=new Ze(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const n=e!=="Offline";return(!this.options.qa||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Ze.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==Hs.Cache}}class Cl{constructor(t){this.key=t}}class Pl{constructor(t){this.key=t}}class bf{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=W(),this.mutatedKeys=W(),this.eu=Ja(t),this.tu=new He(this.eu)}get nu(){return this.Ya}ru(t,e){const n=e?e.iu:new sa,i=e?e.tu:this.tu;let o=e?e.mutatedKeys:this.mutatedKeys,a=i,u=!1;const d=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((_,A)=>{const b=i.get(_),C=Gr(this.query,A)?A:null,B=!!b&&this.mutatedKeys.has(b.key),U=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let L=!1;b&&C?b.data.isEqual(C.data)?B!==U&&(n.track({type:3,doc:C}),L=!0):this.su(b,C)||(n.track({type:2,doc:C}),L=!0,(d&&this.eu(C,d)>0||f&&this.eu(C,f)<0)&&(u=!0)):!b&&C?(n.track({type:0,doc:C}),L=!0):b&&!C&&(n.track({type:1,doc:b}),L=!0,(d||f)&&(u=!0)),L&&(C?(a=a.add(C),o=U?o.add(_):o.delete(_)):(a=a.delete(_),o=o.delete(_)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const _=this.query.limitType==="F"?a.last():a.first();a=a.delete(_.key),o=o.delete(_.key),n.track({type:1,doc:_})}return{tu:a,iu:n,Cs:u,mutatedKeys:o}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,i){const o=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const a=t.iu.ya();a.sort(((_,A)=>(function(C,B){const U=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return j(20277,{Rt:L})}};return U(C)-U(B)})(_.type,A.type)||this.eu(_.doc,A.doc))),this.ou(n),i=i??!1;const u=e&&!i?this._u():[],d=this.Xa.size===0&&this.current&&!i?1:0,f=d!==this.Za;return this.Za=d,a.length!==0||f?{snapshot:new Ze(this.query,t.tu,o,a,t.mutatedKeys,d===0,f,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new sa,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=W(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const e=[];return t.forEach((n=>{this.Xa.has(n)||e.push(new Pl(n))})),this.Xa.forEach((n=>{t.has(n)||e.push(new Cl(n))})),e}cu(t){this.Ya=t.Qs,this.Xa=W();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Ze.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const yi="SyncEngine";class Rf{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Cf{constructor(t){this.key=t,this.hu=!1}}class Pf{constructor(t,e,n,i,o,a){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new De((u=>Xa(u)),jr),this.Iu=new Map,this.Eu=new Set,this.du=new it(F.comparator),this.Au=new Map,this.Ru=new ai,this.Vu={},this.mu=new Map,this.fu=Xe.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Vf(r,t,e=!0){const n=Ol(r);let i;const o=n.Tu.get(t);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await Vl(n,t,e,!0),i}async function Df(r,t){const e=Ol(r);await Vl(e,t,!0,!1)}async function Vl(r,t,e,n){const i=await nf(r.localStore,Ut(t)),o=i.targetId,a=r.sharedClientState.addLocalQueryTarget(o,e);let u;return n&&(u=await Nf(r,t,o,a==="current",i.resumeToken)),r.isPrimaryClient&&e&&Tl(r.remoteStore,i),u}async function Nf(r,t,e,n,i){r.pu=(A,b,C)=>(async function(U,L,Y,$){let X=L.view.ru(Y);X.Cs&&(X=await Xo(U.localStore,L.query,!1).then((({documents:v})=>L.view.ru(v,X))));const Et=$&&$.targetChanges.get(L.targetId),wt=$&&$.targetMismatches.get(L.targetId)!=null,ot=L.view.applyChanges(X,U.isPrimaryClient,Et,wt);return la(U,L.targetId,ot.au),ot.snapshot})(r,A,b,C);const o=await Xo(r.localStore,t,!0),a=new bf(t,o.Qs),u=a.ru(o.documents),d=Kn.createSynthesizedTargetChangeForCurrentChange(e,n&&r.onlineState!=="Offline",i),f=a.applyChanges(u,r.isPrimaryClient,d);la(r,e,f.au);const _=new Rf(t,e,a);return r.Tu.set(t,_),r.Iu.has(e)?r.Iu.get(e).push(t):r.Iu.set(e,[t]),f.snapshot}async function kf(r,t,e){const n=Q(r),i=n.Tu.get(t),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter((a=>!jr(a,t)))),void n.Tu.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Gs(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),e&&hi(n.remoteStore,i.targetId),Ks(n,i.targetId)})).catch(Mr)):(Ks(n,i.targetId),await Gs(n.localStore,i.targetId,!0))}async function Of(r,t){const e=Q(r),n=e.Tu.get(t),i=e.Iu.get(n.targetId);e.isPrimaryClient&&i.length===1&&(e.sharedClientState.removeLocalQueryTarget(n.targetId),hi(e.remoteStore,n.targetId))}async function Dl(r,t){const e=Q(r);try{const n=await tf(e.localStore,t);t.targetChanges.forEach(((i,o)=>{const a=e.Au.get(o);a&&(et(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?et(a.hu,14607):i.removedDocuments.size>0&&(et(a.hu,42227),a.hu=!1))})),await kl(e,n,t)}catch(n){await Mr(n)}}function aa(r,t,e){const n=Q(r);if(n.isPrimaryClient&&e===0||!n.isPrimaryClient&&e===1){const i=[];n.Tu.forEach(((o,a)=>{const u=a.view.va(t);u.snapshot&&i.push(u.snapshot)})),(function(a,u){const d=Q(a);d.onlineState=u;let f=!1;d.queries.forEach(((_,A)=>{for(const b of A.Sa)b.va(u)&&(f=!0)})),f&&pi(d)})(n.eventManager,t),i.length&&n.Pu.H_(i),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function Lf(r,t,e){const n=Q(r);n.sharedClientState.updateQueryState(t,"rejected",e);const i=n.Au.get(t),o=i&&i.key;if(o){let a=new it(F.comparator);a=a.insert(o,St.newNoDocument(o,q.min()));const u=W().add(o),d=new Kr(q.min(),new Map,new it(z),a,u);await Dl(n,d),n.du=n.du.remove(o),n.Au.delete(t),_i(n)}else await Gs(n.localStore,t,!1).then((()=>Ks(n,t,e))).catch(Mr)}function Ks(r,t,e=null){r.sharedClientState.removeLocalQueryTarget(t);for(const n of r.Iu.get(t))r.Tu.delete(n),e&&r.Pu.yu(n,e);r.Iu.delete(t),r.isPrimaryClient&&r.Ru.jr(t).forEach((n=>{r.Ru.containsKey(n)||Nl(r,n)}))}function Nl(r,t){r.Eu.delete(t.path.canonicalString());const e=r.du.get(t);e!==null&&(hi(r.remoteStore,e),r.du=r.du.remove(t),r.Au.delete(e),_i(r))}function la(r,t,e){for(const n of e)n instanceof Cl?(r.Ru.addReference(n.key,t),xf(r,n)):n instanceof Pl?(O(yi,"Document no longer in limbo: "+n.key),r.Ru.removeReference(n.key,t),r.Ru.containsKey(n.key)||Nl(r,n.key)):j(19791,{wu:n})}function xf(r,t){const e=t.key,n=e.path.canonicalString();r.du.get(e)||r.Eu.has(n)||(O(yi,"New document in limbo: "+e),r.Eu.add(n),_i(r))}function _i(r){for(;r.Eu.size>0&&r.du.size<r.maxConcurrentLimboResolutions;){const t=r.Eu.values().next().value;r.Eu.delete(t);const e=new F(tt.fromString(t)),n=r.fu.next();r.Au.set(n,new Cf(e)),r.du=r.du.insert(e,n),Tl(r.remoteStore,new ne(Ut(ri(e.path)),n,"TargetPurposeLimboResolution",Fr.ce))}}async function kl(r,t,e){const n=Q(r),i=[],o=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,d)=>{a.push(n.pu(d,t,e).then((f=>{if((f||e)&&n.isPrimaryClient){const _=f?!f.fromCache:e?.targetChanges.get(d.targetId)?.current;n.sharedClientState.updateQueryState(d.targetId,_?"current":"not-current")}if(f){i.push(f);const _=ci.As(d.targetId,f);o.push(_)}})))})),await Promise.all(a),n.Pu.H_(i),await(async function(d,f){const _=Q(d);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(A=>R.forEach(f,(b=>R.forEach(b.Es,(C=>_.persistence.referenceDelegate.addReference(A,b.targetId,C))).next((()=>R.forEach(b.ds,(C=>_.persistence.referenceDelegate.removeReference(A,b.targetId,C)))))))))}catch(A){if(!nn(A))throw A;O(ui,"Failed to update sequence numbers: "+A)}for(const A of f){const b=A.targetId;if(!A.fromCache){const C=_.Ms.get(b),B=C.snapshotVersion,U=C.withLastLimboFreeSnapshotVersion(B);_.Ms=_.Ms.insert(b,U)}}})(n.localStore,o))}async function Mf(r,t){const e=Q(r);if(!e.currentUser.isEqual(t)){O(yi,"User change. New user:",t.toKey());const n=await yl(e.localStore,t);e.currentUser=t,(function(o,a){o.mu.forEach((u=>{u.forEach((d=>{d.reject(new x(P.CANCELLED,a))}))})),o.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await kl(e,n.Ls)}}function Ff(r,t){const e=Q(r),n=e.Au.get(t);if(n&&n.hu)return W().add(n.key);{let i=W();const o=e.Iu.get(t);if(!o)return i;for(const a of o){const u=e.Tu.get(a);i=i.unionWith(u.view.nu)}return i}}function Ol(r){const t=Q(r);return t.remoteStore.remoteSyncer.applyRemoteEvent=Dl.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ff.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Lf.bind(null,t),t.Pu.H_=Af.bind(null,t.eventManager),t.Pu.yu=Sf.bind(null,t.eventManager),t}class Or{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=El(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return Zd(this.persistence,new Yd,t.initialUser,this.serializer)}Cu(t){return new pl(li.mi,this.serializer)}Du(t){return new sf}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Or.provider={build:()=>new Or};class Bf extends Or{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){et(this.persistence.referenceDelegate instanceof kr,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Ld(n,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?Pt.withCacheSize(this.cacheSizeBytes):Pt.DEFAULT;return new pl((n=>kr.mi(n,e)),this.serializer)}}class Qs{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>aa(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Mf.bind(null,this.syncEngine),await Tf(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new If})()}createDatastore(t){const e=El(t.databaseInfo.databaseId),n=(function(o){return new uf(o)})(t.databaseInfo);return(function(o,a,u,d){return new gf(o,a,u,d)})(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return(function(n,i,o,a,u){return new pf(n,i,o,a,u)})(this.localStore,this.datastore,t.asyncQueue,(e=>aa(this.syncEngine,e,0)),(function(){return ta.v()?new ta:new of})())}createSyncEngine(t,e){return(function(i,o,a,u,d,f,_){const A=new Pf(i,o,a,u,d,f);return _&&(A.gu=!0),A})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const n=Q(e);O(Je,"RemoteStore shutting down."),n.Ea.add(5),await Qn(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Qs.provider={build:()=>new Qs};class Ll{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):Ht("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}const me="FirestoreClient";class Uf{constructor(t,e,n,i,o){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=At.UNAUTHENTICATED,this.clientId=Js.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,(async a=>{O(me,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(n,(a=>(O(me,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new oe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=Al(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Is(r,t){r.asyncQueue.verifyOperationInProgress(),O(me,"Initializing OfflineComponentProvider");const e=r.configuration;await t.initialize(e);let n=e.initialUser;r.setCredentialChangeListener((async i=>{n.isEqual(i)||(await yl(t.localStore,i),n=i)})),t.persistence.setDatabaseDeletedListener((()=>r.terminate())),r._offlineComponents=t}async function ca(r,t){r.asyncQueue.verifyOperationInProgress();const e=await qf(r);O(me,"Initializing OnlineComponentProvider"),await t.initialize(e,r.configuration),r.setCredentialChangeListener((n=>ra(t.remoteStore,n))),r.setAppCheckTokenChangeListener(((n,i)=>ra(t.remoteStore,i))),r._onlineComponents=t}async function qf(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){O(me,"Using user provided OfflineComponentProvider");try{await Is(r,r._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(i){return i.name==="FirebaseError"?i.code===P.FAILED_PRECONDITION||i.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(e))throw e;Qe("Error using user provided cache. Falling back to memory cache: "+e),await Is(r,new Or)}}else O(me,"Using default OfflineComponentProvider"),await Is(r,new Bf(void 0));return r._offlineComponents}async function jf(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(O(me,"Using user provided OnlineComponentProvider"),await ca(r,r._uninitializedComponentsProvider._online)):(O(me,"Using default OnlineComponentProvider"),await ca(r,new Qs))),r._onlineComponents}async function xl(r){const t=await jf(r),e=t.eventManager;return e.onListen=Vf.bind(null,t.syncEngine),e.onUnlisten=kf.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=Df.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=Of.bind(null,t.syncEngine),e}function Gf(r,t,e={}){const n=new oe;return r.asyncQueue.enqueueAndForget((async()=>(function(o,a,u,d,f){const _=new Ll({next:b=>{_.Nu(),a.enqueueAndForget((()=>bl(o,A)));const C=b.docs.has(u);!C&&b.fromCache?f.reject(new x(P.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&b.fromCache&&d&&d.source==="server"?f.reject(new x(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(b)},error:b=>f.reject(b)}),A=new Rl(ri(u.path),_,{includeMetadataChanges:!0,qa:!0});return Sl(o,A)})(await xl(r),r.asyncQueue,t,e,n))),n.promise}function zf(r,t,e={}){const n=new oe;return r.asyncQueue.enqueueAndForget((async()=>(function(o,a,u,d,f){const _=new Ll({next:b=>{_.Nu(),a.enqueueAndForget((()=>bl(o,A))),b.fromCache&&d.source==="server"?f.reject(new x(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(b)},error:b=>f.reject(b)}),A=new Rl(u,_,{includeMetadataChanges:!0,qa:!0});return Sl(o,A)})(await xl(r),r.asyncQueue,t,e,n))),n.promise}function Ml(r){const t={};return r.timeoutSeconds!==void 0&&(t.timeoutSeconds=r.timeoutSeconds),t}const ua=new Map;const Fl="firestore.googleapis.com",ha=!0;class da{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new x(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Fl,this.ssl=ha}else this.host=t.host,this.ssl=t.ssl??ha;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=ml;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<kd)throw new x(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}fh("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ml(t.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new x(P.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new x(P.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new x(P.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(n,i){return n.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Wr{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new da({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new x(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new da(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new rh;switch(n.type){case"firstParty":return new ah(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new x(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const n=ua.get(e);n&&(O("ComponentProvider","Removing Datastore"),ua.delete(e),n.terminate())})(this),Promise.resolve()}}function Hf(r,t,e,n={}){r=Bn(r,Wr);const i=$s(t),o=r._getSettings(),a={...o,emulatorOptions:r._getEmulatorOptions()},u=`${t}:${e}`;i&&(Vc(`https://${u}`),Oc("Firestore",!0)),o.host!==Fl&&o.host!==u&&Qe("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...o,host:u,ssl:i,emulatorOptions:n};if(!Sr(d,a)&&(r._setSettings(d),n.mockUserToken)){let f,_;if(typeof n.mockUserToken=="string")f=n.mockUserToken,_=At.MOCK_USER;else{f=Dc(n.mockUserToken,r._app?.options.projectId);const A=n.mockUserToken.sub||n.mockUserToken.user_id;if(!A)throw new x(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new At(A)}r._authCredentials=new sh(new Ma(f,_))}}class $r{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new $r(this.firestore,t,this._query)}}class bt{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ae(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new bt(this.firestore,t,this._key)}toJSON(){return{type:bt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,n){if(zn(e,bt._jsonSchema))return new bt(t,n||null,new F(tt.fromString(e.referencePath)))}}bt._jsonSchemaVersion="firestore/documentReference/1.0",bt._jsonSchema={type:ht("string",bt._jsonSchemaVersion),referencePath:ht("string")};class ae extends $r{constructor(t,e,n){super(t,e,ri(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new bt(this.firestore,null,new F(t))}withConverter(t){return new ae(this.firestore,t,this._path)}}function Bl(r,t,...e){if(r=Ia(r),Fa("collection","path",t),r instanceof Wr){const n=tt.fromString(t,...e);return So(n),new ae(r,null,n)}{if(!(r instanceof bt||r instanceof ae))throw new x(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(tt.fromString(t,...e));return So(n),new ae(r.firestore,null,n)}}function Kf(r,t,...e){if(r=Ia(r),arguments.length===1&&(t=Js.newId()),Fa("doc","path",t),r instanceof Wr){const n=tt.fromString(t,...e);return Ao(n),new bt(r,null,new F(n))}{if(!(r instanceof bt||r instanceof ae))throw new x(P.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(tt.fromString(t,...e));return Ao(n),new bt(r.firestore,r instanceof ae?r.converter:null,new F(n))}}const fa="AsyncQueue";class ga{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new vl(this,"async_queue_retry"),this._c=()=>{const n=ws();n&&O(fa,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=t;const e=ws();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=ws();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new oe;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Xu.push(t),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!nn(t))throw t;O(fa,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((n=>{throw this.nc=n,this.rc=!1,Ht("INTERNAL UNHANDLED ERROR: ",ma(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=e,e}enqueueAfterDelay(t,e,n){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const i=mi.createAndSchedule(this,t,e,n,(o=>this.hc(o)));return this.tc.push(i),i}uc(){this.nc&&j(47125,{Pc:ma(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,n)=>e.targetTimeMs-n.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function ma(r){let t=r.message||"";return r.stack&&(t=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),t}class Ei extends Wr{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new ga,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new ga(t),this._firestoreClient=void 0,await t}}}function Qf(r,t){const e=typeof r=="object"?r:zu(),n=typeof r=="string"?r:Cr,i=Bu(e,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=Cc("firestore");o&&Hf(i,...o)}return i}function Ul(r){if(r._terminated)throw new x(P.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||Wf(r),r._firestoreClient}function Wf(r){const t=r._freezeSettings(),e=(function(i,o,a,u){return new Rh(i,o,a,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,Ml(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(r._databaseId,r._app?.options.appId||"",r._persistenceKey,t);r._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(r._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),r._firestoreClient=new Uf(r._authCredentials,r._appCheckCredentials,r._queue,e,r._componentsProvider&&(function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}})(r._componentsProvider))}class Bt{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Bt(Tt.fromBase64String(t))}catch(e){throw new x(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Bt(Tt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Bt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(zn(t,Bt._jsonSchema))return Bt.fromBase64String(t.bytes)}}Bt._jsonSchemaVersion="firestore/bytes/1.0",Bt._jsonSchema={type:ht("string",Bt._jsonSchemaVersion),bytes:ht("string")};class ql{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new x(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ct(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class le{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new x(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new x(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return z(this._lat,t._lat)||z(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:le._jsonSchemaVersion}}static fromJSON(t){if(zn(t,le._jsonSchema))return new le(t.latitude,t.longitude)}}le._jsonSchemaVersion="firestore/geoPoint/1.0",le._jsonSchema={type:ht("string",le._jsonSchemaVersion),latitude:ht("number"),longitude:ht("number")};class ce{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0})(this._values,t._values)}toJSON(){return{type:ce._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(zn(t,ce._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new ce(t.vectorValues);throw new x(P.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ce._jsonSchemaVersion="firestore/vectorValue/1.0",ce._jsonSchema={type:ht("string",ce._jsonSchemaVersion),vectorValues:ht("object")};const $f=new RegExp("[~\\*/\\[\\]]");function Yf(r,t,e){if(t.search($f)>=0)throw pa(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,r);try{return new ql(...t.split("."))._internalPath}catch{throw pa(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r)}}function pa(r,t,e,n,i){let o=`Function ${t}() called with invalid data`;o+=". ";let a="";return new x(P.INVALID_ARGUMENT,o+r+a)}class jl{constructor(t,e,n,i,o){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new bt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new Xf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Gl("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class Xf extends jl{data(){return super.data()}}function Gl(r,t){return typeof t=="string"?Yf(r,t):t instanceof ql?t._internalPath:t._delegate._internalPath}function Jf(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new x(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Zf{convertValue(t,e="none"){switch(fe(t)){case 0:return null;case 1:return t.booleanValue;case 2:return st(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(de(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw j(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return Hn(t,((i,o)=>{n[i]=this.convertValue(o,e)})),n}convertVectorValue(t){const e=t.fields?.[ks].arrayValue?.values?.map((n=>st(n.doubleValue)));return new ce(e)}convertGeoPoint(t){return new le(st(t.latitude),st(t.longitude))}convertArray(t,e){return(t.values||[]).map((n=>this.convertValue(n,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=Ur(t);return n==null?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(qn(t));default:return null}}convertTimestamp(t){const e=he(t);return new ut(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=tt.fromString(t);et(gl(n),9688,{name:t});const i=new jn(n.get(1),n.get(3)),o=new F(n.popFirst(5));return i.isEqual(e)||Ht(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),o}}class Dn{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Pe extends jl{constructor(t,e,n,i,o,a){super(t,e,n,i,a),this._firestore=t,this._firestoreImpl=t,this.metadata=o}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new wr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(Gl("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new x(P.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=Pe._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}Pe._jsonSchemaVersion="firestore/documentSnapshot/1.0",Pe._jsonSchema={type:ht("string",Pe._jsonSchemaVersion),bundleSource:ht("string","DocumentSnapshot"),bundleName:ht("string"),bundle:ht("string")};class wr extends Pe{data(t={}){return super.data(t)}}class Ke{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Dn(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new wr(this._firestore,this._userDataWriter,n.key,n,new Dn(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new x(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((u=>{const d=new wr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Dn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:d,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((u=>o||u.type!==3)).map((u=>{const d=new wr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Dn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,_=-1;return u.type!==0&&(f=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),_=a.indexOf(u.doc.key)),{type:tg(u.type),doc:d,oldIndex:f,newIndex:_}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new x(P.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Ke._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Js.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],n=[],i=[];return this.docs.forEach((o=>{o._document!==null&&(e.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function tg(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return j(61501,{type:r})}}function eg(r){r=Bn(r,bt);const t=Bn(r.firestore,Ei);return Gf(Ul(t),r._key).then((e=>ng(t,r,e)))}Ke._jsonSchemaVersion="firestore/querySnapshot/1.0",Ke._jsonSchema={type:ht("string",Ke._jsonSchemaVersion),bundleSource:ht("string","QuerySnapshot"),bundleName:ht("string"),bundle:ht("string")};class zl extends Zf{constructor(t){super(),this.firestore=t}convertBytes(t){return new Bt(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new bt(this.firestore,null,e)}}function Hl(r){r=Bn(r,$r);const t=Bn(r.firestore,Ei),e=Ul(t),n=new zl(t);return Jf(r._query),zf(e,r._query).then((i=>new Ke(t,n,r,i)))}function ng(r,t,e){const n=e.docs.get(t._key),i=new zl(r);return new Pe(r,i,t._key,n,new Dn(e.hasPendingWrites,e.fromCache),t.converter)}(function(t,e=!0){(function(i){en=i})(Gu),Rr(new Mn("firestore",((n,{instanceIdentifier:i,options:o})=>{const a=n.getProvider("app").getImmediate(),u=new Ei(new ih(n.getProvider("auth-internal")),new lh(a,n.getProvider("app-check-internal")),(function(f,_){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new x(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jn(f.options.projectId,_)})(a,i),a);return o={useFetchStreams:e,...o},u._setSettings(o),u}),"PUBLIC").setMultipleInstances(!0)),Ge(vo,To,t),Ge(vo,To,"esm2020")})();const rg={apiKey:"AIzaSyBBbaJwewCktbFWRB2K3PUvwZluvuVtBr0",authDomain:"seedra-b18d9.firebaseapp.com",projectId:"seedra-b18d9",storageBucket:"seedra-b18d9.firebasestorage.app",messagingSenderId:"678717536858",appId:"1:678717536858:web:f973d8d8bf9e92616cb663"},Kl=Ra(rg),vi=Qf(Kl);async function sg(){const r=Kf(vi,"products","main"),t=await eg(r);if(!t.exists())return;const e=t.data();document.getElementById("hero-title").innerHTML=e.name,document.getElementById("hero-price").textContent=`$${e.price.toFixed(2)}`;const n=document.getElementById("hero-old-price");e.oldPrice?n.textContent=`$${e.oldPrice.toFixed(2)}`:n.style.display="none",document.getElementById("hero-image").src=e.photo}var Ir={exports:{}},ig=Ir.exports,ya;function og(){return ya||(ya=1,(function(r,t){(function(n,i){r.exports=i()})(ig,function(){return(function(e){var n={};function i(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=e,i.c=n,i.d=function(o,a,u){i.o(o,a)||Object.defineProperty(o,a,{enumerable:!0,get:u})},i.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},i.t=function(o,a){if(a&1&&(o=i(o)),a&8||a&4&&typeof o=="object"&&o&&o.__esModule)return o;var u=Object.create(null);if(i.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:o}),a&2&&typeof o!="string")for(var d in o)i.d(u,d,(function(f){return o[f]}).bind(null,d));return u},i.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(a,"a",a),a},i.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},i.p="",i(i.s=0)})([(function(e,n,i){i.r(n);var o=function(y){return Array.isArray(y)?y:[y]},a=function(y){return y instanceof Node},u=function(y){return y instanceof NodeList},d=function(y,V){if(y&&V){y=u(y)?y:[y];for(var k=0;k<y.length&&V(y[k],k,y.length)!==!0;k++);}},f=function(y){return console.error("[scroll-lock] ".concat(y))},_=function(y){if(Array.isArray(y)){var V=y.join(", ");return V}},A=function(y){var V=[];return d(y,function(k){return V.push(k)}),V},b=function(y,V){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:document;if(k&&A(M.querySelectorAll(V)).indexOf(y)!==-1)return y;for(;(y=y.parentElement)&&A(M.querySelectorAll(V)).indexOf(y)===-1;);return y},C=function(y,V){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,M=A(k.querySelectorAll(V)).indexOf(y)!==-1;return M},B=function(y){if(y){var V=getComputedStyle(y),k=V.overflow==="hidden";return k}},U=function(y){if(y){if(B(y))return!0;var V=y.scrollTop;return V<=0}},L=function(y){if(y){if(B(y))return!0;var V=y.scrollTop,k=y.scrollHeight,M=V+y.offsetHeight;return M>=k}},Y=function(y){if(y){if(B(y))return!0;var V=y.scrollLeft;return V<=0}},$=function(y){if(y){if(B(y))return!0;var V=y.scrollLeft,k=y.scrollWidth,M=V+y.offsetWidth;return M>=k}},X=function(y){var V='textarea, [contenteditable="true"]';return C(y,V)},Et=function(y){var V='input[type="range"]';return C(y,V)};i.d(n,"disablePageScroll",function(){return T}),i.d(n,"enablePageScroll",function(){return E}),i.d(n,"getScrollState",function(){return w}),i.d(n,"clearQueueScrollLocks",function(){return p}),i.d(n,"getTargetScrollBarWidth",function(){return at}),i.d(n,"getCurrentTargetScrollBarWidth",function(){return Dt}),i.d(n,"getPageScrollBarWidth",function(){return on}),i.d(n,"getCurrentPageScrollBarWidth",function(){return an}),i.d(n,"addScrollableTarget",function(){return Gt}),i.d(n,"removeScrollableTarget",function(){return Kt}),i.d(n,"addScrollableSelector",function(){return Yn}),i.d(n,"removeScrollableSelector",function(){return ln}),i.d(n,"addLockableTarget",function(){return cn}),i.d(n,"addLockableSelector",function(){return un}),i.d(n,"setFillGapMethod",function(){return pe}),i.d(n,"addFillGapTarget",function(){return ye}),i.d(n,"removeFillGapTarget",function(){return Ne}),i.d(n,"addFillGapSelector",function(){return Qt}),i.d(n,"removeFillGapSelector",function(){return ke}),i.d(n,"refillGaps",function(){return _e});function wt(N){for(var y=1;y<arguments.length;y++){var V=arguments[y]!=null?arguments[y]:{},k=Object.keys(V);typeof Object.getOwnPropertySymbols=="function"&&(k=k.concat(Object.getOwnPropertySymbols(V).filter(function(M){return Object.getOwnPropertyDescriptor(V,M).enumerable}))),k.forEach(function(M){ot(N,M,V[M])})}return N}function ot(N,y,V){return y in N?Object.defineProperty(N,y,{value:V,enumerable:!0,configurable:!0,writable:!0}):N[y]=V,N}var v=["padding","margin","width","max-width","none"],m=3,g={scroll:!0,queue:0,scrollableSelectors:["[data-scroll-lock-scrollable]"],lockableSelectors:["body","[data-scroll-lock-lockable]"],fillGapSelectors:["body","[data-scroll-lock-fill-gap]","[data-scroll-lock-lockable]"],fillGapMethod:v[0],startTouchY:0,startTouchX:0},T=function(y){g.queue<=0&&(g.scroll=!1,hn(),Oe()),Gt(y),g.queue++},E=function(y){g.queue>0&&g.queue--,g.queue<=0&&(g.scroll=!0,Yr(),fn()),Kt(y)},w=function(){return g.scroll},p=function(){g.queue=0},at=function(y){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(a(y)){var k=y.style.overflowY;V?w()||(y.style.overflowY=y.getAttribute("data-scroll-lock-saved-overflow-y-property")):y.style.overflowY="scroll";var M=Dt(y);return y.style.overflowY=k,M}else return 0},Dt=function(y){if(a(y))if(y===document.body){var V=document.documentElement.clientWidth,k=window.innerWidth,M=k-V;return M}else{var Rt=y.style.borderLeftWidth,Ot=y.style.borderRightWidth;y.style.borderLeftWidth="0px",y.style.borderRightWidth="0px";var Nt=y.offsetWidth-y.clientWidth;return y.style.borderLeftWidth=Rt,y.style.borderRightWidth=Ot,Nt}else return 0},on=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return at(document.body,y)},an=function(){return Dt(document.body)},Gt=function(y){if(y){var V=o(y);V.map(function(k){d(k,function(M){a(M)?M.setAttribute("data-scroll-lock-scrollable",""):f('"'.concat(M,'" is not a Element.'))})})}},Kt=function(y){if(y){var V=o(y);V.map(function(k){d(k,function(M){a(M)?M.removeAttribute("data-scroll-lock-scrollable"):f('"'.concat(M,'" is not a Element.'))})})}},Yn=function(y){if(y){var V=o(y);V.map(function(k){g.scrollableSelectors.push(k)})}},ln=function(y){if(y){var V=o(y);V.map(function(k){g.scrollableSelectors=g.scrollableSelectors.filter(function(M){return M!==k})})}},cn=function(y){if(y){var V=o(y);V.map(function(k){d(k,function(M){a(M)?M.setAttribute("data-scroll-lock-lockable",""):f('"'.concat(M,'" is not a Element.'))})}),w()||hn()}},un=function(y){if(y){var V=o(y);V.map(function(k){g.lockableSelectors.push(k)}),w()||hn(),Qt(y)}},pe=function(y){if(y)if(v.indexOf(y)!==-1)g.fillGapMethod=y,_e();else{var V=v.join(", ");f('"'.concat(y,`" method is not available!
Available fill gap methods: `).concat(V,"."))}},ye=function(y){if(y){var V=o(y);V.map(function(k){d(k,function(M){a(M)?(M.setAttribute("data-scroll-lock-fill-gap",""),g.scroll||dt(M)):f('"'.concat(M,'" is not a Element.'))})})}},Ne=function(y){if(y){var V=o(y);V.map(function(k){d(k,function(M){a(M)?(M.removeAttribute("data-scroll-lock-fill-gap"),g.scroll||Wt(M)):f('"'.concat(M,'" is not a Element.'))})})}},Qt=function(y){if(y){var V=o(y);V.map(function(k){g.fillGapSelectors.indexOf(k)===-1&&(g.fillGapSelectors.push(k),g.scroll||gn(k))})}},ke=function(y){if(y){var V=o(y);V.map(function(k){g.fillGapSelectors=g.fillGapSelectors.filter(function(M){return M!==k}),g.scroll||pt(k)})}},_e=function(){g.scroll||Oe()},hn=function(){var y=_(g.lockableSelectors);Xn(y)},Yr=function(){var y=_(g.lockableSelectors);dn(y)},Xn=function(y){var V=document.querySelectorAll(y);d(V,function(k){Jn(k)})},dn=function(y){var V=document.querySelectorAll(y);d(V,function(k){Xr(k)})},Jn=function(y){if(a(y)&&y.getAttribute("data-scroll-lock-locked")!=="true"){var V=window.getComputedStyle(y);y.setAttribute("data-scroll-lock-saved-overflow-y-property",V.overflowY),y.setAttribute("data-scroll-lock-saved-inline-overflow-property",y.style.overflow),y.setAttribute("data-scroll-lock-saved-inline-overflow-y-property",y.style.overflowY),y.style.overflow="hidden",y.setAttribute("data-scroll-lock-locked","true")}},Xr=function(y){a(y)&&y.getAttribute("data-scroll-lock-locked")==="true"&&(y.style.overflow=y.getAttribute("data-scroll-lock-saved-inline-overflow-property"),y.style.overflowY=y.getAttribute("data-scroll-lock-saved-inline-overflow-y-property"),y.removeAttribute("data-scroll-lock-saved-overflow-property"),y.removeAttribute("data-scroll-lock-saved-inline-overflow-property"),y.removeAttribute("data-scroll-lock-saved-inline-overflow-y-property"),y.removeAttribute("data-scroll-lock-locked"))},Oe=function(){g.fillGapSelectors.map(function(y){gn(y)})},fn=function(){g.fillGapSelectors.map(function(y){pt(y)})},gn=function(y){var V=document.querySelectorAll(y),k=g.lockableSelectors.indexOf(y)!==-1;d(V,function(M){dt(M,k)})},dt=function(y){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(a(y)){var k;if(y.getAttribute("data-scroll-lock-lockable")===""||V)k=at(y,!0);else{var M=b(y,_(g.lockableSelectors));k=at(M,!0)}y.getAttribute("data-scroll-lock-filled-gap")==="true"&&Wt(y);var Rt=window.getComputedStyle(y);if(y.setAttribute("data-scroll-lock-filled-gap","true"),y.setAttribute("data-scroll-lock-current-fill-gap-method",g.fillGapMethod),g.fillGapMethod==="margin"){var Ot=parseFloat(Rt.marginRight);y.style.marginRight="".concat(Ot+k,"px")}else if(g.fillGapMethod==="width")y.style.width="calc(100% - ".concat(k,"px)");else if(g.fillGapMethod==="max-width")y.style.maxWidth="calc(100% - ".concat(k,"px)");else if(g.fillGapMethod==="padding"){var Nt=parseFloat(Rt.paddingRight);y.style.paddingRight="".concat(Nt+k,"px")}}},pt=function(y){var V=document.querySelectorAll(y);d(V,function(k){Wt(k)})},Wt=function(y){if(a(y)&&y.getAttribute("data-scroll-lock-filled-gap")==="true"){var V=y.getAttribute("data-scroll-lock-current-fill-gap-method");y.removeAttribute("data-scroll-lock-filled-gap"),y.removeAttribute("data-scroll-lock-current-fill-gap-method"),V==="margin"?y.style.marginRight="":V==="width"?y.style.width="":V==="max-width"?y.style.maxWidth="":V==="padding"&&(y.style.paddingRight="")}},Jr=function(y){_e()},Zn=function(y){g.scroll||(g.startTouchY=y.touches[0].clientY,g.startTouchX=y.touches[0].clientX)},Zr=function(y){if(!g.scroll){var V=g.startTouchY,k=g.startTouchX,M=y.touches[0].clientY,Rt=y.touches[0].clientX;if(y.touches.length<2){var Ot=_(g.scrollableSelectors),Nt={up:V<M,down:V>M,left:k<Rt,right:k>Rt},kt={up:V+m<M,down:V-m>M,left:k+m<Rt,right:k-m>Rt},nr=function ve(rt){var Te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(rt){var Le=b(rt,Ot,!1);if(Et(rt))return!1;if(Te||X(rt)&&b(rt,Ot)||C(rt,Ot)){var lt=!1;Y(rt)&&$(rt)?(Nt.up&&U(rt)||Nt.down&&L(rt))&&(lt=!0):U(rt)&&L(rt)?(Nt.left&&Y(rt)||Nt.right&&$(rt))&&(lt=!0):(kt.up&&U(rt)||kt.down&&L(rt)||kt.left&&Y(rt)||kt.right&&$(rt))&&(lt=!0),lt&&(Le?ve(Le,!0):y.cancelable&&y.preventDefault())}else ve(Le)}else y.cancelable&&y.preventDefault()};nr(y.target)}}},Ee=function(y){g.scroll||(g.startTouchY=0,g.startTouchX=0)};typeof window<"u"&&window.addEventListener("resize",Jr),typeof document<"u"&&(document.addEventListener("touchstart",Zn),document.addEventListener("touchmove",Zr,{passive:!1}),document.addEventListener("touchend",Ee));var tr={hide:function(y){f(`"hide" is deprecated! Use "disablePageScroll" instead. 
 https://github.com/FL3NKEY/scroll-lock#disablepagescrollscrollabletarget`),T(y)},show:function(y){f(`"show" is deprecated! Use "enablePageScroll" instead. 
 https://github.com/FL3NKEY/scroll-lock#enablepagescrollscrollabletarget`),E(y)},toggle:function(y){f('"toggle" is deprecated! Do not use it.'),w()?T():E(y)},getState:function(){return f(`"getState" is deprecated! Use "getScrollState" instead. 
 https://github.com/FL3NKEY/scroll-lock#getscrollstate`),w()},getWidth:function(){return f(`"getWidth" is deprecated! Use "getPageScrollBarWidth" instead. 
 https://github.com/FL3NKEY/scroll-lock#getpagescrollbarwidth`),on()},getCurrentWidth:function(){return f(`"getCurrentWidth" is deprecated! Use "getCurrentPageScrollBarWidth" instead. 
 https://github.com/FL3NKEY/scroll-lock#getcurrentpagescrollbarwidth`),an()},setScrollableTargets:function(y){f(`"setScrollableTargets" is deprecated! Use "addScrollableTarget" instead. 
 https://github.com/FL3NKEY/scroll-lock#addscrollabletargetscrollabletarget`),Gt(y)},setFillGapSelectors:function(y){f(`"setFillGapSelectors" is deprecated! Use "addFillGapSelector" instead. 
 https://github.com/FL3NKEY/scroll-lock#addfillgapselectorfillgapselector`),Qt(y)},setFillGapTargets:function(y){f(`"setFillGapTargets" is deprecated! Use "addFillGapTarget" instead. 
 https://github.com/FL3NKEY/scroll-lock#addfillgaptargetfillgaptarget`),ye(y)},clearQueue:function(){f(`"clearQueue" is deprecated! Use "clearQueueScrollLocks" instead. 
 https://github.com/FL3NKEY/scroll-lock#clearqueuescrolllocks`),p()}},er=wt({disablePageScroll:T,enablePageScroll:E,getScrollState:w,clearQueueScrollLocks:p,getTargetScrollBarWidth:at,getCurrentTargetScrollBarWidth:Dt,getPageScrollBarWidth:on,getCurrentPageScrollBarWidth:an,addScrollableSelector:Yn,removeScrollableSelector:ln,addScrollableTarget:Gt,removeScrollableTarget:Kt,addLockableSelector:un,addLockableTarget:cn,addFillGapSelector:Qt,removeFillGapSelector:ke,addFillGapTarget:ye,removeFillGapTarget:Ne,setFillGapMethod:pe,refillGaps:_e,_state:g},tr);n.default=er})]).default})})(Ir)),Ir.exports}var As=og();function ag(){const r=document.querySelector(".header__burger-btn"),t=document.querySelector(".burger"),e=document.querySelector(".burger__bg"),n=document.querySelector(".burger__menu-link");if(!r||!t)return;const i=()=>{const a=t.classList.toggle("active");r.classList.toggle("active",a),e.classList.toggle("active",a),a?As.disablePageScroll():(As.enablePageScroll(),document.dispatchEvent(new Event("burger:close")))},o=()=>{r.classList.remove("active"),t.classList.remove("active"),e.classList.remove("active"),As.enablePageScroll(),document.dispatchEvent(new Event("burger:close"))};r.addEventListener("click",i),n?.addEventListener("click",o),e.addEventListener("click",o),document.querySelectorAll(".js-close-burger").forEach(a=>{a.addEventListener("click",o)}),window.addEventListener("resize",()=>{o()})}function lg(){document.querySelectorAll(".burger__category-btn").forEach(t=>{t.addEventListener("click",()=>{const e=t.closest(".burger__category-item");if(!e)return;const n=e.querySelector(".burger__subcategory");if(!n)return;const i=n.classList.contains("open");document.querySelectorAll(".burger__subcategory.open").forEach(o=>{o.classList.remove("open"),o.style.maxHeight=null,o.closest(".burger__category-item").querySelector(".burger__category-btn").classList.remove("active")}),i||(n.classList.add("open"),n.style.maxHeight=n.scrollHeight+"px",t.classList.add("active"))})}),document.addEventListener("burger:close",()=>{document.querySelectorAll(".burger__subcategory.open").forEach(t=>{t.classList.remove("open"),t.style.maxHeight=null,t.closest(".burger__category-item")?.querySelector(".burger__category-btn")?.classList.remove("active")})})}let Lr=null,xr=null;const Ql=window.matchMedia("(max-width: 576px)"),cg=()=>{Lr=new Swiper(".products .swiper",{slidesPerView:1.1,spaceBetween:20,loop:!0,observer:!0,observeParents:!0,watchOverflow:!0,breakpoints:{400:{slidesPerView:1.3},470:{slidesPerView:1.5}}})},ug=()=>{xr=new Swiper(".blog .swiper",{slidesPerView:1.1,spaceBetween:20,loop:!0,observer:!0,observeParents:!0,watchOverflow:!0,breakpoints:{450:{slidesPerView:1.3}}})},hg=()=>{Lr?.destroy(!0,!0),xr?.destroy(!0,!0),Lr=null,xr=null},_a=()=>{window.Swiper&&(Ql.matches?(!Lr&&document.querySelector(".products .swiper")&&cg(),!xr&&document.querySelector(".blog .swiper")&&ug()):hg())},dg=()=>{_a(),Ql.addEventListener("change",_a)},fg=()=>{new Swiper(".feedback .swiper",{slidesPerView:1.15,spaceBetween:15,centeredSlides:!1,loop:!0,breakpoints:{575:{slidesPerView:1.5,spaceBetween:20,centeredSlides:!0},700:{slidesPerView:2,spaceBetween:20,centeredSlides:!0},1e3:{slidesPerView:2.6,spaceBetween:30,centeredSlides:!0}},pagination:{el:".swiper-pagination",clickable:!0}})};console.log("Firebase ready",Kl);document.addEventListener("DOMContentLoaded",async()=>{await sg(),dg(),fg(),ag(),lg()});const gg=await Hl(Bl(vi,"products")),Wl={};gg.forEach(r=>{Wl[r.id]=r.data()});const sn=(r,t)=>{const e=document.querySelector(`[data-card-id="${r}"]`),n=Wl[t];console.log("productsMap: ",n);const i=e.querySelector(".card__rating-comments"),o=e.querySelector(".card__title"),a=e.querySelector(".card__photo img"),u=e.querySelector(".card__price"),d=e.querySelector(".card__old-price"),f=e.querySelector(".card__fire-price");n.reviewsNumber!=null&&(i.textContent="("+n.reviewsNumber+")"),n.name&&(o.textContent=n.name),n.price!=null&&(u.textContent=n.price),n.photo&&(a.src=n.photo),n.firePrice&&(f.style.display="block"),n.oldPrice!=null&&(d.textContent=n.oldPrice)};sn("card-1","product-1");sn("card-2","product-2");sn("card-3","product-3");sn("card-4","product-4");sn("card-5","product-5");sn("card-6","product-6");const mg=await Hl(Bl(vi,"reviews")),$l={};mg.forEach(r=>{$l[r.id]=r.data()});const $n=(r,t)=>{const e=document.querySelector(`[data-card-id="${r}"]`),n=$l[t];console.log("reviewsMap: ",n);const i=e.querySelector(".card-review__date"),o=e.querySelector(".card-review__name"),a=e.querySelector(".card-review__photo img"),u=e.querySelector(".card-review__text");n.date&&(i.textContent=n.date),n.name&&(o.textContent=n.name),n.photo&&(a.src=n.photo),n.text&&(u.textContent=n.text)};$n("card-review-1","review-1");$n("card-review-2","review-2");$n("card-review-3","review-3");$n("card-review-4","review-1");$n("card-review-5","review-2");
